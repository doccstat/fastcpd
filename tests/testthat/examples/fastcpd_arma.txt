\donttest{
set.seed(1)
n <- 400
w <- rnorm(n + 2, 0, 1)
x <- rep(0, n + 3)
for (i in 1:150) {
  x[i + 3] <- 0.1 * x[i + 2] - 0.3 * x[i + 1] + 0.5 * x[i] +
    w[i + 2] + 0.1 * w[i + 1] + 0.5 * w[i]
}
for (i in 151:n) {
  x[i + 3] <- -0.3 * x[i + 2] + 0.5 * x[i + 1] + 0.1 * x[i] +
    w[i + 2] - 0.6 * w[i + 1] - 0.1 * w[i]
}
result <- suppressWarnings(
  fastcpd.arma(
    data = x[3 + seq_len(n)],
    order = c(3, 2),
    segment_count = 3,
    lower = c(rep(-1, 3 + 2), 1e-10),
    upper = c(rep(1, 3 + 2), Inf),
    line_search = c(1, 0.1, 1e-2, 1e-3, 1e-4, 1e-5, 1e-6, 1e-7, 1e-8, 1e-9)
  )
)
summary(result)
plot(result)
}
