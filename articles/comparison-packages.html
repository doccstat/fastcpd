<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Speed and result comparison with other R packages.
">
<title>Comparison with other R packages â€¢ fastcpd</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Comparison with other R packages">
<meta property="og:description" content="Speed and result comparison with other R packages.
">
<meta property="og:image" content="https://fastcpd.xingchi.li/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fastcpd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.14.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/examples-advanced.html">Advanced examples</a>
    <a class="dropdown-item" href="../articles/examples-custom-model.html">Custom logistic regression model</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Comparison</h6>
    <a class="dropdown-item" href="../articles/comparison-packages.html">Comparison with other R packages</a>
    <a class="dropdown-item" href="../articles/comparison-pelt.html">Comparison with vanilla PELT</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/doccstat/fastcpd/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Comparison with other R packages</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/doccstat/fastcpd/blob/HEAD/vignettes/comparison-packages.Rmd" class="external-link"><code>vignettes/comparison-packages.Rmd</code></a></small>
      <div class="d-none name"><code>comparison-packages.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="data-setup">Data setup<a class="anchor" aria-label="anchor" href="#data-setup"></a>
</h2>
<div class="section level3">
<h3 id="univariate-mean-change">Univariate mean change<a class="anchor" aria-label="anchor" href="#univariate-mean-change"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Univariate mean change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">mean_data_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span></span></code></pre></div>
<p><img src="comparison-packages_files/figure-html/data-setup-univariate-mean-change-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="univariate-mean-andor-variance-change">Univariate mean and/or variance change<a class="anchor" aria-label="anchor" href="#univariate-mean-andor-variance-change"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Univariate mean and/or variance change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">mv_data_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span></span></code></pre></div>
<p><img src="comparison-packages_files/figure-html/data-setup-univariate-mean-and-or-variance-change-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="multivariate-mean-change">Multivariate mean change<a class="anchor" aria-label="anchor" href="#multivariate-mean-change"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multivariate mean change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">mean_data_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span></span></code></pre></div>
<p><img src="comparison-packages_files/figure-html/data-setup-multivariate-mean-change-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="multivariate-mean-andor-variance-change">Multivariate mean and/or variance change<a class="anchor" aria-label="anchor" href="#multivariate-mean-andor-variance-change"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multivariate mean and/or variance change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">mv_data_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span></span></code></pre></div>
<p><img src="comparison-packages_files/figure-html/data-setup-multivariate-mean-and-or-variance-change-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="linear-regression">Linear regression<a class="anchor" aria-label="anchor" href="#linear-regression"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Linear regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3.2</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">2.5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">101</span><span class="op">:</span><span class="fl">200</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">201</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">lm_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">lm_data</span><span class="op">)</span></span></code></pre></div>
<p><img src="comparison-packages_files/figure-html/data-setup-linear-regression-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="logistic-regression">Logistic regression<a class="anchor" aria-label="anchor" href="#logistic-regression"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Logistic regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">300</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="fl">301</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">binomial_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">binomial_data</span><span class="op">)</span></span></code></pre></div>
<p><img src="comparison-packages_files/figure-html/data-setup-logistic-regression-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="poisson-regression">Poisson regression<a class="anchor" aria-label="anchor" href="#poisson-regression"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Poisson regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1100</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.3</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">501</span><span class="op">:</span><span class="fl">800</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">theta_0</span> <span class="op">+</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">801</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1001</span><span class="op">:</span><span class="fl">1100</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">theta_0</span> <span class="op">-</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">poisson_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">poisson_data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="comparison-packages_files/figure-html/data-setup-poisson-regression-1.png" width="768"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">poisson_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="comparison-packages_files/figure-html/data-setup-poisson-regression-2.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="lasso">Lasso<a class="anchor" aria-label="anchor" href="#lasso"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lasso</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">480</span></span>
<span><span class="va">p_true</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, ncol <span class="op">=</span> <span class="va">p</span> <span class="op">-</span> <span class="va">p_true</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">80</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">81</span><span class="op">:</span><span class="fl">200</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">201</span><span class="op">:</span><span class="fl">320</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">321</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">4</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">160</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">lasso_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">lasso_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">p_true</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="comparison-packages_files/figure-html/data-setup-lasso-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="ar3">AR(3)<a class="anchor" aria-label="anchor" href="#ar3"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># AR(3)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">600</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">601</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">ar_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span></span></code></pre></div>
<p><img src="comparison-packages_files/figure-html/data-setup-ar3-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="garch1-1">GARCH(1, 1)<a class="anchor" aria-label="anchor" href="#garch1-1"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># GARCH(1, 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">400</span></span>
<span><span class="va">sigma_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">201</span><span class="op">:</span><span class="fl">400</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">garch_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">garch_data</span><span class="op">)</span></span></code></pre></div>
<p><img src="comparison-packages_files/figure-html/data-setup-garch11-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="var2">VAR(2)<a class="anchor" aria-label="anchor" href="#var2"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># VAR(2)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">800</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">theta_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">theta_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">2</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta_1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>, <span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">501</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta_2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>, <span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">var_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span></span></code></pre></div>
<p><img src="comparison-packages_files/figure-html/data-setup-var2-1.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="univariate-mean-change-1">Univariate mean change<a class="anchor" aria-label="anchor" href="#univariate-mean-change-1"></a>
</h2>
<p>The true change points are 300 and 700. Some methods are plotted due
to the un-retrievable change points.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fastcpd_result</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">mean_data_1</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">CptNonPar_result</span> <span class="op">&lt;-</span> <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CptNonPar/man/np.mojo.html" class="external-link">np.mojo</a></span><span class="op">(</span><span class="va">mean_data_1</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">strucchange</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/strucchange/man/breakpoints.html" class="external-link">breakpoints</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ecp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ecp/man/e.divisive.html" class="external-link">e.divisive</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="co">#&gt; [1]    1  301  701 1001</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">changepoint_result</span> <span class="op">&lt;-</span> <span class="fu">changepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/changepoint/man/cpt.mean.html" class="external-link">cpt.mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">@</span><span class="va">cpts</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  300 1000</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">breakfast_result</span> <span class="op">&lt;-</span> <span class="fu">breakfast</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/breakfast/man/breakfast.html" class="external-link">breakfast</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">cptmodel.list</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">cpts</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">wbs_result</span> <span class="op">&lt;-</span> <span class="fu">wbs</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/wbs/man/wbs.html" class="external-link">wbs</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">cpt</span><span class="op">$</span><span class="va">cpt.ic</span><span class="op">$</span><span class="va">mbic.penalty</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mosum</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mosum/man/mosum.html" class="external-link">mosum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">$</span><span class="va">cpts.info</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fpop_result</span> <span class="op">&lt;-</span> <span class="fu">fpop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fpop/man/Fpop.html" class="external-link">Fpop</a></span><span class="op">(</span><span class="va">mean_data_1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">t.est</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  300  700 1000</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gfpop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gfpop/man/gfpop.html" class="external-link">gfpop</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mean_data_1</span>,</span>
<span>  mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gfpop/man/graph.html" class="external-link">graph</a></span><span class="op">(</span></span>
<span>    penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gfpop/man/sdDiff.html" class="external-link">sdDiff</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">changepoints</span></span>
<span><span class="co">#&gt; [1]  300  700 1000</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span></span>
<span>      <span class="va">result_InspectChangepoint</span> <span class="op">&lt;-</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/InspectChangepoint/man/inspect.html" class="external-link">inspect</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>,</span>
<span>        threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/InspectChangepoint/man/compute.threshold.html" class="external-link">compute.threshold</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">result_InspectChangepoint</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">jointseg_result</span> <span class="op">&lt;-</span> <span class="fu">jointseg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jointseg/man/jointSeg.html" class="external-link">jointSeg</a></span><span class="op">(</span><span class="va">mean_data_1</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Rbeast</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rbeast/man/beast.html" class="external-link">beast</a></span><span class="op">(</span></span>
<span>  <span class="va">mean_data_1</span>, season <span class="op">=</span> <span class="st">"none"</span>, print.progress <span class="op">=</span> <span class="cn">FALSE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span></span>
<span><span class="co">#&gt;  [1] 701 301 NaN NaN NaN NaN NaN NaN NaN NaN</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">stepR_result</span> <span class="op">&lt;-</span> <span class="fu">stepR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stepR/man/stepFit.html" class="external-link">stepFit</a></span><span class="op">(</span><span class="va">mean_data_1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">$</span><span class="va">rightEnd</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  300  700 1000</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">cpm_result</span> <span class="op">&lt;-</span> <span class="fu">cpm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cpm/man/processStream.html" class="external-link">processStream</a></span><span class="op">(</span><span class="va">mean_data_1</span>, cpmType <span class="op">=</span> <span class="st">"Student"</span><span class="op">)</span><span class="op">$</span><span class="va">changePoints</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 299 699</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">segmented_result</span> <span class="op">&lt;-</span> <span class="fu">segmented</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/segmented/man/stepmented.html" class="external-link">stepmented</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, npsi <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; psi1.index psi2.index </span></span>
<span><span class="co">#&gt;   300.0813   700.1513</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="fu">mcp</span><span class="fu">::</span><span class="fu"><a href="https://lindeloev.github.io/mcp/reference/mcp.html" class="external-link">mcp</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_1</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages-mean_data_1-mcp.svg" alt="mcp plot for univariate mean change"><div class="figcaption">
<code>mcp</code> plot for univariate mean
change</div>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">not</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/not/man/not.html" class="external-link">not</a></span><span class="op">(</span><span class="va">mean_data_1</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMean"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="comparison-packages_files/figure-html/univariate-mean-change-not-1.png" width="768"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">bcp</span><span class="fu">::</span><span class="fu">bcp</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages-mean_data_1-bcp.svg" alt="bcp plot for univariate mean change"><div class="figcaption">
<code>bcp</code> plot for univariate mean
change</div>
</div>
</div>
<div class="section level2">
<h2 id="univariate-mean-andor-variance-change-1">Univariate mean and/or variance change<a class="anchor" aria-label="anchor" href="#univariate-mean-andor-variance-change-1"></a>
</h2>
<p>The true change points are 300, 700, 1000, 1300 and 1700. Some
methods are plotted due to the un-retrievable change points.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fastcpd_result</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_meanvariance.html">fastcpd.mv</a></span><span class="op">(</span><span class="va">mv_data_1</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  300  700 1001 1300 1700</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ecp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ecp/man/e.divisive.html" class="external-link">e.divisive</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="co">#&gt; [1]    1  301  701 1001 1301 1701 2001</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">changepoint_result</span> <span class="op">&lt;-</span> <span class="fu">changepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/changepoint/man/cpt.meanvar.html" class="external-link">cpt.meanvar</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">@</span><span class="va">cpts</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  300 2000</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">CptNonPar_result</span> <span class="op">&lt;-</span> <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CptNonPar/man/np.mojo.html" class="external-link">np.mojo</a></span><span class="op">(</span><span class="va">mv_data_1</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  333  700 1300</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">cpm_result</span> <span class="op">&lt;-</span> <span class="fu">cpm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cpm/man/processStream.html" class="external-link">processStream</a></span><span class="op">(</span><span class="va">mv_data_1</span>, cpmType <span class="op">=</span> <span class="st">"GLR"</span><span class="op">)</span><span class="op">$</span><span class="va">changePoints</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1]  293  300  403  408  618  621  696 1000 1021 1024 1293 1300 1417 1693 1700</span></span>
<span><span class="co">#&gt; [16] 1981</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span></span>
<span>      <span class="va">result_InspectChangepoint</span> <span class="op">&lt;-</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/InspectChangepoint/man/inspect.html" class="external-link">inspect</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span>,</span>
<span>        threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/InspectChangepoint/man/compute.threshold.html" class="external-link">compute.threshold</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">result_InspectChangepoint</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span></span>
<span><span class="co">#&gt;   [1]  300  700  701  702  704  707  708  712  715  716  717  718  721  722</span></span>
<span><span class="co">#&gt;  [15]  723  726  727  729  731  732  734  736  740  742  744  746  748  750</span></span>
<span><span class="co">#&gt;  [29]  753  755  756  757  759  760  762  764  765  768  769  771  772  774</span></span>
<span><span class="co">#&gt;  [43]  776  777  784  785  786  789  791  792  794  797  798  799  801  802</span></span>
<span><span class="co">#&gt;  [57]  803  807  809  810  813  815  817  819  826  827  828  829  831  833</span></span>
<span><span class="co">#&gt;  [71]  835  836  837  838  840  841  842  843  845  848  849  852  854  860</span></span>
<span><span class="co">#&gt;  [85]  862  864  866  868  870  872  875  879  881  884  886  887  888  889</span></span>
<span><span class="co">#&gt;  [99]  896  897  898  899  901  903  904  905  906  909  912  913  915  917</span></span>
<span><span class="co">#&gt; [113]  919  921  922  923  927  928  932  934  936  937  940  944  945  947</span></span>
<span><span class="co">#&gt; [127]  948  949  951  956  958  959  961  962  963  964  966  967  968  972</span></span>
<span><span class="co">#&gt; [141]  974  976  978  979  986  988  990  992  995 1000 1300 1700 1702 1703</span></span>
<span><span class="co">#&gt; [155] 1704 1705 1708 1710 1712 1714 1716 1717 1718 1720 1721 1723 1725 1726</span></span>
<span><span class="co">#&gt; [169] 1727 1729 1731 1733 1735 1736 1737 1739 1742 1745 1747 1748 1752 1754</span></span>
<span><span class="co">#&gt; [183] 1756 1758 1759 1760 1766 1768 1770 1771 1773 1775 1778 1782 1784 1785</span></span>
<span><span class="co">#&gt; [197] 1790 1792 1793 1795 1796 1797 1799 1800 1802 1803 1804 1805 1806 1807</span></span>
<span><span class="co">#&gt; [211] 1808 1809 1821 1824 1825 1827 1828 1829 1833 1835 1837 1840 1841 1842</span></span>
<span><span class="co">#&gt; [225] 1848 1849 1851 1852 1854 1855 1857 1859 1860 1862 1863 1865 1867 1868</span></span>
<span><span class="co">#&gt; [239] 1876 1878 1879 1880 1882 1883 1884 1886 1887 1889 1894 1898 1899 1905</span></span>
<span><span class="co">#&gt; [253] 1906 1907 1908 1909 1912 1919 1926 1927 1928 1930 1933 1934 1935 1936</span></span>
<span><span class="co">#&gt; [267] 1938 1940 1944 1947 1950 1952 1954 1955 1956 1960 1962 1963 1965 1966</span></span>
<span><span class="co">#&gt; [281] 1967 1969 1970 1974 1976 1977 1978 1980 1985 1987 1988 1990 1997 1998</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">Rbeast</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rbeast/man/beast.html" class="external-link">beast</a></span><span class="op">(</span></span>
<span>  <span class="va">mv_data_1</span>, season <span class="op">=</span> <span class="st">"none"</span>, print.progress <span class="op">=</span> <span class="cn">FALSE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span></span>
<span><span class="co">#&gt;  [1] 1794 1855 1986 1301  301  703 1981 1769 1860 1834</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="fu">mcp</span><span class="fu">::</span><span class="fu"><a href="https://lindeloev.github.io/mcp/reference/mcp.html" class="external-link">mcp</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mv_data_1</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages-mv_data_1-mcp.svg" alt="mcp plot for univariate mean and/or variance change"><div class="figcaption">
<code>mcp</code> plot for univariate mean and/or
variance change</div>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">not</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/not/man/not.html" class="external-link">not</a></span><span class="op">(</span><span class="va">mv_data_1</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMeanVar"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="comparison-packages_files/figure-html/univariate-mean-and-or-variance-change-not-1.png" width="768"></p>
<pre><code><span><span class="co">#&gt; Press [enter] to continue</span></span></code></pre>
<p><img src="comparison-packages_files/figure-html/univariate-mean-and-or-variance-change-not-2.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="multivariate-mean-change-1">Multivariate mean change<a class="anchor" aria-label="anchor" href="#multivariate-mean-change-1"></a>
</h2>
<p>The true change points are 300 and 700. Some methods are plotted due
to the un-retrievable change points.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fastcpd_result</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">mean_data_3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">CptNonPar_result</span> <span class="op">&lt;-</span> <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CptNonPar/man/np.mojo.html" class="external-link">np.mojo</a></span><span class="op">(</span><span class="va">mean_data_3</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span></span>
<span>      <span class="va">result_InspectChangepoint</span> <span class="op">&lt;-</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/InspectChangepoint/man/inspect.html" class="external-link">inspect</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span>,</span>
<span>        threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/InspectChangepoint/man/compute.threshold.html" class="external-link">compute.threshold</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">result_InspectChangepoint</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">jointseg_result</span> <span class="op">&lt;-</span> <span class="fu">jointseg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jointseg/man/jointSeg.html" class="external-link">jointSeg</a></span><span class="op">(</span><span class="va">mean_data_3</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span></span>
<span>    <span class="va">result_Rbeast</span> <span class="op">&lt;-</span> <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rbeast/man/beast123.html" class="external-link">beast123</a></span><span class="op">(</span></span>
<span>      <span class="va">mean_data_3</span>,</span>
<span>      metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>whichDimIsTime <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>      season <span class="op">=</span> <span class="st">"none"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">result_Rbeast</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span></span>
<span><span class="co">#&gt; Warning message:</span></span>
<span><span class="co">#&gt; In Rbeast::beast123(mean_data_3, metadata = list(whichDimIsTime = 1),  :</span></span>
<span><span class="co">#&gt;   WARNING: If the input data is regular and ordered in time,the times of individual datapoints are determined fully by 'metadata$startTime' and 'metadata$deltaTime'. But startTime and deltaTime are missing and a default value 1 is used for both!</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt;  [1,]  301  301  701</span></span>
<span><span class="co">#&gt;  [2,]  701  701  301</span></span>
<span><span class="co">#&gt;  [3,]  NaN  225  NaN</span></span>
<span><span class="co">#&gt;  [4,]  NaN  684  NaN</span></span>
<span><span class="co">#&gt;  [5,]  NaN  NaN  NaN</span></span>
<span><span class="co">#&gt;  [6,]  NaN  NaN  NaN</span></span>
<span><span class="co">#&gt;  [7,]  NaN  NaN  NaN</span></span>
<span><span class="co">#&gt;  [8,]  NaN  NaN  NaN</span></span>
<span><span class="co">#&gt;  [9,]  NaN  NaN  NaN</span></span>
<span><span class="co">#&gt; [10,]  NaN  NaN  NaN</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">strucchange</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/strucchange/man/breakpoints.html" class="external-link">breakpoints</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y.1</span>, <span class="va">y.2</span>, <span class="va">y.3</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_3</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ecp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ecp/man/e.divisive.html" class="external-link">e.divisive</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="co">#&gt; [1]    1  301  701 1001</span></span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">bcp</span><span class="fu">::</span><span class="fu">bcp</span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages-mean_data_3-bcp.svg" alt="bcp plot for multivariate mean change"><div class="figcaption">
<code>bcp</code> plot for multivariate mean
change</div>
</div>
</div>
<div class="section level2">
<h2 id="multivariate-mean-andor-variance-change-1">Multivariate mean and/or variance change<a class="anchor" aria-label="anchor" href="#multivariate-mean-andor-variance-change-1"></a>
</h2>
<p>The true change points are 300, 700, 1000, 1300 and 1700. Some
methods are plotted due to the un-retrievable change points.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fastcpd_result</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_meanvariance.html">fastcpd.mv</a></span><span class="op">(</span><span class="va">mv_data_3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  300  700 1000 1300 1700</span></span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ecp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ecp/man/e.divisive.html" class="external-link">e.divisive</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="co">#&gt; [1]    1  301  701 1001 1301 1701 2001</span></span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span></span>
<span>      <span class="va">result_InspectChangepoint</span> <span class="op">&lt;-</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/InspectChangepoint/man/inspect.html" class="external-link">inspect</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span>,</span>
<span>        threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/InspectChangepoint/man/compute.threshold.html" class="external-link">compute.threshold</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">result_InspectChangepoint</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span></span>
<span><span class="co">#&gt;   [1]  300  700  701  703  705  707  708  709  711  712  714  715  717  718</span></span>
<span><span class="co">#&gt;  [15]  720  721  723  724  726  727  729  731  733  734  736  737  739  740</span></span>
<span><span class="co">#&gt;  [29]  742  743  744  746  747  749  750  752  753  754  755  756  758  760</span></span>
<span><span class="co">#&gt;  [43]  762  763  765  766  767  769  770  772  773  774  775  777  779  780</span></span>
<span><span class="co">#&gt;  [57]  782  784  786  788  790  791  793  795  797  799  801  803  804  806</span></span>
<span><span class="co">#&gt;  [71]  808  809  810  811  813  814  816  817  818  820  821  823  825  827</span></span>
<span><span class="co">#&gt;  [85]  828  830  831  833  835  836  837  838  840  842  843  845  846  848</span></span>
<span><span class="co">#&gt;  [99]  849  850  852  853  854  855  856  858  859  860  862  863  865  866</span></span>
<span><span class="co">#&gt; [113]  868  869  871  872  874  876  877  878  879  881  883  885  887  888</span></span>
<span><span class="co">#&gt; [127]  889  891  893  894  895  897  898  900  901  903  904  906  908  909</span></span>
<span><span class="co">#&gt; [141]  911  913  914  916  917  918  920  921  923  924  925  927  928  929</span></span>
<span><span class="co">#&gt; [155]  931  932  934  936  937  938  939  941  942  943  945  946  947  949</span></span>
<span><span class="co">#&gt; [169]  950  952  954  955  956  957  958  959  961  962  964  965  967  968</span></span>
<span><span class="co">#&gt; [183]  970  972  973  974  975  977  979  981  982  984  985  986  987  988</span></span>
<span><span class="co">#&gt; [197]  990  991  992  994  995  997  999 1000 1300 1700 1702 1703 1704 1705</span></span>
<span><span class="co">#&gt; [211] 1706 1708 1709 1710 1712 1713 1714 1715 1717 1719 1721 1722 1723 1725</span></span>
<span><span class="co">#&gt; [225] 1727 1729 1730 1732 1734 1735 1737 1738 1739 1741 1742 1744 1746 1748</span></span>
<span><span class="co">#&gt; [239] 1750 1752 1753 1754 1755 1757 1758 1759 1761 1762 1763 1764 1766 1767</span></span>
<span><span class="co">#&gt; [253] 1769 1770 1771 1773 1774 1775 1777 1779 1781 1782 1783 1785 1786 1788</span></span>
<span><span class="co">#&gt; [267] 1789 1791 1793 1794 1796 1798 1800 1803 1804 1805 1806 1808 1809 1811</span></span>
<span><span class="co">#&gt; [281] 1812 1814 1815 1817 1818 1819 1821 1822 1824 1825 1827 1828 1829 1831</span></span>
<span><span class="co">#&gt; [295] 1833 1835 1836 1838 1839 1841 1843 1844 1846 1847 1848 1850 1851 1853</span></span>
<span><span class="co">#&gt; [309] 1854 1856 1857 1858 1859 1860 1862 1863 1864 1865 1867 1869 1870 1872</span></span>
<span><span class="co">#&gt; [323] 1873 1874 1876 1878 1879 1881 1882 1884 1885 1887 1889 1891 1893 1894</span></span>
<span><span class="co">#&gt; [337] 1896 1898 1899 1900 1901 1902 1904 1906 1907 1909 1911 1913 1914 1916</span></span>
<span><span class="co">#&gt; [351] 1917 1918 1919 1921 1923 1924 1925 1927 1928 1930 1932 1933 1935 1936</span></span>
<span><span class="co">#&gt; [365] 1938 1939 1941 1942 1944 1946 1948 1950 1951 1952 1954 1956 1957 1959</span></span>
<span><span class="co">#&gt; [379] 1961 1963 1965 1967 1968 1970 1972 1973 1974 1976 1977 1979 1981 1982</span></span>
<span><span class="co">#&gt; [393] 1984 1985 1987 1989 1990 1992 1993 1995 1996 1998</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span></span>
<span>    <span class="va">result_Rbeast</span> <span class="op">&lt;-</span> <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rbeast/man/beast123.html" class="external-link">beast123</a></span><span class="op">(</span></span>
<span>      <span class="va">mv_data_3</span>,</span>
<span>      metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>whichDimIsTime <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>      season <span class="op">=</span> <span class="st">"none"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">result_Rbeast</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span></span>
<span><span class="co">#&gt; Warning message:</span></span>
<span><span class="co">#&gt; In Rbeast::beast123(mv_data_3, metadata = list(whichDimIsTime = 1),  :</span></span>
<span><span class="co">#&gt;   WARNING: If the input data is regular and ordered in time,the times of individual datapoints are determined fully by 'metadata$startTime' and 'metadata$deltaTime'. But startTime and deltaTime are missing and a default value 1 is used for both!</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt;  [1,]  701  301  301  710</span></span>
<span><span class="co">#&gt;  [2,] 1301 1301 1301  301</span></span>
<span><span class="co">#&gt;  [3,]  301  701  702 1301</span></span>
<span><span class="co">#&gt;  [4,]  814 1993 1829 1986</span></span>
<span><span class="co">#&gt;  [5,] 1968  767 1822  785</span></span>
<span><span class="co">#&gt;  [6,] 1994  781  810  774</span></span>
<span><span class="co">#&gt;  [7,]  761  884  845 1912</span></span>
<span><span class="co">#&gt;  [8,] 1873  755  798  792</span></span>
<span><span class="co">#&gt;  [9,] 1865  747  771  879</span></span>
<span><span class="co">#&gt; [10,] 1962  924 1700 1919</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="linear-regression-1">Linear regression<a class="anchor" aria-label="anchor" href="#linear-regression-1"></a>
</h2>
<p>The true change points are 100 and 200.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fastcpd_result</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_lm.html">fastcpd.lm</a></span><span class="op">(</span><span class="va">lm_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  97 201</span></span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">strucchange</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/strucchange/man/breakpoints.html" class="external-link">breakpoints</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">lm_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="co">#&gt; [1] 100 201</span></span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">segmented_result</span> <span class="op">&lt;-</span> <span class="fu">segmented</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/segmented/man/segmented.html" class="external-link">segmented</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>    <span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lm_data</span><span class="op">$</span><span class="va">y</span>, x <span class="op">=</span> <span class="va">lm_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">lm_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  seg.Z <span class="op">=</span> <span class="op">~</span> <span class="va">index</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 233.0006</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="logistic-regression-1">Logistic regression<a class="anchor" aria-label="anchor" href="#logistic-regression-1"></a>
</h2>
<p>The true change point is 300.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fastcpd_result</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_binomial.html">fastcpd.binomial</a></span><span class="op">(</span><span class="va">binomial_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 302</span></span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">strucchange</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/strucchange/man/breakpoints.html" class="external-link">breakpoints</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">binomial_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="co">#&gt; [1] 297</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="poisson-regression-1">Poisson regression<a class="anchor" aria-label="anchor" href="#poisson-regression-1"></a>
</h2>
<p>The true change points are 500, 800 and 1000.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fastcpd_result</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_poisson.html">fastcpd.poisson</a></span><span class="op">(</span><span class="va">poisson_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  498  805 1003</span></span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">strucchange</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/strucchange/man/breakpoints.html" class="external-link">breakpoints</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">poisson_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="co">#&gt; [1] 935</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="lasso-1">Lasso<a class="anchor" aria-label="anchor" href="#lasso-1"></a>
</h2>
<p>The true change points are 80, 200 and 320.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fastcpd_result</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_lasso.html">fastcpd.lasso</a></span><span class="op">(</span><span class="va">lasso_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  79 199 321</span></span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>strucchange<span class="sc">::</span><span class="fu">breakpoints</span>(y <span class="sc">~</span> . <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> lasso_data)<span class="sc">$</span>breakpoints,</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="co">#&gt; [1]  80 200 321</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="ar3-1">AR(3)<a class="anchor" aria-label="anchor" href="#ar3-1"></a>
</h2>
<p>The true change point is 600. Some methods are plotted due to the
un-retrievable change points.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fastcpd_result</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_ar.html">fastcpd.ar</a></span><span class="op">(</span><span class="va">ar_data</span>, <span class="fl">3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 614</span></span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">CptNonPar_result</span> <span class="op">&lt;-</span> <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CptNonPar/man/np.mojo.html" class="external-link">np.mojo</a></span><span class="op">(</span><span class="va">ar_data</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span><span class="op">)</span></span>
<span><span class="co">#&gt; numeric(0)</span></span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">segmented_result</span> <span class="op">&lt;-</span> <span class="fu">segmented</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/segmented/man/segmented.html" class="external-link">segmented</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>    <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ar_data</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  seg.Z <span class="op">=</span> <span class="op">~</span> <span class="va">x</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 690</span></span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="fu">mcp</span><span class="fu">::</span><span class="fu"><a href="https://lindeloev.github.io/mcp/reference/mcp.html" class="external-link">mcp</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/ar.html" class="external-link">ar</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/ar.html" class="external-link">ar</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ar_data</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages-ar_data-mcp.svg" alt="mcp plot for AR(3)"><div class="figcaption">
<code>mcp</code> plot for AR(3)</div>
</div>
</div>
<div class="section level2">
<h2 id="garch1-1-1">GARCH(1, 1)<a class="anchor" aria-label="anchor" href="#garch1-1-1"></a>
</h2>
<p>The true change point is 200.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fastcpd_result</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_garch.html">fastcpd.garch</a></span><span class="op">(</span><span class="va">garch_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'quantmod':</span></span>
<span><span class="co">#&gt;   method            from</span></span>
<span><span class="co">#&gt;   as.zoo.data.frame zoo</span></span>
<span><span class="co">#&gt; [1] 205</span></span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">CptNonPar_result</span> <span class="op">&lt;-</span> <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CptNonPar/man/np.mojo.html" class="external-link">np.mojo</a></span><span class="op">(</span><span class="va">garch_data</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">garch_data</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 206</span></span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">strucchange</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/strucchange/man/breakpoints.html" class="external-link">breakpoints</a></span><span class="op">(</span><span class="va">x</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">garch_data</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="co">#&gt; [1] NA</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="var2-1">VAR(2)<a class="anchor" aria-label="anchor" href="#var2-1"></a>
</h2>
<p>The true change points is 500.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">fastcpd_result</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_var.html">fastcpd.var</a></span><span class="op">(</span></span>
<span>  <span class="va">var_data</span>, <span class="fl">2</span>, cost_adjustment <span class="op">=</span> <span class="cn">NULL</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 500</span></span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">VARDetect_result</span> <span class="op">&lt;-</span> <span class="fu">VARDetect</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/VARDetect/man/tbss.html" class="external-link">tbss</a></span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span><span class="op">$</span><span class="va">cp</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "first.brk.points:"</span></span>
<span><span class="co">#&gt;  [1] 140 196 252 308 364 420 476 532 588 644 700</span></span>
<span><span class="co">#&gt; [1] "selected lambda1:"</span></span>
<span><span class="co">#&gt; [1] 0.2107081</span></span>
<span><span class="co">#&gt; [1] "selected lambda2:"</span></span>
<span><span class="co">#&gt; [1] 0.02943525</span></span>
<span><span class="co">#&gt; [1] "second.brk.points:"</span></span>
<span><span class="co">#&gt; [1] 308 364 588</span></span>
<span><span class="co">#&gt; [1] "second.brk.points:"</span></span>
<span><span class="co">#&gt; [1] 308 476 588</span></span>
<span><span class="co">#&gt; [1] "second.brk.points:"</span></span>
<span><span class="co">#&gt; [1] 476 532</span></span>
<span><span class="co">#&gt; [1] "second.brk.points:"</span></span>
<span><span class="co">#&gt; [1] 476 532</span></span>
<span><span class="co">#&gt; [1] "second.brk.points:"</span></span>
<span><span class="co">#&gt; [1] 476 532</span></span>
<span><span class="co">#&gt; no refit for the parameter estimation</span></span>
<span><span class="co">#&gt; [1] 501</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="detection-comparison-using-well_log">Detection comparison using <code>well_log</code><a class="anchor" aria-label="anchor" href="#detection-comparison-using-well_log"></a>
</h2>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">well_log</span> <span class="op">&lt;-</span> <span class="va">well_log</span><span class="op">[</span><span class="va">well_log</span> <span class="op">&gt;</span> <span class="fl">1e5</span><span class="op">]</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  fastcpd <span class="op">=</span> <span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">well_log</span>, trim <span class="op">=</span> <span class="fl">0.003</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span>,</span>
<span>  changepoint <span class="op">=</span> <span class="fu">changepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/changepoint/man/cpt.mean.html" class="external-link">cpt.mean</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">@</span><span class="va">cpts</span>,</span>
<span>  CptNonPar <span class="op">=</span></span>
<span>    <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CptNonPar/man/np.mojo.html" class="external-link">np.mojo</a></span><span class="op">(</span><span class="va">well_log</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  strucchange <span class="op">=</span> <span class="fu">strucchange</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/strucchange/man/breakpoints.html" class="external-link">breakpoints</a></span><span class="op">(</span></span>
<span>    <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">well_log</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span>,</span>
<span>  ecp <span class="op">=</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ecp/man/e.divisive.html" class="external-link">e.divisive</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span>,</span>
<span>  breakfast <span class="op">=</span> <span class="fu">breakfast</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/breakfast/man/breakfast.html" class="external-link">breakfast</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">$</span><span class="va">cptmodel.list</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  wbs <span class="op">=</span> <span class="fu">wbs</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/wbs/man/wbs.html" class="external-link">wbs</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">$</span><span class="va">cpt</span><span class="op">$</span><span class="va">cpt.ic</span><span class="op">$</span><span class="va">mbic.penalty</span>,</span>
<span>  mosum <span class="op">=</span> <span class="fu">mosum</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mosum/man/mosum.html" class="external-link">mosum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">$</span><span class="va">cpts.info</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  <span class="co"># fpop = fpop::Fpop(well_log, length(well_log))$t.est,  # meaningless</span></span>
<span>  gfpop <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gfpop/man/gfpop.html" class="external-link">gfpop</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">well_log</span>,</span>
<span>    mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gfpop/man/graph.html" class="external-link">graph</a></span><span class="op">(</span></span>
<span>      penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gfpop/man/sdDiff.html" class="external-link">sdDiff</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">changepoints</span>,</span>
<span>  InspectChangepoint <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/InspectChangepoint/man/inspect.html" class="external-link">inspect</a></span><span class="op">(</span></span>
<span>    <span class="va">well_log</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/InspectChangepoint/man/compute.threshold.html" class="external-link">compute.threshold</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span>,</span>
<span>  jointseg <span class="op">=</span> <span class="fu">jointseg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jointseg/man/jointSeg.html" class="external-link">jointSeg</a></span><span class="op">(</span><span class="va">well_log</span>, K <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span>,</span>
<span>  Rbeast <span class="op">=</span> <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rbeast/man/beast.html" class="external-link">beast</a></span><span class="op">(</span></span>
<span>    <span class="va">well_log</span>, season <span class="op">=</span> <span class="st">"none"</span>, print.progress <span class="op">=</span> <span class="cn">FALSE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span>,</span>
<span>  stepR <span class="op">=</span> <span class="fu">stepR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stepR/man/stepFit.html" class="external-link">stepFit</a></span><span class="op">(</span><span class="va">well_log</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">$</span><span class="va">rightEnd</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">package_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">package_index</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">package_list</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">package</span> <span class="op">&lt;-</span> <span class="va">package_list</span><span class="op">[[</span><span class="va">package_index</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="va">comparison_table</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      change_point <span class="op">=</span> <span class="va">result</span><span class="op">[[</span><span class="va">package</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      package <span class="op">=</span> <span class="va">package</span>,</span>
<span>      y_offset <span class="op">=</span> <span class="op">(</span><span class="va">package_index</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1000</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">comparison_table</span><span class="op">$</span><span class="va">change_point</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">[</span><span class="va">most_selected</span> <span class="op">&gt;=</span> <span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.5</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="op">(</span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="va">most_selected</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1]    6.0  314.0  434.0  704.0  776.0 1021.0 1057.0 1347.0 1405.0 1502.0 1661.0 1842.0 2023.0 2202.0</span></span>
<span><span class="co">#&gt; [15] 2384.5 2445.0 2507.0 2567.5 2738.0 2921.0 3094.0 3251.0 3464.0 3499.0 3622.0 3709.0 3820.0 3976.0</span></span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="va">most_selected</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">comparison_table</span>,</span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">change_point</span>, y <span class="op">=</span> <span class="fl">50000</span> <span class="op">+</span> <span class="va">y_offset</span>, color <span class="op">=</span> <span class="va">package</span><span class="op">)</span>,</span>
<span>    shape <span class="op">=</span> <span class="fl">17</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.9</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">comparison_table</span>,</span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">50000</span> <span class="op">+</span> <span class="va">y_offset</span>, color <span class="op">=</span> <span class="va">package</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span></span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50000</span> <span class="op">-</span> <span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">+</span> <span class="fl">200</span><span class="op">)</span>,</span>
<span>    expand <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.border <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages-well_log-cpts.svg" alt="Plot of the detection using well_log data"><div class="figcaption">Plot of the detection using
<code>well_log</code> data</div>
</div>
</div>
<div class="section level2">
<h2 id="time-comparison-using-well_log">Time comparison using <code>well_log</code><a class="anchor" aria-label="anchor" href="#time-comparison-using-well_log"></a>
</h2>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">microbenchmark_result</span> <span class="op">&lt;-</span> <span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu">microbenchmark</span><span class="op">(</span></span>
<span>  fastcpd <span class="op">=</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">well_log</span>, trim <span class="op">=</span> <span class="fl">0.003</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  changepoint <span class="op">=</span> <span class="fu">changepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/changepoint/man/cpt.mean.html" class="external-link">cpt.mean</a></span><span class="op">(</span><span class="va">well_log</span>, method <span class="op">=</span> <span class="st">"PELT"</span><span class="op">)</span>,</span>
<span>  CptNonPar <span class="op">=</span> <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CptNonPar/man/np.mojo.html" class="external-link">np.mojo</a></span><span class="op">(</span><span class="va">well_log</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  strucchange <span class="op">=</span></span>
<span>    <span class="fu">strucchange</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/strucchange/man/breakpoints.html" class="external-link">breakpoints</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ecp <span class="op">=</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ecp/man/e.divisive.html" class="external-link">e.divisive</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  breakfast <span class="op">=</span> <span class="fu">breakfast</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/breakfast/man/breakfast.html" class="external-link">breakfast</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>,</span>
<span>  wbs <span class="op">=</span> <span class="fu">wbs</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/wbs/man/wbs.html" class="external-link">wbs</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>,</span>
<span>  mosum <span class="op">=</span> <span class="fu">mosum</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mosum/man/mosum.html" class="external-link">mosum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span>,</span>
<span>  fpop <span class="op">=</span> <span class="fu">fpop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fpop/man/Fpop.html" class="external-link">Fpop</a></span><span class="op">(</span><span class="va">well_log</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  gfpop <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gfpop/man/gfpop.html" class="external-link">gfpop</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">well_log</span>,</span>
<span>    mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gfpop/man/graph.html" class="external-link">graph</a></span><span class="op">(</span></span>
<span>      penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gfpop/man/sdDiff.html" class="external-link">sdDiff</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  InspectChangepoint <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/InspectChangepoint/man/inspect.html" class="external-link">inspect</a></span><span class="op">(</span></span>
<span>    <span class="va">well_log</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/InspectChangepoint/man/compute.threshold.html" class="external-link">compute.threshold</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  jointseg <span class="op">=</span> <span class="fu">jointseg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jointseg/man/jointSeg.html" class="external-link">jointSeg</a></span><span class="op">(</span><span class="va">well_log</span>, K <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>  Rbeast <span class="op">=</span> <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rbeast/man/beast.html" class="external-link">beast</a></span><span class="op">(</span></span>
<span>    <span class="va">well_log</span>, season <span class="op">=</span> <span class="st">"none"</span>, print.progress <span class="op">=</span> <span class="cn">FALSE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  stepR <span class="op">=</span> <span class="fu">stepR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stepR/man/stepFit.html" class="external-link">stepFit</a></span><span class="op">(</span><span class="va">well_log</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  not <span class="op">=</span> <span class="fu">not</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/not/man/not.html" class="external-link">not</a></span><span class="op">(</span><span class="va">well_log</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMean"</span><span class="op">)</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Unit: milliseconds</span></span>
<span><span class="co">#&gt;                expr          min           lq         mean       median           uq          max neval</span></span>
<span><span class="co">#&gt;             fastcpd 8.411284e+01 8.692226e+01 1.011440e+02 1.044509e+02 1.089672e+02    118.05842    10</span></span>
<span><span class="co">#&gt;         changepoint 3.206773e+01 3.377081e+01 6.843465e+01 3.857181e+01 5.243834e+01    244.76672    10</span></span>
<span><span class="co">#&gt;           CptNonPar 1.827381e+04 1.901094e+04 2.002752e+04 1.985180e+04 2.076803e+04  22511.59316    10</span></span>
<span><span class="co">#&gt;         strucchange 5.955079e+04 6.059315e+04 6.185727e+04 6.131291e+04 6.312073e+04  64638.93090    10</span></span>
<span><span class="co">#&gt;                 ecp 7.590543e+05 7.707573e+05 7.859080e+05 7.830752e+05 8.093015e+05 810339.52140    10</span></span>
<span><span class="co">#&gt;           breakfast 9.170992e+03 9.344041e+03 9.628236e+03 9.382078e+03 9.628663e+03  11073.79318    10</span></span>
<span><span class="co">#&gt;                 wbs 1.139078e+02 1.145472e+02 1.178167e+02 1.166746e+02 1.201676e+02    127.27064    10</span></span>
<span><span class="co">#&gt;               mosum 1.172847e+00 1.231747e+00 1.740727e+01 1.416854e+00 1.919586e+00    160.76997    10</span></span>
<span><span class="co">#&gt;                fpop 2.588228e+00 2.630407e+00 4.587742e+00 2.832556e+00 3.312986e+00     18.52067    10</span></span>
<span><span class="co">#&gt;               gfpop 5.971245e+01 6.072684e+01 6.533492e+01 6.172578e+01 6.839653e+01     87.89407    10</span></span>
<span><span class="co">#&gt;  InspectChangepoint 1.698673e+02 1.909034e+02 2.392539e+02 2.117010e+02 3.004474e+02    329.87724    10</span></span>
<span><span class="co">#&gt;            jointseg 2.000894e+01 2.136878e+01 2.551210e+01 2.167757e+01 2.403593e+01     47.98397    10</span></span>
<span><span class="co">#&gt;              Rbeast 6.533998e+02 6.625203e+02 6.783586e+02 6.792646e+02 6.875840e+02    723.45376    10</span></span>
<span><span class="co">#&gt;               stepR 2.793709e+01 2.902084e+01 4.380857e+01 3.068416e+01 3.227125e+01    164.81082    10</span></span>
<span><span class="co">#&gt;                 not 9.599763e+01 9.701856e+01 1.028601e+02 1.012292e+02 1.049974e+02    120.73529    10</span></span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">microbenchmark_result</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages-well_log-time.svg" alt="Plot of the running time using well_log data"><div class="figcaption">Plot of the running time using
<code>well_log</code> data</div>
</div>
</div>
<div class="section level2">
<h2 id="related-issues">Related issues<a class="anchor" aria-label="anchor" href="#related-issues"></a>
</h2>
<ul>
<li>
<code>mosum</code>: [<a href="https://github.com/doccstat/fastcpd/issues/4" class="external-link">#4</a>].</li>
<li>
<code>mcp</code>: <a href="https://github.com/doccstat/fastcpd/actions/runs/7272426093/job/19814531091" class="external-link">link
1</a> and <a href="https://github.com/doccstat/fastcpd/actions/runs/7272426093/job/19814531284" class="external-link">link
2</a>.</li>
<li>
<code>bcp</code>: [<a href="https://github.com/doccstat/fastcpd/issues/5" class="external-link">#5</a>].</li>
<li>
<code>gfpop</code>: [<a href="https://github.com/doccstat/fastcpd/issues/10" class="external-link">#10</a>].</li>
</ul>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<ul>
<li>
<a href="https://www.unipa.it/persone/docenti/m/vito.muggeo" class="external-link">Dr.Â Vito
Muggeo</a>, author of the <code>segmented</code> package for the tips
about the piece-wise constant function.</li>
</ul>
</div>
<div class="section level2">
<h2 id="appendix-all-code-snippets">Appendix: all code snippets<a class="anchor" aria-label="anchor" href="#appendix-all-code-snippets"></a>
</h2>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>  <span class="at">collapse =</span> <span class="cn">TRUE</span>, <span class="at">comment =</span> <span class="st">"#&gt;"</span>, <span class="at">eval =</span> <span class="cn">TRUE</span>, <span class="at">cache =</span> <span class="cn">FALSE</span>,</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>  <span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">fig.width =</span> <span class="dv">8</span>, <span class="at">fig.height =</span> <span class="dv">5</span></span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>)</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a><span class="co"># Univariate mean change</span></span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>mean_data_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">0</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">100</span>, p)),</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">400</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">50</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">100</span>, p)),</span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">2</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">100</span>, p))</span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a>)</span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a></span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a><span class="fu">plot.ts</span>(mean_data_1)</span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a><span class="co"># Univariate mean and/or variance change</span></span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a>mv_data_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">0</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">1</span>, p)),</span>
<span id="cb76-20"><a href="#cb76-20" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">400</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">10</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">1</span>, p)),</span>
<span id="cb76-21"><a href="#cb76-21" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">0</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">100</span>, p)),</span>
<span id="cb76-22"><a href="#cb76-22" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">0</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">1</span>, p)),</span>
<span id="cb76-23"><a href="#cb76-23" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">400</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">10</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">1</span>, p)),</span>
<span id="cb76-24"><a href="#cb76-24" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">10</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">100</span>, p))</span>
<span id="cb76-25"><a href="#cb76-25" tabindex="-1"></a>)</span>
<span id="cb76-26"><a href="#cb76-26" tabindex="-1"></a></span>
<span id="cb76-27"><a href="#cb76-27" tabindex="-1"></a><span class="fu">plot.ts</span>(mv_data_1)</span>
<span id="cb76-28"><a href="#cb76-28" tabindex="-1"></a><span class="co"># Multivariate mean change</span></span>
<span id="cb76-29"><a href="#cb76-29" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-30"><a href="#cb76-30" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb76-31"><a href="#cb76-31" tabindex="-1"></a>mean_data_3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb76-32"><a href="#cb76-32" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">0</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">100</span>, p)),</span>
<span id="cb76-33"><a href="#cb76-33" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">400</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">50</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">100</span>, p)),</span>
<span id="cb76-34"><a href="#cb76-34" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">2</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">100</span>, p))</span>
<span id="cb76-35"><a href="#cb76-35" tabindex="-1"></a>)</span>
<span id="cb76-36"><a href="#cb76-36" tabindex="-1"></a></span>
<span id="cb76-37"><a href="#cb76-37" tabindex="-1"></a><span class="fu">plot.ts</span>(mean_data_3)</span>
<span id="cb76-38"><a href="#cb76-38" tabindex="-1"></a><span class="co"># Multivariate mean and/or variance change</span></span>
<span id="cb76-39"><a href="#cb76-39" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-40"><a href="#cb76-40" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb76-41"><a href="#cb76-41" tabindex="-1"></a>mv_data_3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb76-42"><a href="#cb76-42" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">0</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">1</span>, p)),</span>
<span id="cb76-43"><a href="#cb76-43" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">400</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">10</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">1</span>, p)),</span>
<span id="cb76-44"><a href="#cb76-44" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">0</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">100</span>, p)),</span>
<span id="cb76-45"><a href="#cb76-45" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">0</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">1</span>, p)),</span>
<span id="cb76-46"><a href="#cb76-46" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">400</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">10</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">1</span>, p)),</span>
<span id="cb76-47"><a href="#cb76-47" tabindex="-1"></a>  mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">10</span>, p), <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">100</span>, p))</span>
<span id="cb76-48"><a href="#cb76-48" tabindex="-1"></a>)</span>
<span id="cb76-49"><a href="#cb76-49" tabindex="-1"></a></span>
<span id="cb76-50"><a href="#cb76-50" tabindex="-1"></a><span class="fu">plot.ts</span>(mv_data_3)</span>
<span id="cb76-51"><a href="#cb76-51" tabindex="-1"></a><span class="co"># Linear regression</span></span>
<span id="cb76-52"><a href="#cb76-52" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-53"><a href="#cb76-53" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb76-54"><a href="#cb76-54" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb76-55"><a href="#cb76-55" tabindex="-1"></a>x <span class="ot">&lt;-</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(n, <span class="fu">rep</span>(<span class="dv">0</span>, p), <span class="fu">diag</span>(p))</span>
<span id="cb76-56"><a href="#cb76-56" tabindex="-1"></a>theta_0 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">3.2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">2.5</span>, <span class="sc">-</span><span class="dv">2</span>), <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb76-57"><a href="#cb76-57" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb76-58"><a href="#cb76-58" tabindex="-1"></a>  x[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, ] <span class="sc">%*%</span> theta_0[<span class="dv">1</span>, ] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb76-59"><a href="#cb76-59" tabindex="-1"></a>  x[<span class="dv">101</span><span class="sc">:</span><span class="dv">200</span>, ] <span class="sc">%*%</span> theta_0[<span class="dv">2</span>, ] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">3</span>),</span>
<span id="cb76-60"><a href="#cb76-60" tabindex="-1"></a>  x[<span class="dv">201</span><span class="sc">:</span>n, ] <span class="sc">%*%</span> theta_0[<span class="dv">3</span>, ] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb76-61"><a href="#cb76-61" tabindex="-1"></a>)</span>
<span id="cb76-62"><a href="#cb76-62" tabindex="-1"></a>lm_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> y, <span class="at">x =</span> x)</span>
<span id="cb76-63"><a href="#cb76-63" tabindex="-1"></a></span>
<span id="cb76-64"><a href="#cb76-64" tabindex="-1"></a><span class="fu">plot.ts</span>(lm_data)</span>
<span id="cb76-65"><a href="#cb76-65" tabindex="-1"></a><span class="co"># Logistic regression</span></span>
<span id="cb76-66"><a href="#cb76-66" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-67"><a href="#cb76-67" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb76-68"><a href="#cb76-68" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb76-69"><a href="#cb76-69" tabindex="-1"></a>x <span class="ot">&lt;-</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(n, <span class="fu">rep</span>(<span class="dv">0</span>, p), <span class="fu">diag</span>(p))</span>
<span id="cb76-70"><a href="#cb76-70" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">rnorm</span>(p, <span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">rnorm</span>(p, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb76-71"><a href="#cb76-71" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb76-72"><a href="#cb76-72" tabindex="-1"></a>  <span class="fu">rbinom</span>(<span class="dv">300</span>, <span class="dv">1</span>, <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x[<span class="dv">1</span><span class="sc">:</span><span class="dv">300</span>, ] <span class="sc">%*%</span> theta[<span class="dv">1</span>, ]))),</span>
<span id="cb76-73"><a href="#cb76-73" tabindex="-1"></a>  <span class="fu">rbinom</span>(<span class="dv">200</span>, <span class="dv">1</span>, <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x[<span class="dv">301</span><span class="sc">:</span>n, ] <span class="sc">%*%</span> theta[<span class="dv">2</span>, ])))</span>
<span id="cb76-74"><a href="#cb76-74" tabindex="-1"></a>)</span>
<span id="cb76-75"><a href="#cb76-75" tabindex="-1"></a>binomial_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> y, <span class="at">x =</span> x)</span>
<span id="cb76-76"><a href="#cb76-76" tabindex="-1"></a></span>
<span id="cb76-77"><a href="#cb76-77" tabindex="-1"></a><span class="fu">plot.ts</span>(binomial_data)</span>
<span id="cb76-78"><a href="#cb76-78" tabindex="-1"></a><span class="co"># Poisson regression</span></span>
<span id="cb76-79"><a href="#cb76-79" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-80"><a href="#cb76-80" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1100</span></span>
<span id="cb76-81"><a href="#cb76-81" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb76-82"><a href="#cb76-82" tabindex="-1"></a>x <span class="ot">&lt;-</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(n, <span class="fu">rep</span>(<span class="dv">0</span>, p), <span class="fu">diag</span>(p))</span>
<span id="cb76-83"><a href="#cb76-83" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(p)</span>
<span id="cb76-84"><a href="#cb76-84" tabindex="-1"></a>theta_0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.3</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb76-85"><a href="#cb76-85" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb76-86"><a href="#cb76-86" tabindex="-1"></a>  <span class="fu">rpois</span>(<span class="dv">500</span>, <span class="fu">exp</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>, ] <span class="sc">%*%</span> theta_0)),</span>
<span id="cb76-87"><a href="#cb76-87" tabindex="-1"></a>  <span class="fu">rpois</span>(<span class="dv">300</span>, <span class="fu">exp</span>(x[<span class="dv">501</span><span class="sc">:</span><span class="dv">800</span>, ] <span class="sc">%*%</span> (theta_0 <span class="sc">+</span> delta))),</span>
<span id="cb76-88"><a href="#cb76-88" tabindex="-1"></a>  <span class="fu">rpois</span>(<span class="dv">200</span>, <span class="fu">exp</span>(x[<span class="dv">801</span><span class="sc">:</span><span class="dv">1000</span>, ] <span class="sc">%*%</span> theta_0)),</span>
<span id="cb76-89"><a href="#cb76-89" tabindex="-1"></a>  <span class="fu">rpois</span>(<span class="dv">100</span>, <span class="fu">exp</span>(x[<span class="dv">1001</span><span class="sc">:</span><span class="dv">1100</span>, ] <span class="sc">%*%</span> (theta_0 <span class="sc">-</span> delta)))</span>
<span id="cb76-90"><a href="#cb76-90" tabindex="-1"></a>)</span>
<span id="cb76-91"><a href="#cb76-91" tabindex="-1"></a>poisson_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> y, <span class="at">x =</span> x)</span>
<span id="cb76-92"><a href="#cb76-92" tabindex="-1"></a></span>
<span id="cb76-93"><a href="#cb76-93" tabindex="-1"></a><span class="fu">plot.ts</span>(<span class="fu">log</span>(poisson_data<span class="sc">$</span>y))</span>
<span id="cb76-94"><a href="#cb76-94" tabindex="-1"></a><span class="fu">plot.ts</span>(poisson_data[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb76-95"><a href="#cb76-95" tabindex="-1"></a><span class="co"># Lasso</span></span>
<span id="cb76-96"><a href="#cb76-96" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-97"><a href="#cb76-97" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">480</span></span>
<span id="cb76-98"><a href="#cb76-98" tabindex="-1"></a>p_true <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb76-99"><a href="#cb76-99" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb76-100"><a href="#cb76-100" tabindex="-1"></a>x <span class="ot">&lt;-</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(n, <span class="fu">rep</span>(<span class="dv">0</span>, p), <span class="fu">diag</span>(p))</span>
<span id="cb76-101"><a href="#cb76-101" tabindex="-1"></a>theta_0 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb76-102"><a href="#cb76-102" tabindex="-1"></a>  <span class="fu">runif</span>(p_true, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>),</span>
<span id="cb76-103"><a href="#cb76-103" tabindex="-1"></a>  <span class="fu">runif</span>(p_true, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb76-104"><a href="#cb76-104" tabindex="-1"></a>  <span class="fu">runif</span>(p_true, <span class="dv">2</span>, <span class="dv">5</span>),</span>
<span id="cb76-105"><a href="#cb76-105" tabindex="-1"></a>  <span class="fu">runif</span>(p_true, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb76-106"><a href="#cb76-106" tabindex="-1"></a>)</span>
<span id="cb76-107"><a href="#cb76-107" tabindex="-1"></a>theta_0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(theta_0, <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">ncol =</span> p <span class="sc">-</span> p_true, <span class="at">nrow =</span> <span class="dv">4</span>))</span>
<span id="cb76-108"><a href="#cb76-108" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb76-109"><a href="#cb76-109" tabindex="-1"></a>  x[<span class="dv">1</span><span class="sc">:</span><span class="dv">80</span>, ] <span class="sc">%*%</span> theta_0[<span class="dv">1</span>, ] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">80</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb76-110"><a href="#cb76-110" tabindex="-1"></a>  x[<span class="dv">81</span><span class="sc">:</span><span class="dv">200</span>, ] <span class="sc">%*%</span> theta_0[<span class="dv">2</span>, ] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">120</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb76-111"><a href="#cb76-111" tabindex="-1"></a>  x[<span class="dv">201</span><span class="sc">:</span><span class="dv">320</span>, ] <span class="sc">%*%</span> theta_0[<span class="dv">3</span>, ] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">120</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb76-112"><a href="#cb76-112" tabindex="-1"></a>  x[<span class="dv">321</span><span class="sc">:</span>n, ] <span class="sc">%*%</span> theta_0[<span class="dv">4</span>, ] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">160</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb76-113"><a href="#cb76-113" tabindex="-1"></a>)</span>
<span id="cb76-114"><a href="#cb76-114" tabindex="-1"></a>lasso_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y =</span> y, <span class="at">x =</span> x)</span>
<span id="cb76-115"><a href="#cb76-115" tabindex="-1"></a></span>
<span id="cb76-116"><a href="#cb76-116" tabindex="-1"></a><span class="fu">plot.ts</span>(lasso_data[, <span class="fu">seq_len</span>(p_true <span class="sc">+</span> <span class="dv">1</span>)])</span>
<span id="cb76-117"><a href="#cb76-117" tabindex="-1"></a><span class="co"># AR(3)</span></span>
<span id="cb76-118"><a href="#cb76-118" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-119"><a href="#cb76-119" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb76-120"><a href="#cb76-120" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n <span class="sc">+</span> <span class="dv">3</span>)</span>
<span id="cb76-121"><a href="#cb76-121" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">600</span>) {</span>
<span id="cb76-122"><a href="#cb76-122" tabindex="-1"></a>  x[i <span class="sc">+</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fl">0.6</span> <span class="sc">*</span> x[i <span class="sc">+</span> <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.2</span> <span class="sc">*</span> x[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> x[i] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb76-123"><a href="#cb76-123" tabindex="-1"></a>}</span>
<span id="cb76-124"><a href="#cb76-124" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">601</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb76-125"><a href="#cb76-125" tabindex="-1"></a>  x[i <span class="sc">+</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fl">0.3</span> <span class="sc">*</span> x[i <span class="sc">+</span> <span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> x[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> x[i] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>)</span>
<span id="cb76-126"><a href="#cb76-126" tabindex="-1"></a>}</span>
<span id="cb76-127"><a href="#cb76-127" tabindex="-1"></a>ar_data <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="fu">seq_len</span>(<span class="dv">3</span>)]</span>
<span id="cb76-128"><a href="#cb76-128" tabindex="-1"></a></span>
<span id="cb76-129"><a href="#cb76-129" tabindex="-1"></a><span class="fu">plot.ts</span>(ar_data)</span>
<span id="cb76-130"><a href="#cb76-130" tabindex="-1"></a><span class="co"># GARCH(1, 1)</span></span>
<span id="cb76-131"><a href="#cb76-131" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-132"><a href="#cb76-132" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">400</span></span>
<span id="cb76-133"><a href="#cb76-133" tabindex="-1"></a>sigma_2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, n <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb76-134"><a href="#cb76-134" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb76-135"><a href="#cb76-135" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="dv">200</span>)) {</span>
<span id="cb76-136"><a href="#cb76-136" tabindex="-1"></a>  sigma_2[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> x[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> sigma_2[i]</span>
<span id="cb76-137"><a href="#cb76-137" tabindex="-1"></a>  x[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="fu">sqrt</span>(sigma_2[i <span class="sc">+</span> <span class="dv">1</span>]))</span>
<span id="cb76-138"><a href="#cb76-138" tabindex="-1"></a>}</span>
<span id="cb76-139"><a href="#cb76-139" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">400</span>) {</span>
<span id="cb76-140"><a href="#cb76-140" tabindex="-1"></a>  sigma_2[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.1</span> <span class="sc">*</span> x[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> sigma_2[i]</span>
<span id="cb76-141"><a href="#cb76-141" tabindex="-1"></a>  x[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="fu">sqrt</span>(sigma_2[i <span class="sc">+</span> <span class="dv">1</span>]))</span>
<span id="cb76-142"><a href="#cb76-142" tabindex="-1"></a>}</span>
<span id="cb76-143"><a href="#cb76-143" tabindex="-1"></a>garch_data <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb76-144"><a href="#cb76-144" tabindex="-1"></a></span>
<span id="cb76-145"><a href="#cb76-145" tabindex="-1"></a><span class="fu">plot.ts</span>(garch_data)</span>
<span id="cb76-146"><a href="#cb76-146" tabindex="-1"></a><span class="co"># VAR(2)</span></span>
<span id="cb76-147"><a href="#cb76-147" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-148"><a href="#cb76-148" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">800</span></span>
<span id="cb76-149"><a href="#cb76-149" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb76-150"><a href="#cb76-150" tabindex="-1"></a>theta_1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.2</span>), <span class="at">nrow =</span> p)</span>
<span id="cb76-151"><a href="#cb76-151" tabindex="-1"></a>theta_2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.3</span>, <span class="sc">-</span><span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.2</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span>), <span class="at">nrow =</span> p)</span>
<span id="cb76-152"><a href="#cb76-152" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n <span class="sc">+</span> <span class="dv">2</span>, p)</span>
<span id="cb76-153"><a href="#cb76-153" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>) {</span>
<span id="cb76-154"><a href="#cb76-154" tabindex="-1"></a>  x[i <span class="sc">+</span> <span class="dv">2</span>, ] <span class="ot">&lt;-</span> theta_1 <span class="sc">%*%</span> <span class="fu">c</span>(x[i <span class="sc">+</span> <span class="dv">1</span>, ], x[i, ]) <span class="sc">+</span> <span class="fu">rnorm</span>(p, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb76-155"><a href="#cb76-155" tabindex="-1"></a>}</span>
<span id="cb76-156"><a href="#cb76-156" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">501</span><span class="sc">:</span>n) {</span>
<span id="cb76-157"><a href="#cb76-157" tabindex="-1"></a>  x[i <span class="sc">+</span> <span class="dv">2</span>, ] <span class="ot">&lt;-</span> theta_2 <span class="sc">%*%</span> <span class="fu">c</span>(x[i <span class="sc">+</span> <span class="dv">1</span>, ], x[i, ]) <span class="sc">+</span> <span class="fu">rnorm</span>(p, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb76-158"><a href="#cb76-158" tabindex="-1"></a>}</span>
<span id="cb76-159"><a href="#cb76-159" tabindex="-1"></a>var_data <span class="ot">&lt;-</span> x[<span class="sc">-</span><span class="fu">seq_len</span>(<span class="dv">2</span>), ]</span>
<span id="cb76-160"><a href="#cb76-160" tabindex="-1"></a></span>
<span id="cb76-161"><a href="#cb76-161" tabindex="-1"></a><span class="fu">plot.ts</span>(var_data)</span>
<span id="cb76-162"><a href="#cb76-162" tabindex="-1"></a>(fastcpd_result <span class="ot">&lt;-</span> fastcpd<span class="sc">::</span><span class="fu">fastcpd.mean</span>(mean_data_1, <span class="at">r.progress =</span> <span class="cn">FALSE</span>)<span class="sc">@</span>cp_set)</span>
<span id="cb76-163"><a href="#cb76-163" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(fastcpd_result, <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">700</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-164"><a href="#cb76-164" tabindex="-1"></a>(CptNonPar_result <span class="ot">&lt;-</span> CptNonPar<span class="sc">::</span><span class="fu">np.mojo</span>(mean_data_1, <span class="at">G =</span> <span class="fu">floor</span>(<span class="fu">length</span>(mean_data_1) <span class="sc">/</span> <span class="dv">6</span>))<span class="sc">$</span>cpts)</span>
<span id="cb76-165"><a href="#cb76-165" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(CptNonPar_result, <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">700</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-166"><a href="#cb76-166" tabindex="-1"></a>strucchange<span class="sc">::</span><span class="fu">breakpoints</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> mean_data_1))<span class="sc">$</span>breakpoints</span>
<span id="cb76-167"><a href="#cb76-167" tabindex="-1"></a><span class="co">#&gt; [1] 300 700</span></span>
<span id="cb76-168"><a href="#cb76-168" tabindex="-1"></a>ecp<span class="sc">::</span><span class="fu">e.divisive</span>(mean_data_1)<span class="sc">$</span>estimates</span>
<span id="cb76-169"><a href="#cb76-169" tabindex="-1"></a><span class="co">#&gt; [1]    1  301  701 1001</span></span>
<span id="cb76-170"><a href="#cb76-170" tabindex="-1"></a>(changepoint_result <span class="ot">&lt;-</span> changepoint<span class="sc">::</span><span class="fu">cpt.mean</span>(<span class="fu">c</span>(mean_data_1))<span class="sc">@</span>cpts)</span>
<span id="cb76-171"><a href="#cb76-171" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(changepoint_result, <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">1000</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-172"><a href="#cb76-172" tabindex="-1"></a>(breakfast_result <span class="ot">&lt;-</span> breakfast<span class="sc">::</span><span class="fu">breakfast</span>(mean_data_1)<span class="sc">$</span>cptmodel.list[[<span class="dv">6</span>]]<span class="sc">$</span>cpts)</span>
<span id="cb76-173"><a href="#cb76-173" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(breakfast_result, <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">700</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-174"><a href="#cb76-174" tabindex="-1"></a>(wbs_result <span class="ot">&lt;-</span> wbs<span class="sc">::</span><span class="fu">wbs</span>(mean_data_1)<span class="sc">$</span>cpt<span class="sc">$</span>cpt.ic<span class="sc">$</span>mbic.penalty)</span>
<span id="cb76-175"><a href="#cb76-175" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(wbs_result, <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">700</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-176"><a href="#cb76-176" tabindex="-1"></a>mosum<span class="sc">::</span><span class="fu">mosum</span>(<span class="fu">c</span>(mean_data_1), <span class="at">G =</span> <span class="dv">40</span>)<span class="sc">$</span>cpts.info<span class="sc">$</span>cpts</span>
<span id="cb76-177"><a href="#cb76-177" tabindex="-1"></a><span class="co">#&gt; [1] 300 700</span></span>
<span id="cb76-178"><a href="#cb76-178" tabindex="-1"></a>(fpop_result <span class="ot">&lt;-</span> fpop<span class="sc">::</span><span class="fu">Fpop</span>(mean_data_1, <span class="fu">nrow</span>(mean_data_1))<span class="sc">$</span>t.est)</span>
<span id="cb76-179"><a href="#cb76-179" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(fpop_result, <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">700</span>, <span class="dv">1000</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-180"><a href="#cb76-180" tabindex="-1"></a>gfpop<span class="sc">::</span><span class="fu">gfpop</span>(</span>
<span id="cb76-181"><a href="#cb76-181" tabindex="-1"></a>  <span class="at">data =</span> mean_data_1,</span>
<span id="cb76-182"><a href="#cb76-182" tabindex="-1"></a>  <span class="at">mygraph =</span> gfpop<span class="sc">::</span><span class="fu">graph</span>(</span>
<span id="cb76-183"><a href="#cb76-183" tabindex="-1"></a>    <span class="at">penalty =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">nrow</span>(mean_data_1)) <span class="sc">*</span> gfpop<span class="sc">::</span><span class="fu">sdDiff</span>(mean_data_1) <span class="sc">^</span> <span class="dv">2</span>,</span>
<span id="cb76-184"><a href="#cb76-184" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"updown"</span></span>
<span id="cb76-185"><a href="#cb76-185" tabindex="-1"></a>  ),</span>
<span id="cb76-186"><a href="#cb76-186" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"mean"</span></span>
<span id="cb76-187"><a href="#cb76-187" tabindex="-1"></a>)<span class="sc">$</span>changepoints</span>
<span id="cb76-188"><a href="#cb76-188" tabindex="-1"></a><span class="co">#&gt; [1]  300  700 1000</span></span>
<span id="cb76-189"><a href="#cb76-189" tabindex="-1"></a><span class="fu">invisible</span>(</span>
<span id="cb76-190"><a href="#cb76-190" tabindex="-1"></a>  <span class="fu">suppressMessages</span>(</span>
<span id="cb76-191"><a href="#cb76-191" tabindex="-1"></a>    <span class="fu">capture.output</span>(</span>
<span id="cb76-192"><a href="#cb76-192" tabindex="-1"></a>      result_InspectChangepoint <span class="ot">&lt;-</span> InspectChangepoint<span class="sc">::</span><span class="fu">inspect</span>(</span>
<span id="cb76-193"><a href="#cb76-193" tabindex="-1"></a>        <span class="fu">t</span>(mean_data_1),</span>
<span id="cb76-194"><a href="#cb76-194" tabindex="-1"></a>        <span class="at">threshold =</span> InspectChangepoint<span class="sc">::</span><span class="fu">compute.threshold</span>(</span>
<span id="cb76-195"><a href="#cb76-195" tabindex="-1"></a>          <span class="fu">nrow</span>(mean_data_1), <span class="fu">ncol</span>(mean_data_1)</span>
<span id="cb76-196"><a href="#cb76-196" tabindex="-1"></a>        )</span>
<span id="cb76-197"><a href="#cb76-197" tabindex="-1"></a>      )</span>
<span id="cb76-198"><a href="#cb76-198" tabindex="-1"></a>    )</span>
<span id="cb76-199"><a href="#cb76-199" tabindex="-1"></a>  )</span>
<span id="cb76-200"><a href="#cb76-200" tabindex="-1"></a>)</span>
<span id="cb76-201"><a href="#cb76-201" tabindex="-1"></a>result_InspectChangepoint<span class="sc">$</span>changepoints[, <span class="st">"location"</span>]</span>
<span id="cb76-202"><a href="#cb76-202" tabindex="-1"></a><span class="co">#&gt; [1] 300 700</span></span>
<span id="cb76-203"><a href="#cb76-203" tabindex="-1"></a>(jointseg_result <span class="ot">&lt;-</span> jointseg<span class="sc">::</span><span class="fu">jointSeg</span>(mean_data_1, <span class="at">K =</span> <span class="dv">2</span>)<span class="sc">$</span>bestBkp)</span>
<span id="cb76-204"><a href="#cb76-204" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(jointseg_result, <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">700</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-205"><a href="#cb76-205" tabindex="-1"></a>Rbeast<span class="sc">::</span><span class="fu">beast</span>(</span>
<span id="cb76-206"><a href="#cb76-206" tabindex="-1"></a>  mean_data_1, <span class="at">season =</span> <span class="st">"none"</span>, <span class="at">print.progress =</span> <span class="cn">FALSE</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span></span>
<span id="cb76-207"><a href="#cb76-207" tabindex="-1"></a>)<span class="sc">$</span>trend<span class="sc">$</span>cp</span>
<span id="cb76-208"><a href="#cb76-208" tabindex="-1"></a><span class="co">#&gt;  [1] 701 301 NaN NaN NaN NaN NaN NaN NaN NaN</span></span>
<span id="cb76-209"><a href="#cb76-209" tabindex="-1"></a>(stepR_result <span class="ot">&lt;-</span> stepR<span class="sc">::</span><span class="fu">stepFit</span>(mean_data_1, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">$</span>rightEnd)</span>
<span id="cb76-210"><a href="#cb76-210" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(stepR_result, <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">700</span>, <span class="dv">1000</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-211"><a href="#cb76-211" tabindex="-1"></a>(cpm_result <span class="ot">&lt;-</span> cpm<span class="sc">::</span><span class="fu">processStream</span>(mean_data_1, <span class="at">cpmType =</span> <span class="st">"Student"</span>)<span class="sc">$</span>changePoints)</span>
<span id="cb76-212"><a href="#cb76-212" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(cpm_result, <span class="fu">c</span>(<span class="dv">299</span>, <span class="dv">699</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-213"><a href="#cb76-213" tabindex="-1"></a>(segmented_result <span class="ot">&lt;-</span> segmented<span class="sc">::</span><span class="fu">stepmented</span>(</span>
<span id="cb76-214"><a href="#cb76-214" tabindex="-1"></a>  <span class="fu">as.numeric</span>(mean_data_1), <span class="at">npsi =</span> <span class="dv">2</span></span>
<span id="cb76-215"><a href="#cb76-215" tabindex="-1"></a>)<span class="sc">$</span>psi[, <span class="st">"Est."</span>])</span>
<span id="cb76-216"><a href="#cb76-216" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equivalent</span>(segmented_result, <span class="fu">c</span>(<span class="dv">298</span>, <span class="dv">699</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-217"><a href="#cb76-217" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb76-218"><a href="#cb76-218" tabindex="-1"></a>  mcp<span class="sc">::</span><span class="fu">mcp</span>(</span>
<span id="cb76-219"><a href="#cb76-219" tabindex="-1"></a>    <span class="fu">list</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb76-220"><a href="#cb76-220" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> mean_data_1, <span class="at">x =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(mean_data_1))),</span>
<span id="cb76-221"><a href="#cb76-221" tabindex="-1"></a>    <span class="at">par_x =</span> <span class="st">"x"</span></span>
<span id="cb76-222"><a href="#cb76-222" tabindex="-1"></a>  )</span>
<span id="cb76-223"><a href="#cb76-223" tabindex="-1"></a>)</span>
<span id="cb76-224"><a href="#cb76-224" tabindex="-1"></a><span class="fu">plot</span>(not<span class="sc">::</span><span class="fu">not</span>(mean_data_1, <span class="at">contrast =</span> <span class="st">"pcwsConstMean"</span>))</span>
<span id="cb76-225"><a href="#cb76-225" tabindex="-1"></a><span class="fu">plot</span>(bcp<span class="sc">::</span><span class="fu">bcp</span>(mean_data_1))</span>
<span id="cb76-226"><a href="#cb76-226" tabindex="-1"></a>(fastcpd_result <span class="ot">&lt;-</span> fastcpd<span class="sc">::</span><span class="fu">fastcpd.mv</span>(mv_data_1, <span class="at">r.progress =</span> <span class="cn">FALSE</span>)<span class="sc">@</span>cp_set)</span>
<span id="cb76-227"><a href="#cb76-227" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(fastcpd_result, <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">700</span>, <span class="dv">1001</span>, <span class="dv">1300</span>, <span class="dv">1700</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-228"><a href="#cb76-228" tabindex="-1"></a>ecp<span class="sc">::</span><span class="fu">e.divisive</span>(mv_data_1)<span class="sc">$</span>estimates</span>
<span id="cb76-229"><a href="#cb76-229" tabindex="-1"></a><span class="co">#&gt; [1]    1  301  701 1001 1301 1701 2001</span></span>
<span id="cb76-230"><a href="#cb76-230" tabindex="-1"></a>(changepoint_result <span class="ot">&lt;-</span> changepoint<span class="sc">::</span><span class="fu">cpt.meanvar</span>(<span class="fu">c</span>(mv_data_1))<span class="sc">@</span>cpts)</span>
<span id="cb76-231"><a href="#cb76-231" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(changepoint_result, <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">2000</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-232"><a href="#cb76-232" tabindex="-1"></a>(CptNonPar_result <span class="ot">&lt;-</span> CptNonPar<span class="sc">::</span><span class="fu">np.mojo</span>(mv_data_1, <span class="at">G =</span> <span class="fu">floor</span>(<span class="fu">length</span>(mv_data_1) <span class="sc">/</span> <span class="dv">6</span>))<span class="sc">$</span>cpts)</span>
<span id="cb76-233"><a href="#cb76-233" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(CptNonPar_result, <span class="fu">c</span>(<span class="dv">333</span>, <span class="dv">700</span>, <span class="dv">1300</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-234"><a href="#cb76-234" tabindex="-1"></a>(cpm_result <span class="ot">&lt;-</span> cpm<span class="sc">::</span><span class="fu">processStream</span>(mv_data_1, <span class="at">cpmType =</span> <span class="st">"GLR"</span>)<span class="sc">$</span>changePoints)</span>
<span id="cb76-235"><a href="#cb76-235" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(cpm_result, <span class="fu">c</span>(<span class="dv">293</span>, <span class="dv">300</span>, <span class="dv">403</span>, <span class="dv">408</span>, <span class="dv">618</span>, <span class="dv">621</span>, <span class="dv">696</span>, <span class="dv">1000</span>, <span class="dv">1021</span>, <span class="dv">1024</span>, <span class="dv">1293</span>, <span class="dv">1300</span>, <span class="dv">1417</span>, <span class="dv">1693</span>, <span class="dv">1700</span>, <span class="dv">1981</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-236"><a href="#cb76-236" tabindex="-1"></a><span class="fu">invisible</span>(</span>
<span id="cb76-237"><a href="#cb76-237" tabindex="-1"></a>  <span class="fu">suppressMessages</span>(</span>
<span id="cb76-238"><a href="#cb76-238" tabindex="-1"></a>    <span class="fu">capture.output</span>(</span>
<span id="cb76-239"><a href="#cb76-239" tabindex="-1"></a>      result_InspectChangepoint <span class="ot">&lt;-</span> InspectChangepoint<span class="sc">::</span><span class="fu">inspect</span>(</span>
<span id="cb76-240"><a href="#cb76-240" tabindex="-1"></a>        <span class="fu">t</span>(mv_data_1),</span>
<span id="cb76-241"><a href="#cb76-241" tabindex="-1"></a>        <span class="at">threshold =</span> InspectChangepoint<span class="sc">::</span><span class="fu">compute.threshold</span>(</span>
<span id="cb76-242"><a href="#cb76-242" tabindex="-1"></a>          <span class="fu">nrow</span>(mv_data_1), <span class="fu">ncol</span>(mv_data_1)</span>
<span id="cb76-243"><a href="#cb76-243" tabindex="-1"></a>        )</span>
<span id="cb76-244"><a href="#cb76-244" tabindex="-1"></a>      )</span>
<span id="cb76-245"><a href="#cb76-245" tabindex="-1"></a>    )</span>
<span id="cb76-246"><a href="#cb76-246" tabindex="-1"></a>  )</span>
<span id="cb76-247"><a href="#cb76-247" tabindex="-1"></a>)</span>
<span id="cb76-248"><a href="#cb76-248" tabindex="-1"></a>result_InspectChangepoint<span class="sc">$</span>changepoints[, <span class="st">"location"</span>]</span>
<span id="cb76-249"><a href="#cb76-249" tabindex="-1"></a><span class="co">#&gt;   [1]  300  700  701  702  704  707  708  712  715  716  717  718  721  722</span></span>
<span id="cb76-250"><a href="#cb76-250" tabindex="-1"></a><span class="co">#&gt;  [15]  723  726  727  729  731  732  734  736  740  742  744  746  748  750</span></span>
<span id="cb76-251"><a href="#cb76-251" tabindex="-1"></a><span class="co">#&gt;  [29]  753  755  756  757  759  760  762  764  765  768  769  771  772  774</span></span>
<span id="cb76-252"><a href="#cb76-252" tabindex="-1"></a><span class="co">#&gt;  [43]  776  777  784  785  786  789  791  792  794  797  798  799  801  802</span></span>
<span id="cb76-253"><a href="#cb76-253" tabindex="-1"></a><span class="co">#&gt;  [57]  803  807  809  810  813  815  817  819  826  827  828  829  831  833</span></span>
<span id="cb76-254"><a href="#cb76-254" tabindex="-1"></a><span class="co">#&gt;  [71]  835  836  837  838  840  841  842  843  845  848  849  852  854  860</span></span>
<span id="cb76-255"><a href="#cb76-255" tabindex="-1"></a><span class="co">#&gt;  [85]  862  864  866  868  870  872  875  879  881  884  886  887  888  889</span></span>
<span id="cb76-256"><a href="#cb76-256" tabindex="-1"></a><span class="co">#&gt;  [99]  896  897  898  899  901  903  904  905  906  909  912  913  915  917</span></span>
<span id="cb76-257"><a href="#cb76-257" tabindex="-1"></a><span class="co">#&gt; [113]  919  921  922  923  927  928  932  934  936  937  940  944  945  947</span></span>
<span id="cb76-258"><a href="#cb76-258" tabindex="-1"></a><span class="co">#&gt; [127]  948  949  951  956  958  959  961  962  963  964  966  967  968  972</span></span>
<span id="cb76-259"><a href="#cb76-259" tabindex="-1"></a><span class="co">#&gt; [141]  974  976  978  979  986  988  990  992  995 1000 1300 1700 1702 1703</span></span>
<span id="cb76-260"><a href="#cb76-260" tabindex="-1"></a><span class="co">#&gt; [155] 1704 1705 1708 1710 1712 1714 1716 1717 1718 1720 1721 1723 1725 1726</span></span>
<span id="cb76-261"><a href="#cb76-261" tabindex="-1"></a><span class="co">#&gt; [169] 1727 1729 1731 1733 1735 1736 1737 1739 1742 1745 1747 1748 1752 1754</span></span>
<span id="cb76-262"><a href="#cb76-262" tabindex="-1"></a><span class="co">#&gt; [183] 1756 1758 1759 1760 1766 1768 1770 1771 1773 1775 1778 1782 1784 1785</span></span>
<span id="cb76-263"><a href="#cb76-263" tabindex="-1"></a><span class="co">#&gt; [197] 1790 1792 1793 1795 1796 1797 1799 1800 1802 1803 1804 1805 1806 1807</span></span>
<span id="cb76-264"><a href="#cb76-264" tabindex="-1"></a><span class="co">#&gt; [211] 1808 1809 1821 1824 1825 1827 1828 1829 1833 1835 1837 1840 1841 1842</span></span>
<span id="cb76-265"><a href="#cb76-265" tabindex="-1"></a><span class="co">#&gt; [225] 1848 1849 1851 1852 1854 1855 1857 1859 1860 1862 1863 1865 1867 1868</span></span>
<span id="cb76-266"><a href="#cb76-266" tabindex="-1"></a><span class="co">#&gt; [239] 1876 1878 1879 1880 1882 1883 1884 1886 1887 1889 1894 1898 1899 1905</span></span>
<span id="cb76-267"><a href="#cb76-267" tabindex="-1"></a><span class="co">#&gt; [253] 1906 1907 1908 1909 1912 1919 1926 1927 1928 1930 1933 1934 1935 1936</span></span>
<span id="cb76-268"><a href="#cb76-268" tabindex="-1"></a><span class="co">#&gt; [267] 1938 1940 1944 1947 1950 1952 1954 1955 1956 1960 1962 1963 1965 1966</span></span>
<span id="cb76-269"><a href="#cb76-269" tabindex="-1"></a><span class="co">#&gt; [281] 1967 1969 1970 1974 1976 1977 1978 1980 1985 1987 1988 1990 1997 1998</span></span>
<span id="cb76-270"><a href="#cb76-270" tabindex="-1"></a>Rbeast<span class="sc">::</span><span class="fu">beast</span>(</span>
<span id="cb76-271"><a href="#cb76-271" tabindex="-1"></a>  mv_data_1, <span class="at">season =</span> <span class="st">"none"</span>, <span class="at">print.progress =</span> <span class="cn">FALSE</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span></span>
<span id="cb76-272"><a href="#cb76-272" tabindex="-1"></a>)<span class="sc">$</span>trend<span class="sc">$</span>cp</span>
<span id="cb76-273"><a href="#cb76-273" tabindex="-1"></a><span class="co">#&gt;  [1] 1794 1855 1986 1301  301  703 1981 1769 1860 1834</span></span>
<span id="cb76-274"><a href="#cb76-274" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb76-275"><a href="#cb76-275" tabindex="-1"></a>  mcp<span class="sc">::</span><span class="fu">mcp</span>(</span>
<span id="cb76-276"><a href="#cb76-276" tabindex="-1"></a>    <span class="fu">list</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>, <span class="sc">~</span> <span class="dv">1</span>),</span>
<span id="cb76-277"><a href="#cb76-277" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> mv_data_1, <span class="at">x =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(mv_data_1))),</span>
<span id="cb76-278"><a href="#cb76-278" tabindex="-1"></a>    <span class="at">par_x =</span> <span class="st">"x"</span></span>
<span id="cb76-279"><a href="#cb76-279" tabindex="-1"></a>  )</span>
<span id="cb76-280"><a href="#cb76-280" tabindex="-1"></a>)</span>
<span id="cb76-281"><a href="#cb76-281" tabindex="-1"></a><span class="fu">plot</span>(not<span class="sc">::</span><span class="fu">not</span>(mv_data_1, <span class="at">contrast =</span> <span class="st">"pcwsConstMeanVar"</span>))</span>
<span id="cb76-282"><a href="#cb76-282" tabindex="-1"></a>(fastcpd_result <span class="ot">&lt;-</span> fastcpd<span class="sc">::</span><span class="fu">fastcpd.mean</span>(mean_data_3, <span class="at">r.progress =</span> <span class="cn">FALSE</span>)<span class="sc">@</span>cp_set)</span>
<span id="cb76-283"><a href="#cb76-283" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(fastcpd_result, <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">700</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-284"><a href="#cb76-284" tabindex="-1"></a>(CptNonPar_result <span class="ot">&lt;-</span> CptNonPar<span class="sc">::</span><span class="fu">np.mojo</span>(mean_data_3, <span class="at">G =</span> <span class="fu">floor</span>(<span class="fu">nrow</span>(mean_data_3) <span class="sc">/</span> <span class="dv">6</span>))<span class="sc">$</span>cpts)</span>
<span id="cb76-285"><a href="#cb76-285" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(CptNonPar_result, <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">700</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-286"><a href="#cb76-286" tabindex="-1"></a><span class="fu">invisible</span>(</span>
<span id="cb76-287"><a href="#cb76-287" tabindex="-1"></a>  <span class="fu">suppressMessages</span>(</span>
<span id="cb76-288"><a href="#cb76-288" tabindex="-1"></a>    <span class="fu">capture.output</span>(</span>
<span id="cb76-289"><a href="#cb76-289" tabindex="-1"></a>      result_InspectChangepoint <span class="ot">&lt;-</span> InspectChangepoint<span class="sc">::</span><span class="fu">inspect</span>(</span>
<span id="cb76-290"><a href="#cb76-290" tabindex="-1"></a>        <span class="fu">t</span>(mean_data_3),</span>
<span id="cb76-291"><a href="#cb76-291" tabindex="-1"></a>        <span class="at">threshold =</span> InspectChangepoint<span class="sc">::</span><span class="fu">compute.threshold</span>(</span>
<span id="cb76-292"><a href="#cb76-292" tabindex="-1"></a>          <span class="fu">nrow</span>(mean_data_3), <span class="fu">ncol</span>(mean_data_3)</span>
<span id="cb76-293"><a href="#cb76-293" tabindex="-1"></a>        )</span>
<span id="cb76-294"><a href="#cb76-294" tabindex="-1"></a>      )</span>
<span id="cb76-295"><a href="#cb76-295" tabindex="-1"></a>    )</span>
<span id="cb76-296"><a href="#cb76-296" tabindex="-1"></a>  )</span>
<span id="cb76-297"><a href="#cb76-297" tabindex="-1"></a>)</span>
<span id="cb76-298"><a href="#cb76-298" tabindex="-1"></a>result_InspectChangepoint<span class="sc">$</span>changepoints[, <span class="st">"location"</span>]</span>
<span id="cb76-299"><a href="#cb76-299" tabindex="-1"></a><span class="co">#&gt; [1] 300 700</span></span>
<span id="cb76-300"><a href="#cb76-300" tabindex="-1"></a>(jointseg_result <span class="ot">&lt;-</span> jointseg<span class="sc">::</span><span class="fu">jointSeg</span>(mean_data_3, <span class="at">K =</span> <span class="dv">2</span>)<span class="sc">$</span>bestBkp)</span>
<span id="cb76-301"><a href="#cb76-301" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(jointseg_result, <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">700</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-302"><a href="#cb76-302" tabindex="-1"></a><span class="fu">invisible</span>(</span>
<span id="cb76-303"><a href="#cb76-303" tabindex="-1"></a>  <span class="fu">capture.output</span>(</span>
<span id="cb76-304"><a href="#cb76-304" tabindex="-1"></a>    result_Rbeast <span class="ot">&lt;-</span> Rbeast<span class="sc">::</span><span class="fu">beast123</span>(</span>
<span id="cb76-305"><a href="#cb76-305" tabindex="-1"></a>      mean_data_3,</span>
<span id="cb76-306"><a href="#cb76-306" tabindex="-1"></a>      <span class="at">metadata =</span> <span class="fu">list</span>(<span class="at">whichDimIsTime =</span> <span class="dv">1</span>),</span>
<span id="cb76-307"><a href="#cb76-307" tabindex="-1"></a>      <span class="at">season =</span> <span class="st">"none"</span></span>
<span id="cb76-308"><a href="#cb76-308" tabindex="-1"></a>    )</span>
<span id="cb76-309"><a href="#cb76-309" tabindex="-1"></a>  )</span>
<span id="cb76-310"><a href="#cb76-310" tabindex="-1"></a>)</span>
<span id="cb76-311"><a href="#cb76-311" tabindex="-1"></a>result_Rbeast<span class="sc">$</span>trend<span class="sc">$</span>cp</span>
<span id="cb76-312"><a href="#cb76-312" tabindex="-1"></a><span class="co">#&gt; Warning message:</span></span>
<span id="cb76-313"><a href="#cb76-313" tabindex="-1"></a><span class="co">#&gt; In Rbeast::beast123(mean_data_3, metadata = list(whichDimIsTime = 1),  :</span></span>
<span id="cb76-314"><a href="#cb76-314" tabindex="-1"></a><span class="co">#&gt;   </span><span class="al">WARNING</span><span class="co">: If the input data is regular and ordered in time,the times of individual datapoints are determined fully by 'metadata$startTime' and 'metadata$deltaTime'. But startTime and deltaTime are missing and a default value 1 is used for both!</span></span>
<span id="cb76-315"><a href="#cb76-315" tabindex="-1"></a><span class="co">#&gt;       [,1] [,2] [,3]</span></span>
<span id="cb76-316"><a href="#cb76-316" tabindex="-1"></a><span class="co">#&gt;  [1,]  301  301  701</span></span>
<span id="cb76-317"><a href="#cb76-317" tabindex="-1"></a><span class="co">#&gt;  [2,]  701  701  301</span></span>
<span id="cb76-318"><a href="#cb76-318" tabindex="-1"></a><span class="co">#&gt;  [3,]  NaN  225  NaN</span></span>
<span id="cb76-319"><a href="#cb76-319" tabindex="-1"></a><span class="co">#&gt;  [4,]  NaN  684  NaN</span></span>
<span id="cb76-320"><a href="#cb76-320" tabindex="-1"></a><span class="co">#&gt;  [5,]  NaN  NaN  NaN</span></span>
<span id="cb76-321"><a href="#cb76-321" tabindex="-1"></a><span class="co">#&gt;  [6,]  NaN  NaN  NaN</span></span>
<span id="cb76-322"><a href="#cb76-322" tabindex="-1"></a><span class="co">#&gt;  [7,]  NaN  NaN  NaN</span></span>
<span id="cb76-323"><a href="#cb76-323" tabindex="-1"></a><span class="co">#&gt;  [8,]  NaN  NaN  NaN</span></span>
<span id="cb76-324"><a href="#cb76-324" tabindex="-1"></a><span class="co">#&gt;  [9,]  NaN  NaN  NaN</span></span>
<span id="cb76-325"><a href="#cb76-325" tabindex="-1"></a><span class="co">#&gt; [10,]  NaN  NaN  NaN</span></span>
<span id="cb76-326"><a href="#cb76-326" tabindex="-1"></a>strucchange<span class="sc">::</span><span class="fu">breakpoints</span>(</span>
<span id="cb76-327"><a href="#cb76-327" tabindex="-1"></a>  <span class="fu">cbind</span>(y<span class="fl">.1</span>, y<span class="fl">.2</span>, y<span class="fl">.3</span>) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> mean_data_3)</span>
<span id="cb76-328"><a href="#cb76-328" tabindex="-1"></a>)<span class="sc">$</span>breakpoints</span>
<span id="cb76-329"><a href="#cb76-329" tabindex="-1"></a><span class="co">#&gt; [1] 300 700</span></span>
<span id="cb76-330"><a href="#cb76-330" tabindex="-1"></a>ecp<span class="sc">::</span><span class="fu">e.divisive</span>(mean_data_3)<span class="sc">$</span>estimates</span>
<span id="cb76-331"><a href="#cb76-331" tabindex="-1"></a><span class="co">#&gt; [1]    1  301  701 1001</span></span>
<span id="cb76-332"><a href="#cb76-332" tabindex="-1"></a><span class="fu">plot</span>(bcp<span class="sc">::</span><span class="fu">bcp</span>(mean_data_3))</span>
<span id="cb76-333"><a href="#cb76-333" tabindex="-1"></a>(fastcpd_result <span class="ot">&lt;-</span> fastcpd<span class="sc">::</span><span class="fu">fastcpd.mv</span>(mv_data_3, <span class="at">r.progress =</span> <span class="cn">FALSE</span>)<span class="sc">@</span>cp_set)</span>
<span id="cb76-334"><a href="#cb76-334" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(fastcpd_result, <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">700</span>, <span class="dv">1000</span>, <span class="dv">1300</span>, <span class="dv">1700</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-335"><a href="#cb76-335" tabindex="-1"></a>ecp<span class="sc">::</span><span class="fu">e.divisive</span>(mv_data_3)<span class="sc">$</span>estimates</span>
<span id="cb76-336"><a href="#cb76-336" tabindex="-1"></a><span class="co">#&gt; [1]    1  301  701 1001 1301 1701 2001</span></span>
<span id="cb76-337"><a href="#cb76-337" tabindex="-1"></a><span class="fu">invisible</span>(</span>
<span id="cb76-338"><a href="#cb76-338" tabindex="-1"></a>  <span class="fu">suppressMessages</span>(</span>
<span id="cb76-339"><a href="#cb76-339" tabindex="-1"></a>    <span class="fu">capture.output</span>(</span>
<span id="cb76-340"><a href="#cb76-340" tabindex="-1"></a>      result_InspectChangepoint <span class="ot">&lt;-</span> InspectChangepoint<span class="sc">::</span><span class="fu">inspect</span>(</span>
<span id="cb76-341"><a href="#cb76-341" tabindex="-1"></a>        <span class="fu">t</span>(mv_data_3),</span>
<span id="cb76-342"><a href="#cb76-342" tabindex="-1"></a>        <span class="at">threshold =</span> InspectChangepoint<span class="sc">::</span><span class="fu">compute.threshold</span>(</span>
<span id="cb76-343"><a href="#cb76-343" tabindex="-1"></a>          <span class="fu">nrow</span>(mv_data_3), <span class="fu">ncol</span>(mv_data_3)</span>
<span id="cb76-344"><a href="#cb76-344" tabindex="-1"></a>        )</span>
<span id="cb76-345"><a href="#cb76-345" tabindex="-1"></a>      )</span>
<span id="cb76-346"><a href="#cb76-346" tabindex="-1"></a>    )</span>
<span id="cb76-347"><a href="#cb76-347" tabindex="-1"></a>  )</span>
<span id="cb76-348"><a href="#cb76-348" tabindex="-1"></a>)</span>
<span id="cb76-349"><a href="#cb76-349" tabindex="-1"></a>result_InspectChangepoint<span class="sc">$</span>changepoints[, <span class="st">"location"</span>]</span>
<span id="cb76-350"><a href="#cb76-350" tabindex="-1"></a><span class="co">#&gt;   [1]  300  700  701  703  705  707  708  709  711  712  714  715  717  718</span></span>
<span id="cb76-351"><a href="#cb76-351" tabindex="-1"></a><span class="co">#&gt;  [15]  720  721  723  724  726  727  729  731  733  734  736  737  739  740</span></span>
<span id="cb76-352"><a href="#cb76-352" tabindex="-1"></a><span class="co">#&gt;  [29]  742  743  744  746  747  749  750  752  753  754  755  756  758  760</span></span>
<span id="cb76-353"><a href="#cb76-353" tabindex="-1"></a><span class="co">#&gt;  [43]  762  763  765  766  767  769  770  772  773  774  775  777  779  780</span></span>
<span id="cb76-354"><a href="#cb76-354" tabindex="-1"></a><span class="co">#&gt;  [57]  782  784  786  788  790  791  793  795  797  799  801  803  804  806</span></span>
<span id="cb76-355"><a href="#cb76-355" tabindex="-1"></a><span class="co">#&gt;  [71]  808  809  810  811  813  814  816  817  818  820  821  823  825  827</span></span>
<span id="cb76-356"><a href="#cb76-356" tabindex="-1"></a><span class="co">#&gt;  [85]  828  830  831  833  835  836  837  838  840  842  843  845  846  848</span></span>
<span id="cb76-357"><a href="#cb76-357" tabindex="-1"></a><span class="co">#&gt;  [99]  849  850  852  853  854  855  856  858  859  860  862  863  865  866</span></span>
<span id="cb76-358"><a href="#cb76-358" tabindex="-1"></a><span class="co">#&gt; [113]  868  869  871  872  874  876  877  878  879  881  883  885  887  888</span></span>
<span id="cb76-359"><a href="#cb76-359" tabindex="-1"></a><span class="co">#&gt; [127]  889  891  893  894  895  897  898  900  901  903  904  906  908  909</span></span>
<span id="cb76-360"><a href="#cb76-360" tabindex="-1"></a><span class="co">#&gt; [141]  911  913  914  916  917  918  920  921  923  924  925  927  928  929</span></span>
<span id="cb76-361"><a href="#cb76-361" tabindex="-1"></a><span class="co">#&gt; [155]  931  932  934  936  937  938  939  941  942  943  945  946  947  949</span></span>
<span id="cb76-362"><a href="#cb76-362" tabindex="-1"></a><span class="co">#&gt; [169]  950  952  954  955  956  957  958  959  961  962  964  965  967  968</span></span>
<span id="cb76-363"><a href="#cb76-363" tabindex="-1"></a><span class="co">#&gt; [183]  970  972  973  974  975  977  979  981  982  984  985  986  987  988</span></span>
<span id="cb76-364"><a href="#cb76-364" tabindex="-1"></a><span class="co">#&gt; [197]  990  991  992  994  995  997  999 1000 1300 1700 1702 1703 1704 1705</span></span>
<span id="cb76-365"><a href="#cb76-365" tabindex="-1"></a><span class="co">#&gt; [211] 1706 1708 1709 1710 1712 1713 1714 1715 1717 1719 1721 1722 1723 1725</span></span>
<span id="cb76-366"><a href="#cb76-366" tabindex="-1"></a><span class="co">#&gt; [225] 1727 1729 1730 1732 1734 1735 1737 1738 1739 1741 1742 1744 1746 1748</span></span>
<span id="cb76-367"><a href="#cb76-367" tabindex="-1"></a><span class="co">#&gt; [239] 1750 1752 1753 1754 1755 1757 1758 1759 1761 1762 1763 1764 1766 1767</span></span>
<span id="cb76-368"><a href="#cb76-368" tabindex="-1"></a><span class="co">#&gt; [253] 1769 1770 1771 1773 1774 1775 1777 1779 1781 1782 1783 1785 1786 1788</span></span>
<span id="cb76-369"><a href="#cb76-369" tabindex="-1"></a><span class="co">#&gt; [267] 1789 1791 1793 1794 1796 1798 1800 1803 1804 1805 1806 1808 1809 1811</span></span>
<span id="cb76-370"><a href="#cb76-370" tabindex="-1"></a><span class="co">#&gt; [281] 1812 1814 1815 1817 1818 1819 1821 1822 1824 1825 1827 1828 1829 1831</span></span>
<span id="cb76-371"><a href="#cb76-371" tabindex="-1"></a><span class="co">#&gt; [295] 1833 1835 1836 1838 1839 1841 1843 1844 1846 1847 1848 1850 1851 1853</span></span>
<span id="cb76-372"><a href="#cb76-372" tabindex="-1"></a><span class="co">#&gt; [309] 1854 1856 1857 1858 1859 1860 1862 1863 1864 1865 1867 1869 1870 1872</span></span>
<span id="cb76-373"><a href="#cb76-373" tabindex="-1"></a><span class="co">#&gt; [323] 1873 1874 1876 1878 1879 1881 1882 1884 1885 1887 1889 1891 1893 1894</span></span>
<span id="cb76-374"><a href="#cb76-374" tabindex="-1"></a><span class="co">#&gt; [337] 1896 1898 1899 1900 1901 1902 1904 1906 1907 1909 1911 1913 1914 1916</span></span>
<span id="cb76-375"><a href="#cb76-375" tabindex="-1"></a><span class="co">#&gt; [351] 1917 1918 1919 1921 1923 1924 1925 1927 1928 1930 1932 1933 1935 1936</span></span>
<span id="cb76-376"><a href="#cb76-376" tabindex="-1"></a><span class="co">#&gt; [365] 1938 1939 1941 1942 1944 1946 1948 1950 1951 1952 1954 1956 1957 1959</span></span>
<span id="cb76-377"><a href="#cb76-377" tabindex="-1"></a><span class="co">#&gt; [379] 1961 1963 1965 1967 1968 1970 1972 1973 1974 1976 1977 1979 1981 1982</span></span>
<span id="cb76-378"><a href="#cb76-378" tabindex="-1"></a><span class="co">#&gt; [393] 1984 1985 1987 1989 1990 1992 1993 1995 1996 1998</span></span>
<span id="cb76-379"><a href="#cb76-379" tabindex="-1"></a><span class="fu">invisible</span>(</span>
<span id="cb76-380"><a href="#cb76-380" tabindex="-1"></a>  <span class="fu">capture.output</span>(</span>
<span id="cb76-381"><a href="#cb76-381" tabindex="-1"></a>    result_Rbeast <span class="ot">&lt;-</span> Rbeast<span class="sc">::</span><span class="fu">beast123</span>(</span>
<span id="cb76-382"><a href="#cb76-382" tabindex="-1"></a>      mv_data_3,</span>
<span id="cb76-383"><a href="#cb76-383" tabindex="-1"></a>      <span class="at">metadata =</span> <span class="fu">list</span>(<span class="at">whichDimIsTime =</span> <span class="dv">1</span>),</span>
<span id="cb76-384"><a href="#cb76-384" tabindex="-1"></a>      <span class="at">season =</span> <span class="st">"none"</span></span>
<span id="cb76-385"><a href="#cb76-385" tabindex="-1"></a>    )</span>
<span id="cb76-386"><a href="#cb76-386" tabindex="-1"></a>  )</span>
<span id="cb76-387"><a href="#cb76-387" tabindex="-1"></a>)</span>
<span id="cb76-388"><a href="#cb76-388" tabindex="-1"></a>result_Rbeast<span class="sc">$</span>trend<span class="sc">$</span>cp</span>
<span id="cb76-389"><a href="#cb76-389" tabindex="-1"></a><span class="co">#&gt; Warning message:</span></span>
<span id="cb76-390"><a href="#cb76-390" tabindex="-1"></a><span class="co">#&gt; In Rbeast::beast123(mv_data_3, metadata = list(whichDimIsTime = 1),  :</span></span>
<span id="cb76-391"><a href="#cb76-391" tabindex="-1"></a><span class="co">#&gt;   </span><span class="al">WARNING</span><span class="co">: If the input data is regular and ordered in time,the times of individual datapoints are determined fully by 'metadata$startTime' and 'metadata$deltaTime'. But startTime and deltaTime are missing and a default value 1 is used for both!</span></span>
<span id="cb76-392"><a href="#cb76-392" tabindex="-1"></a><span class="co">#&gt;       [,1] [,2] [,3] [,4]</span></span>
<span id="cb76-393"><a href="#cb76-393" tabindex="-1"></a><span class="co">#&gt;  [1,]  701  301  301  710</span></span>
<span id="cb76-394"><a href="#cb76-394" tabindex="-1"></a><span class="co">#&gt;  [2,] 1301 1301 1301  301</span></span>
<span id="cb76-395"><a href="#cb76-395" tabindex="-1"></a><span class="co">#&gt;  [3,]  301  701  702 1301</span></span>
<span id="cb76-396"><a href="#cb76-396" tabindex="-1"></a><span class="co">#&gt;  [4,]  814 1993 1829 1986</span></span>
<span id="cb76-397"><a href="#cb76-397" tabindex="-1"></a><span class="co">#&gt;  [5,] 1968  767 1822  785</span></span>
<span id="cb76-398"><a href="#cb76-398" tabindex="-1"></a><span class="co">#&gt;  [6,] 1994  781  810  774</span></span>
<span id="cb76-399"><a href="#cb76-399" tabindex="-1"></a><span class="co">#&gt;  [7,]  761  884  845 1912</span></span>
<span id="cb76-400"><a href="#cb76-400" tabindex="-1"></a><span class="co">#&gt;  [8,] 1873  755  798  792</span></span>
<span id="cb76-401"><a href="#cb76-401" tabindex="-1"></a><span class="co">#&gt;  [9,] 1865  747  771  879</span></span>
<span id="cb76-402"><a href="#cb76-402" tabindex="-1"></a><span class="co">#&gt; [10,] 1962  924 1700 1919</span></span>
<span id="cb76-403"><a href="#cb76-403" tabindex="-1"></a>(fastcpd_result <span class="ot">&lt;-</span> fastcpd<span class="sc">::</span><span class="fu">fastcpd.lm</span>(lm_data, <span class="at">r.progress =</span> <span class="cn">FALSE</span>)<span class="sc">@</span>cp_set)</span>
<span id="cb76-404"><a href="#cb76-404" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(fastcpd_result, <span class="fu">c</span>(<span class="dv">97</span>, <span class="dv">201</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-405"><a href="#cb76-405" tabindex="-1"></a>strucchange<span class="sc">::</span><span class="fu">breakpoints</span>(y <span class="sc">~</span> . <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> lm_data)<span class="sc">$</span>breakpoints</span>
<span id="cb76-406"><a href="#cb76-406" tabindex="-1"></a><span class="co">#&gt; [1] 100 201</span></span>
<span id="cb76-407"><a href="#cb76-407" tabindex="-1"></a>(segmented_result <span class="ot">&lt;-</span> segmented<span class="sc">::</span><span class="fu">segmented</span>(</span>
<span id="cb76-408"><a href="#cb76-408" tabindex="-1"></a>  <span class="fu">lm</span>(</span>
<span id="cb76-409"><a href="#cb76-409" tabindex="-1"></a>    y <span class="sc">~</span> . <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb76-410"><a href="#cb76-410" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="at">y =</span> lm_data<span class="sc">$</span>y, <span class="at">x =</span> lm_data[, <span class="sc">-</span><span class="dv">1</span>], <span class="at">index =</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(lm_data)))</span>
<span id="cb76-411"><a href="#cb76-411" tabindex="-1"></a>  ),</span>
<span id="cb76-412"><a href="#cb76-412" tabindex="-1"></a>  <span class="at">seg.Z =</span> <span class="sc">~</span> index</span>
<span id="cb76-413"><a href="#cb76-413" tabindex="-1"></a>)<span class="sc">$</span>psi[, <span class="st">"Est."</span>])</span>
<span id="cb76-414"><a href="#cb76-414" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equivalent</span>(segmented_result, <span class="fu">c</span>(<span class="dv">233</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-415"><a href="#cb76-415" tabindex="-1"></a>(fastcpd_result <span class="ot">&lt;-</span> fastcpd<span class="sc">::</span><span class="fu">fastcpd.binomial</span>(binomial_data, <span class="at">r.progress =</span> <span class="cn">FALSE</span>)<span class="sc">@</span>cp_set)</span>
<span id="cb76-416"><a href="#cb76-416" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(fastcpd_result, <span class="dv">302</span>, <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-417"><a href="#cb76-417" tabindex="-1"></a>strucchange<span class="sc">::</span><span class="fu">breakpoints</span>(y <span class="sc">~</span> . <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> binomial_data)<span class="sc">$</span>breakpoints</span>
<span id="cb76-418"><a href="#cb76-418" tabindex="-1"></a><span class="co">#&gt; [1] 297</span></span>
<span id="cb76-419"><a href="#cb76-419" tabindex="-1"></a>(fastcpd_result <span class="ot">&lt;-</span> fastcpd<span class="sc">::</span><span class="fu">fastcpd.poisson</span>(poisson_data, <span class="at">r.progress =</span> <span class="cn">FALSE</span>)<span class="sc">@</span>cp_set)</span>
<span id="cb76-420"><a href="#cb76-420" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(fastcpd_result, <span class="fu">c</span>(<span class="dv">498</span>, <span class="dv">805</span>, <span class="dv">1003</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-421"><a href="#cb76-421" tabindex="-1"></a>strucchange<span class="sc">::</span><span class="fu">breakpoints</span>(y <span class="sc">~</span> . <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> poisson_data)<span class="sc">$</span>breakpoints</span>
<span id="cb76-422"><a href="#cb76-422" tabindex="-1"></a><span class="co">#&gt; [1] 935</span></span>
<span id="cb76-423"><a href="#cb76-423" tabindex="-1"></a>(fastcpd_result <span class="ot">&lt;-</span> fastcpd<span class="sc">::</span><span class="fu">fastcpd.lasso</span>(lasso_data, <span class="at">r.progress =</span> <span class="cn">FALSE</span>)<span class="sc">@</span>cp_set)</span>
<span id="cb76-424"><a href="#cb76-424" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_true</span>(<span class="fu">sum</span>(fastcpd_result <span class="sc">-</span> <span class="fu">c</span>(<span class="dv">79</span>, <span class="dv">199</span>, <span class="dv">320</span>)) <span class="sc">&lt;=</span> <span class="dv">1</span>)</span>
<span id="cb76-425"><a href="#cb76-425" tabindex="-1"></a>strucchange<span class="sc">::</span><span class="fu">breakpoints</span>(y <span class="sc">~</span> . <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> lasso_data)<span class="sc">$</span>breakpoints,</span>
<span id="cb76-426"><a href="#cb76-426" tabindex="-1"></a><span class="co">#&gt; [1]  80 200 321</span></span>
<span id="cb76-427"><a href="#cb76-427" tabindex="-1"></a>(fastcpd_result <span class="ot">&lt;-</span> fastcpd<span class="sc">::</span><span class="fu">fastcpd.ar</span>(ar_data, <span class="dv">3</span>, <span class="at">r.progress =</span> <span class="cn">FALSE</span>)<span class="sc">@</span>cp_set)</span>
<span id="cb76-428"><a href="#cb76-428" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(fastcpd_result, <span class="fu">c</span>(<span class="dv">614</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-429"><a href="#cb76-429" tabindex="-1"></a>(CptNonPar_result <span class="ot">&lt;-</span> CptNonPar<span class="sc">::</span><span class="fu">np.mojo</span>(ar_data, <span class="at">G =</span> <span class="fu">floor</span>(<span class="fu">length</span>(ar_data) <span class="sc">/</span> <span class="dv">6</span>))<span class="sc">$</span>cpts)</span>
<span id="cb76-430"><a href="#cb76-430" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(CptNonPar_result, <span class="fu">numeric</span>(<span class="dv">0</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-431"><a href="#cb76-431" tabindex="-1"></a>(segmented_result <span class="ot">&lt;-</span> segmented<span class="sc">::</span><span class="fu">segmented</span>(</span>
<span id="cb76-432"><a href="#cb76-432" tabindex="-1"></a>  <span class="fu">lm</span>(</span>
<span id="cb76-433"><a href="#cb76-433" tabindex="-1"></a>    y <span class="sc">~</span> x <span class="sc">+</span> <span class="dv">1</span>, <span class="fu">data.frame</span>(<span class="at">y =</span> ar_data, <span class="at">x =</span> <span class="fu">seq_along</span>(ar_data))</span>
<span id="cb76-434"><a href="#cb76-434" tabindex="-1"></a>  ),</span>
<span id="cb76-435"><a href="#cb76-435" tabindex="-1"></a>  <span class="at">seg.Z =</span> <span class="sc">~</span> x</span>
<span id="cb76-436"><a href="#cb76-436" tabindex="-1"></a>)<span class="sc">$</span>psi[, <span class="st">"Est."</span>])</span>
<span id="cb76-437"><a href="#cb76-437" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equivalent</span>(segmented_result, <span class="fu">c</span>(<span class="dv">690</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-438"><a href="#cb76-438" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb76-439"><a href="#cb76-439" tabindex="-1"></a>  mcp<span class="sc">::</span><span class="fu">mcp</span>(</span>
<span id="cb76-440"><a href="#cb76-440" tabindex="-1"></a>    <span class="fu">list</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">ar</span>(<span class="dv">3</span>), <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> <span class="fu">ar</span>(<span class="dv">3</span>)),</span>
<span id="cb76-441"><a href="#cb76-441" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> ar_data, <span class="at">x =</span> <span class="fu">seq_along</span>(ar_data)),</span>
<span id="cb76-442"><a href="#cb76-442" tabindex="-1"></a>    <span class="at">par_x =</span> <span class="st">"x"</span></span>
<span id="cb76-443"><a href="#cb76-443" tabindex="-1"></a>  )</span>
<span id="cb76-444"><a href="#cb76-444" tabindex="-1"></a>)</span>
<span id="cb76-445"><a href="#cb76-445" tabindex="-1"></a>(fastcpd_result <span class="ot">&lt;-</span> fastcpd<span class="sc">::</span><span class="fu">fastcpd.garch</span>(garch_data, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">r.progress =</span> <span class="cn">FALSE</span>)<span class="sc">@</span>cp_set)</span>
<span id="cb76-446"><a href="#cb76-446" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(fastcpd_result, <span class="fu">c</span>(<span class="dv">205</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-447"><a href="#cb76-447" tabindex="-1"></a>(CptNonPar_result <span class="ot">&lt;-</span> CptNonPar<span class="sc">::</span><span class="fu">np.mojo</span>(garch_data, <span class="at">G =</span> <span class="fu">floor</span>(<span class="fu">length</span>(garch_data) <span class="sc">/</span> <span class="dv">6</span>))<span class="sc">$</span>cpts)</span>
<span id="cb76-448"><a href="#cb76-448" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(CptNonPar_result, <span class="fu">c</span>(<span class="dv">206</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-449"><a href="#cb76-449" tabindex="-1"></a>strucchange<span class="sc">::</span><span class="fu">breakpoints</span>(x <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> garch_data))<span class="sc">$</span>breakpoints</span>
<span id="cb76-450"><a href="#cb76-450" tabindex="-1"></a><span class="co">#&gt; [1] NA</span></span>
<span id="cb76-451"><a href="#cb76-451" tabindex="-1"></a>(fastcpd_result <span class="ot">&lt;-</span> fastcpd<span class="sc">::</span><span class="fu">fastcpd.var</span>(</span>
<span id="cb76-452"><a href="#cb76-452" tabindex="-1"></a>  var_data, <span class="dv">2</span>, <span class="at">cost_adjustment =</span> <span class="cn">NULL</span>, <span class="at">r.progress =</span> <span class="cn">FALSE</span></span>
<span id="cb76-453"><a href="#cb76-453" tabindex="-1"></a>)<span class="sc">@</span>cp_set)</span>
<span id="cb76-454"><a href="#cb76-454" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(fastcpd_result, <span class="fu">c</span>(<span class="dv">500</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-455"><a href="#cb76-455" tabindex="-1"></a>(VARDetect_result <span class="ot">&lt;-</span> VARDetect<span class="sc">::</span><span class="fu">tbss</span>(var_data)<span class="sc">$</span>cp)</span>
<span id="cb76-456"><a href="#cb76-456" tabindex="-1"></a>testthat<span class="sc">::</span><span class="fu">expect_equal</span>(VARDetect_result, <span class="fu">c</span>(<span class="dv">501</span>), <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb76-457"><a href="#cb76-457" tabindex="-1"></a>well_log <span class="ot">&lt;-</span> well_log[well_log <span class="sc">&gt;</span> <span class="fl">1e5</span>]</span>
<span id="cb76-458"><a href="#cb76-458" tabindex="-1"></a></span>
<span id="cb76-459"><a href="#cb76-459" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb76-460"><a href="#cb76-460" tabindex="-1"></a>  <span class="at">fastcpd =</span> <span class="fu">fastcpd.mean</span>(well_log, <span class="at">trim =</span> <span class="fl">0.003</span>)<span class="sc">@</span>cp_set,</span>
<span id="cb76-461"><a href="#cb76-461" tabindex="-1"></a>  <span class="at">changepoint =</span> changepoint<span class="sc">::</span><span class="fu">cpt.mean</span>(well_log)<span class="sc">@</span>cpts,</span>
<span id="cb76-462"><a href="#cb76-462" tabindex="-1"></a>  <span class="at">CptNonPar =</span></span>
<span id="cb76-463"><a href="#cb76-463" tabindex="-1"></a>    CptNonPar<span class="sc">::</span><span class="fu">np.mojo</span>(well_log, <span class="at">G =</span> <span class="fu">floor</span>(<span class="fu">length</span>(well_log) <span class="sc">/</span> <span class="dv">6</span>))<span class="sc">$</span>cpts,</span>
<span id="cb76-464"><a href="#cb76-464" tabindex="-1"></a>  <span class="at">strucchange =</span> strucchange<span class="sc">::</span><span class="fu">breakpoints</span>(</span>
<span id="cb76-465"><a href="#cb76-465" tabindex="-1"></a>    y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> well_log)</span>
<span id="cb76-466"><a href="#cb76-466" tabindex="-1"></a>  )<span class="sc">$</span>breakpoints,</span>
<span id="cb76-467"><a href="#cb76-467" tabindex="-1"></a>  <span class="at">ecp =</span> ecp<span class="sc">::</span><span class="fu">e.divisive</span>(<span class="fu">matrix</span>(well_log))<span class="sc">$</span>estimates,</span>
<span id="cb76-468"><a href="#cb76-468" tabindex="-1"></a>  <span class="at">breakfast =</span> breakfast<span class="sc">::</span><span class="fu">breakfast</span>(well_log)<span class="sc">$</span>cptmodel.list[[<span class="dv">6</span>]]<span class="sc">$</span>cpts,</span>
<span id="cb76-469"><a href="#cb76-469" tabindex="-1"></a>  <span class="at">wbs =</span> wbs<span class="sc">::</span><span class="fu">wbs</span>(well_log)<span class="sc">$</span>cpt<span class="sc">$</span>cpt.ic<span class="sc">$</span>mbic.penalty,</span>
<span id="cb76-470"><a href="#cb76-470" tabindex="-1"></a>  <span class="at">mosum =</span> mosum<span class="sc">::</span><span class="fu">mosum</span>(<span class="fu">c</span>(well_log), <span class="at">G =</span> <span class="dv">40</span>)<span class="sc">$</span>cpts.info<span class="sc">$</span>cpts,</span>
<span id="cb76-471"><a href="#cb76-471" tabindex="-1"></a>  <span class="co"># fpop = fpop::Fpop(well_log, length(well_log))$t.est,  # meaningless</span></span>
<span id="cb76-472"><a href="#cb76-472" tabindex="-1"></a>  <span class="at">gfpop =</span> gfpop<span class="sc">::</span><span class="fu">gfpop</span>(</span>
<span id="cb76-473"><a href="#cb76-473" tabindex="-1"></a>    <span class="at">data =</span> well_log,</span>
<span id="cb76-474"><a href="#cb76-474" tabindex="-1"></a>    <span class="at">mygraph =</span> gfpop<span class="sc">::</span><span class="fu">graph</span>(</span>
<span id="cb76-475"><a href="#cb76-475" tabindex="-1"></a>      <span class="at">penalty =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">length</span>(well_log)) <span class="sc">*</span> gfpop<span class="sc">::</span><span class="fu">sdDiff</span>(well_log) <span class="sc">^</span> <span class="dv">2</span>,</span>
<span id="cb76-476"><a href="#cb76-476" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">"updown"</span></span>
<span id="cb76-477"><a href="#cb76-477" tabindex="-1"></a>    ),</span>
<span id="cb76-478"><a href="#cb76-478" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"mean"</span></span>
<span id="cb76-479"><a href="#cb76-479" tabindex="-1"></a>  )<span class="sc">$</span>changepoints,</span>
<span id="cb76-480"><a href="#cb76-480" tabindex="-1"></a>  <span class="at">InspectChangepoint =</span> InspectChangepoint<span class="sc">::</span><span class="fu">inspect</span>(</span>
<span id="cb76-481"><a href="#cb76-481" tabindex="-1"></a>    well_log,</span>
<span id="cb76-482"><a href="#cb76-482" tabindex="-1"></a>    <span class="at">threshold =</span> InspectChangepoint<span class="sc">::</span><span class="fu">compute.threshold</span>(<span class="fu">length</span>(well_log), <span class="dv">1</span>)</span>
<span id="cb76-483"><a href="#cb76-483" tabindex="-1"></a>  )<span class="sc">$</span>changepoints[, <span class="st">"location"</span>],</span>
<span id="cb76-484"><a href="#cb76-484" tabindex="-1"></a>  <span class="at">jointseg =</span> jointseg<span class="sc">::</span><span class="fu">jointSeg</span>(well_log, <span class="at">K =</span> <span class="dv">12</span>)<span class="sc">$</span>bestBkp,</span>
<span id="cb76-485"><a href="#cb76-485" tabindex="-1"></a>  <span class="at">Rbeast =</span> Rbeast<span class="sc">::</span><span class="fu">beast</span>(</span>
<span id="cb76-486"><a href="#cb76-486" tabindex="-1"></a>    well_log, <span class="at">season =</span> <span class="st">"none"</span>, <span class="at">print.progress =</span> <span class="cn">FALSE</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span></span>
<span id="cb76-487"><a href="#cb76-487" tabindex="-1"></a>  )<span class="sc">$</span>trend<span class="sc">$</span>cp,</span>
<span id="cb76-488"><a href="#cb76-488" tabindex="-1"></a>  <span class="at">stepR =</span> stepR<span class="sc">::</span><span class="fu">stepFit</span>(well_log, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">$</span>rightEnd</span>
<span id="cb76-489"><a href="#cb76-489" tabindex="-1"></a>)</span>
<span id="cb76-490"><a href="#cb76-490" tabindex="-1"></a></span>
<span id="cb76-491"><a href="#cb76-491" tabindex="-1"></a>package_list <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">names</span>(result), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-492"><a href="#cb76-492" tabindex="-1"></a>comparison_table <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb76-493"><a href="#cb76-493" tabindex="-1"></a><span class="cf">for</span> (package_index <span class="cf">in</span> <span class="fu">seq_along</span>(package_list)) {</span>
<span id="cb76-494"><a href="#cb76-494" tabindex="-1"></a>  package <span class="ot">&lt;-</span> package_list[[package_index]]</span>
<span id="cb76-495"><a href="#cb76-495" tabindex="-1"></a>  comparison_table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb76-496"><a href="#cb76-496" tabindex="-1"></a>    comparison_table,</span>
<span id="cb76-497"><a href="#cb76-497" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb76-498"><a href="#cb76-498" tabindex="-1"></a>      <span class="at">change_point =</span> result[[package]],</span>
<span id="cb76-499"><a href="#cb76-499" tabindex="-1"></a>      <span class="at">package =</span> package,</span>
<span id="cb76-500"><a href="#cb76-500" tabindex="-1"></a>      <span class="at">y_offset =</span> (package_index <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">1000</span></span>
<span id="cb76-501"><a href="#cb76-501" tabindex="-1"></a>    )</span>
<span id="cb76-502"><a href="#cb76-502" tabindex="-1"></a>  )</span>
<span id="cb76-503"><a href="#cb76-503" tabindex="-1"></a>}</span>
<span id="cb76-504"><a href="#cb76-504" tabindex="-1"></a></span>
<span id="cb76-505"><a href="#cb76-505" tabindex="-1"></a>most_selected <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">table</span>(comparison_table<span class="sc">$</span>change_point), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-506"><a href="#cb76-506" tabindex="-1"></a>most_selected <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.numeric</span>(<span class="fu">names</span>(most_selected[most_selected <span class="sc">&gt;=</span> <span class="dv">4</span>])))</span>
<span id="cb76-507"><a href="#cb76-507" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">length</span>(most_selected) <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb76-508"><a href="#cb76-508" tabindex="-1"></a>  <span class="cf">if</span> (most_selected[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">-</span> most_selected[i] <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb76-509"><a href="#cb76-509" tabindex="-1"></a>    most_selected[i] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb76-510"><a href="#cb76-510" tabindex="-1"></a>    most_selected[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> most_selected[i <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">-</span> <span class="fl">0.5</span></span>
<span id="cb76-511"><a href="#cb76-511" tabindex="-1"></a>  }</span>
<span id="cb76-512"><a href="#cb76-512" tabindex="-1"></a>}</span>
<span id="cb76-513"><a href="#cb76-513" tabindex="-1"></a>(most_selected <span class="ot">&lt;-</span> most_selected[<span class="sc">!</span><span class="fu">is.na</span>(most_selected)])</span>
<span id="cb76-514"><a href="#cb76-514" tabindex="-1"></a><span class="co">#&gt;  [1]    6.0  314.0  434.0  704.0  776.0 1021.0 1057.0 1347.0 1405.0 1502.0 1661.0 1842.0 2023.0 2202.0</span></span>
<span id="cb76-515"><a href="#cb76-515" tabindex="-1"></a><span class="co">#&gt; [15] 2384.5 2445.0 2507.0 2567.5 2738.0 2921.0 3094.0 3251.0 3464.0 3499.0 3622.0 3709.0 3820.0 3976.0</span></span>
<span id="cb76-516"><a href="#cb76-516" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb76-517"><a href="#cb76-517" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(</span>
<span id="cb76-518"><a href="#cb76-518" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq_along</span>(well_log), <span class="at">y =</span> <span class="fu">c</span>(well_log)),</span>
<span id="cb76-519"><a href="#cb76-519" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb76-520"><a href="#cb76-520" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb76-521"><a href="#cb76-521" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_vline</span>(</span>
<span id="cb76-522"><a href="#cb76-522" tabindex="-1"></a>    <span class="at">xintercept =</span> most_selected,</span>
<span id="cb76-523"><a href="#cb76-523" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb76-524"><a href="#cb76-524" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb76-525"><a href="#cb76-525" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.2</span></span>
<span id="cb76-526"><a href="#cb76-526" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb76-527"><a href="#cb76-527" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(</span>
<span id="cb76-528"><a href="#cb76-528" tabindex="-1"></a>    <span class="at">data =</span> comparison_table,</span>
<span id="cb76-529"><a href="#cb76-529" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> change_point, <span class="at">y =</span> <span class="dv">50000</span> <span class="sc">+</span> y_offset, <span class="at">color =</span> package),</span>
<span id="cb76-530"><a href="#cb76-530" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">17</span>,</span>
<span id="cb76-531"><a href="#cb76-531" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.9</span></span>
<span id="cb76-532"><a href="#cb76-532" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb76-533"><a href="#cb76-533" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_hline</span>(</span>
<span id="cb76-534"><a href="#cb76-534" tabindex="-1"></a>    <span class="at">data =</span> comparison_table,</span>
<span id="cb76-535"><a href="#cb76-535" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">50000</span> <span class="sc">+</span> y_offset, <span class="at">color =</span> package),</span>
<span id="cb76-536"><a href="#cb76-536" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb76-537"><a href="#cb76-537" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.1</span></span>
<span id="cb76-538"><a href="#cb76-538" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb76-539"><a href="#cb76-539" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">coord_cartesian</span>(</span>
<span id="cb76-540"><a href="#cb76-540" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">50000</span> <span class="sc">-</span> <span class="dv">500</span>, <span class="fu">max</span>(well_log) <span class="sc">+</span> <span class="dv">1000</span>),</span>
<span id="cb76-541"><a href="#cb76-541" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">200</span>, <span class="fu">length</span>(well_log) <span class="sc">+</span> <span class="dv">200</span>),</span>
<span id="cb76-542"><a href="#cb76-542" tabindex="-1"></a>    <span class="at">expand =</span> <span class="cn">FALSE</span></span>
<span id="cb76-543"><a href="#cb76-543" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb76-544"><a href="#cb76-544" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb76-545"><a href="#cb76-545" tabindex="-1"></a>    <span class="at">panel.background =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb76-546"><a href="#cb76-546" tabindex="-1"></a>    <span class="at">panel.border =</span> ggplot2<span class="sc">::</span><span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb76-547"><a href="#cb76-547" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>(),</span>
<span id="cb76-548"><a href="#cb76-548" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> ggplot2<span class="sc">::</span><span class="fu">element_blank</span>()</span>
<span id="cb76-549"><a href="#cb76-549" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb76-550"><a href="#cb76-550" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span> ggplot2<span class="sc">::</span><span class="fu">ylab</span>(<span class="cn">NULL</span>)</span>
<span id="cb76-551"><a href="#cb76-551" tabindex="-1"></a>microbenchmark_result <span class="ot">&lt;-</span> microbenchmark<span class="sc">::</span><span class="fu">microbenchmark</span>(</span>
<span id="cb76-552"><a href="#cb76-552" tabindex="-1"></a>  <span class="at">fastcpd =</span> fastcpd<span class="sc">::</span><span class="fu">fastcpd.mean</span>(well_log, <span class="at">trim =</span> <span class="fl">0.003</span>, <span class="at">r.progress =</span> <span class="cn">FALSE</span>),</span>
<span id="cb76-553"><a href="#cb76-553" tabindex="-1"></a>  <span class="at">changepoint =</span> changepoint<span class="sc">::</span><span class="fu">cpt.mean</span>(well_log, <span class="at">method =</span> <span class="st">"PELT"</span>),</span>
<span id="cb76-554"><a href="#cb76-554" tabindex="-1"></a>  <span class="at">CptNonPar =</span> CptNonPar<span class="sc">::</span><span class="fu">np.mojo</span>(well_log, <span class="at">G =</span> <span class="fu">floor</span>(<span class="fu">length</span>(well_log) <span class="sc">/</span> <span class="dv">6</span>)),</span>
<span id="cb76-555"><a href="#cb76-555" tabindex="-1"></a>  <span class="at">strucchange =</span></span>
<span id="cb76-556"><a href="#cb76-556" tabindex="-1"></a>    strucchange<span class="sc">::</span><span class="fu">breakpoints</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">y =</span> well_log)),</span>
<span id="cb76-557"><a href="#cb76-557" tabindex="-1"></a>  <span class="at">ecp =</span> ecp<span class="sc">::</span><span class="fu">e.divisive</span>(<span class="fu">matrix</span>(well_log)),</span>
<span id="cb76-558"><a href="#cb76-558" tabindex="-1"></a>  <span class="at">breakfast =</span> breakfast<span class="sc">::</span><span class="fu">breakfast</span>(well_log),</span>
<span id="cb76-559"><a href="#cb76-559" tabindex="-1"></a>  <span class="at">wbs =</span> wbs<span class="sc">::</span><span class="fu">wbs</span>(well_log),</span>
<span id="cb76-560"><a href="#cb76-560" tabindex="-1"></a>  <span class="at">mosum =</span> mosum<span class="sc">::</span><span class="fu">mosum</span>(<span class="fu">c</span>(well_log), <span class="at">G =</span> <span class="dv">40</span>),</span>
<span id="cb76-561"><a href="#cb76-561" tabindex="-1"></a>  <span class="at">fpop =</span> fpop<span class="sc">::</span><span class="fu">Fpop</span>(well_log, <span class="fu">nrow</span>(well_log)),</span>
<span id="cb76-562"><a href="#cb76-562" tabindex="-1"></a>  <span class="at">gfpop =</span> gfpop<span class="sc">::</span><span class="fu">gfpop</span>(</span>
<span id="cb76-563"><a href="#cb76-563" tabindex="-1"></a>    <span class="at">data =</span> well_log,</span>
<span id="cb76-564"><a href="#cb76-564" tabindex="-1"></a>    <span class="at">mygraph =</span> gfpop<span class="sc">::</span><span class="fu">graph</span>(</span>
<span id="cb76-565"><a href="#cb76-565" tabindex="-1"></a>      <span class="at">penalty =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="fu">length</span>(well_log)) <span class="sc">*</span> gfpop<span class="sc">::</span><span class="fu">sdDiff</span>(well_log) <span class="sc">^</span> <span class="dv">2</span>,</span>
<span id="cb76-566"><a href="#cb76-566" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">"updown"</span></span>
<span id="cb76-567"><a href="#cb76-567" tabindex="-1"></a>    ),</span>
<span id="cb76-568"><a href="#cb76-568" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"mean"</span></span>
<span id="cb76-569"><a href="#cb76-569" tabindex="-1"></a>  ),</span>
<span id="cb76-570"><a href="#cb76-570" tabindex="-1"></a>  <span class="at">InspectChangepoint =</span> InspectChangepoint<span class="sc">::</span><span class="fu">inspect</span>(</span>
<span id="cb76-571"><a href="#cb76-571" tabindex="-1"></a>    well_log,</span>
<span id="cb76-572"><a href="#cb76-572" tabindex="-1"></a>    <span class="at">threshold =</span> InspectChangepoint<span class="sc">::</span><span class="fu">compute.threshold</span>(<span class="fu">length</span>(well_log), <span class="dv">1</span>)</span>
<span id="cb76-573"><a href="#cb76-573" tabindex="-1"></a>  ),</span>
<span id="cb76-574"><a href="#cb76-574" tabindex="-1"></a>  <span class="at">jointseg =</span> jointseg<span class="sc">::</span><span class="fu">jointSeg</span>(well_log, <span class="at">K =</span> <span class="dv">12</span>),</span>
<span id="cb76-575"><a href="#cb76-575" tabindex="-1"></a>  <span class="at">Rbeast =</span> Rbeast<span class="sc">::</span><span class="fu">beast</span>(</span>
<span id="cb76-576"><a href="#cb76-576" tabindex="-1"></a>    well_log, <span class="at">season =</span> <span class="st">"none"</span>, <span class="at">print.progress =</span> <span class="cn">FALSE</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span></span>
<span id="cb76-577"><a href="#cb76-577" tabindex="-1"></a>  ),</span>
<span id="cb76-578"><a href="#cb76-578" tabindex="-1"></a>  <span class="at">stepR =</span> stepR<span class="sc">::</span><span class="fu">stepFit</span>(well_log, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb76-579"><a href="#cb76-579" tabindex="-1"></a>  <span class="at">not =</span> not<span class="sc">::</span><span class="fu">not</span>(well_log, <span class="at">contrast =</span> <span class="st">"pcwsConstMean"</span>),</span>
<span id="cb76-580"><a href="#cb76-580" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">10</span></span>
<span id="cb76-581"><a href="#cb76-581" tabindex="-1"></a>)</span>
<span id="cb76-582"><a href="#cb76-582" tabindex="-1"></a><span class="co">#&gt; Unit: milliseconds</span></span>
<span id="cb76-583"><a href="#cb76-583" tabindex="-1"></a><span class="co">#&gt;                expr          min           lq         mean       median           uq          max neval</span></span>
<span id="cb76-584"><a href="#cb76-584" tabindex="-1"></a><span class="co">#&gt;             fastcpd 8.411284e+01 8.692226e+01 1.011440e+02 1.044509e+02 1.089672e+02    118.05842    10</span></span>
<span id="cb76-585"><a href="#cb76-585" tabindex="-1"></a><span class="co">#&gt;         changepoint 3.206773e+01 3.377081e+01 6.843465e+01 3.857181e+01 5.243834e+01    244.76672    10</span></span>
<span id="cb76-586"><a href="#cb76-586" tabindex="-1"></a><span class="co">#&gt;           CptNonPar 1.827381e+04 1.901094e+04 2.002752e+04 1.985180e+04 2.076803e+04  22511.59316    10</span></span>
<span id="cb76-587"><a href="#cb76-587" tabindex="-1"></a><span class="co">#&gt;         strucchange 5.955079e+04 6.059315e+04 6.185727e+04 6.131291e+04 6.312073e+04  64638.93090    10</span></span>
<span id="cb76-588"><a href="#cb76-588" tabindex="-1"></a><span class="co">#&gt;                 ecp 7.590543e+05 7.707573e+05 7.859080e+05 7.830752e+05 8.093015e+05 810339.52140    10</span></span>
<span id="cb76-589"><a href="#cb76-589" tabindex="-1"></a><span class="co">#&gt;           breakfast 9.170992e+03 9.344041e+03 9.628236e+03 9.382078e+03 9.628663e+03  11073.79318    10</span></span>
<span id="cb76-590"><a href="#cb76-590" tabindex="-1"></a><span class="co">#&gt;                 wbs 1.139078e+02 1.145472e+02 1.178167e+02 1.166746e+02 1.201676e+02    127.27064    10</span></span>
<span id="cb76-591"><a href="#cb76-591" tabindex="-1"></a><span class="co">#&gt;               mosum 1.172847e+00 1.231747e+00 1.740727e+01 1.416854e+00 1.919586e+00    160.76997    10</span></span>
<span id="cb76-592"><a href="#cb76-592" tabindex="-1"></a><span class="co">#&gt;                fpop 2.588228e+00 2.630407e+00 4.587742e+00 2.832556e+00 3.312986e+00     18.52067    10</span></span>
<span id="cb76-593"><a href="#cb76-593" tabindex="-1"></a><span class="co">#&gt;               gfpop 5.971245e+01 6.072684e+01 6.533492e+01 6.172578e+01 6.839653e+01     87.89407    10</span></span>
<span id="cb76-594"><a href="#cb76-594" tabindex="-1"></a><span class="co">#&gt;  InspectChangepoint 1.698673e+02 1.909034e+02 2.392539e+02 2.117010e+02 3.004474e+02    329.87724    10</span></span>
<span id="cb76-595"><a href="#cb76-595" tabindex="-1"></a><span class="co">#&gt;            jointseg 2.000894e+01 2.136878e+01 2.551210e+01 2.167757e+01 2.403593e+01     47.98397    10</span></span>
<span id="cb76-596"><a href="#cb76-596" tabindex="-1"></a><span class="co">#&gt;              Rbeast 6.533998e+02 6.625203e+02 6.783586e+02 6.792646e+02 6.875840e+02    723.45376    10</span></span>
<span id="cb76-597"><a href="#cb76-597" tabindex="-1"></a><span class="co">#&gt;               stepR 2.793709e+01 2.902084e+01 4.380857e+01 3.068416e+01 3.227125e+01    164.81082    10</span></span>
<span id="cb76-598"><a href="#cb76-598" tabindex="-1"></a><span class="co">#&gt;                 not 9.599763e+01 9.701856e+01 1.028601e+02 1.012292e+02 1.049974e+02    120.73529    10</span></span>
<span id="cb76-599"><a href="#cb76-599" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">autoplot</span>(microbenchmark_result)</span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.xingchi.li" class="external-link">Xingchi Li</a>, <a href="https://zhangxiany-tamu.github.io" class="external-link">Xianyang Zhang</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
