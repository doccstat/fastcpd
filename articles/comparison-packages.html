<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Comparison with other R packages â€¢ fastcpd</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Comparison with other R packages">
<meta name="description" content="Speed and result comparison with other R packages.
">
<meta property="og:description" content="Speed and result comparison with other R packages.
">
<meta property="og:image" content="https://fastcpd.xingchi.li/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fastcpd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.16.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/time-complexity.html">Time Complexity Analysis in fastcpd</a></li>
    <li><a class="dropdown-item" href="../articles/comparison-packages.html">Comparison with other R packages</a></li>
    <li><a class="dropdown-item" href="../articles/comparison-pelt.html">Comparison with vanilla PELT</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Examples</h6></li>
    <li><a class="dropdown-item" href="../articles/examples-advanced.html">Advanced examples</a></li>
    <li><a class="dropdown-item" href="../articles/examples-custom-model.html">Custom logistic regression model</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Exploration</h6></li>
    <li><a class="dropdown-item" href="../articles/exploration-during-development.html">Exploration during development</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/doccstat/fastcpd/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Comparison with other R packages</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/doccstat/fastcpd/blob/main/vignettes/comparison-packages.Rmd" class="external-link"><code>vignettes/comparison-packages.Rmd</code></a></small>
      <div class="d-none name"><code>comparison-packages.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="data-setup">Data setup<a class="anchor" aria-label="anchor" href="#data-setup"></a>
</h2>
<div class="section level3">
<h3 id="univariate-mean-change">Univariate mean change<a class="anchor" aria-label="anchor" href="#univariate-mean-change"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Univariate mean change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">mean_data_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Fdata-setup-univariate-mean-change-1.png" alt="plot of chunk data-setup-univariate-mean-change"><div class="figcaption">plot of chunk
data-setup-univariate-mean-change</div>
</div>
</div>
<div class="section level3">
<h3 id="univariate-mean-andor-variance-change">Univariate mean and/or variance change<a class="anchor" aria-label="anchor" href="#univariate-mean-andor-variance-change"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Univariate mean and/or variance change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">mv_data_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Fdata-setup-univariate-mean-and-or-variance-change-1.png" alt="plot of chunk data-setup-univariate-mean-and-or-variance-change"><div class="figcaption">plot of chunk
data-setup-univariate-mean-and-or-variance-change</div>
</div>
</div>
<div class="section level3">
<h3 id="multivariate-mean-change">Multivariate mean change<a class="anchor" aria-label="anchor" href="#multivariate-mean-change"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multivariate mean change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">mean_data_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Fdata-setup-multivariate-mean-change-1.png" alt="plot of chunk data-setup-multivariate-mean-change"><div class="figcaption">plot of chunk
data-setup-multivariate-mean-change</div>
</div>
</div>
<div class="section level3">
<h3 id="multivariate-mean-andor-variance-change">Multivariate mean and/or variance change<a class="anchor" aria-label="anchor" href="#multivariate-mean-andor-variance-change"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multivariate mean and/or variance change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">mv_data_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">400</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">400</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Fdata-setup-multivariate-mean-and-or-variance-change-1.png" alt="plot of chunk data-setup-multivariate-mean-and-or-variance-change"><div class="figcaption">plot of chunk
data-setup-multivariate-mean-and-or-variance-change</div>
</div>
</div>
<div class="section level3">
<h3 id="linear-regression">Linear regression<a class="anchor" aria-label="anchor" href="#linear-regression"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Linear regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3.2</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">2.5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">101</span><span class="op">:</span><span class="fl">200</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">201</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">lm_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">lm_data</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Fdata-setup-linear-regression-1.png" alt="plot of chunk data-setup-linear-regression"><div class="figcaption">plot of chunk data-setup-linear-regression</div>
</div>
</div>
<div class="section level3">
<h3 id="logistic-regression">Logistic regression<a class="anchor" aria-label="anchor" href="#logistic-regression"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Logistic regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">300</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="fl">301</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">binomial_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">binomial_data</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Fdata-setup-logistic-regression-1.png" alt="plot of chunk data-setup-logistic-regression"><div class="figcaption">plot of chunk
data-setup-logistic-regression</div>
</div>
</div>
<div class="section level3">
<h3 id="poisson-regression">Poisson regression<a class="anchor" aria-label="anchor" href="#poisson-regression"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Poisson regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1100</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.3</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">501</span><span class="op">:</span><span class="fl">800</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">theta_0</span> <span class="op">+</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">801</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1001</span><span class="op">:</span><span class="fl">1100</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">theta_0</span> <span class="op">-</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">poisson_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">poisson_data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Fdata-setup-poisson-regression-1.png" alt="plot of chunk data-setup-poisson-regression"><div class="figcaption">plot of chunk
data-setup-poisson-regression</div>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">poisson_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Fdata-setup-poisson-regression-2.png" alt="plot of chunk data-setup-poisson-regression"><div class="figcaption">plot of chunk
data-setup-poisson-regression</div>
</div>
</div>
<div class="section level3">
<h3 id="lasso">Lasso<a class="anchor" aria-label="anchor" href="#lasso"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lasso</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">480</span></span>
<span><span class="va">p_true</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, ncol <span class="op">=</span> <span class="va">p</span> <span class="op">-</span> <span class="va">p_true</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">80</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">81</span><span class="op">:</span><span class="fl">200</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">201</span><span class="op">:</span><span class="fl">320</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">321</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">4</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">160</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">lasso_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">lasso_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">p_true</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Fdata-setup-lasso-1.png" alt="plot of chunk data-setup-lasso"><div class="figcaption">plot of chunk data-setup-lasso</div>
</div>
</div>
<div class="section level3">
<h3 id="ar3">AR(3)<a class="anchor" aria-label="anchor" href="#ar3"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># AR(3)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">600</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">601</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">ar_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Fdata-setup-ar3-1.png" alt="plot of chunk data-setup-ar3"><div class="figcaption">plot of chunk data-setup-ar3</div>
</div>
</div>
<div class="section level3">
<h3 id="garch1-1">GARCH(1, 1)<a class="anchor" aria-label="anchor" href="#garch1-1"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># GARCH(1, 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1501</span></span>
<span><span class="va">sigma_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">750</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="op">+</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">751</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">garch_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">garch_data</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Fdata-setup-garch11-1.png" alt="plot of chunk data-setup-garch11"><div class="figcaption">plot of chunk data-setup-garch11</div>
</div>
</div>
<div class="section level3">
<h3 id="var2">VAR(2)<a class="anchor" aria-label="anchor" href="#var2"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># VAR(2)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">800</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">theta_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">theta_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">2</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta_1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>, <span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">501</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta_2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>, <span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">var_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Fdata-setup-var2-1.png" alt="plot of chunk data-setup-var2"><div class="figcaption">plot of chunk data-setup-var2</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="univariate-mean-change-1">Univariate mean change<a class="anchor" aria-label="anchor" href="#univariate-mean-change-1"></a>
</h2>
<p>The true change points are 300 and 700. Some methods are plotted due
to the un-retrievable change points.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">mean_data_1</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">mean_data_1</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]    1  301  701 1001</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpts</span><span class="op">(</span><span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.mean</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html" class="external-link">mad</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"PELT"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"breakfast"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">breakfast</span><span class="fu">::</span><span class="fu">breakfast</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">cptmodel.list</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"breakfast"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"wbs"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">wbs</span><span class="fu">::</span><span class="fu">wbs</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">cpt</span><span class="op">$</span><span class="va">cpt.ic</span><span class="op">$</span><span class="va">mbic.penalty</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"wbs"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mosum"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">mosum</span><span class="fu">::</span><span class="fu">mosum</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">$</span><span class="va">cpts.info</span><span class="op">$</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mosum"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fpop"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fpop</span><span class="fu">::</span><span class="fu">Fpop</span><span class="op">(</span><span class="va">mean_data_1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">t.est</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fpop"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  300  700 1000</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"gfpop"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">gfpop</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">mean_data_1</span>,</span>
<span>    mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">graph</span><span class="op">(</span></span>
<span>      penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">sdDiff</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">changepoints</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"gfpop"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  300  700 1000</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">mean_data_1</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"stepR"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">stepR</span><span class="fu">::</span><span class="fu">stepFit</span><span class="op">(</span><span class="va">mean_data_1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">$</span><span class="va">rightEnd</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"stepR"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  300  700 1000</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">cpm</span><span class="fu">::</span><span class="fu">processStream</span><span class="op">(</span><span class="va">mean_data_1</span>, cpmType <span class="op">=</span> <span class="st">"Student"</span><span class="op">)</span><span class="op">$</span><span class="va">changePoints</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 299 699</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">segmented</span><span class="fu">::</span><span class="fu">stepmented</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, npsi <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; psi1.index psi2.index </span></span>
<span><span class="co">#&gt;   300.0813   700.1513</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">mcp</span><span class="fu">::</span><span class="fu">mcp</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_1</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Error : .onLoad failed in loadNamespace() for 'rjags', details:</span></span>
<span><span class="co">#&gt;   call: dyn.load(file, DLLpath = DLLpath, ...)</span></span>
<span><span class="co">#&gt;   error: unable to load shared object '/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/rjags/libs/rjags.so':</span></span>
<span><span class="co">#&gt;   dlopen(/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/rjags/libs/rjags.so, 0x000A): Library not loaded: /usr/local/lib/libjags.4.dylib</span></span>
<span><span class="co">#&gt;   Referenced from: &lt;CAF5E1DC-317A-34FE-988A-FB6F7C73D89E&gt; /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/rjags/libs/rjags.so</span></span>
<span><span class="co">#&gt;   Reason: tried: '/usr/local/lib/libjags.4.dylib' (no such file), '/System/Volumes/Preboot/Cryptexes/OS/usr/local/lib/libjags.4.dylib' (no such file), '/usr/local/lib/libjags.4.dylib' (no such file), '/Library/Frameworks/R.framework/Resources/lib/libjags.4.dylib' (no such file), '/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server/libjags.4.dylib' (no such file), '/var/folders/lw/np6nlqmn527g1n2ysqssf00c0000gn/T/rstudio-fallback-library-path-1577547578/libjags.4.dylib' (no such file)</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"mcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Error in samples[[1]]: subscript out of bounds</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">not</span><span class="fu">::</span><span class="fu">not</span><span class="op">(</span><span class="va">mean_data_1</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMean"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"not"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Funivariate-mean-change-not-result-1.png" alt="plot of chunk univariate-mean-change-not-result"><div class="figcaption">plot of chunk
univariate-mean-change-not-result</div>
</div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">bcp</span><span class="fu">::</span><span class="fu">bcp</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"bcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Funivariate-mean-change-bcp-result-1.png" alt="plot of chunk univariate-mean-change-bcp-result"><div class="figcaption">plot of chunk
univariate-mean-change-bcp-result</div>
</div>
</div>
<div class="section level2">
<h2 id="univariate-mean-andor-variance-change-1">Univariate mean and/or variance change<a class="anchor" aria-label="anchor" href="#univariate-mean-andor-variance-change-1"></a>
</h2>
<p>The true change points are 300, 700, 1000, 1300 and 1700. Some
methods are plotted due to the un-retrievable change points.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_meanvariance.html">fastcpd.mv</a></span><span class="op">(</span><span class="va">mv_data_1</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  300  700 1001 1300 1700</span></span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]    1  301  701 1001 1301 1701 2001</span></span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpts</span><span class="op">(</span><span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.meanvar</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"PELT"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  300  700 1000 1300 1700</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">mv_data_1</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  333  700 1300</span></span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">cpm</span><span class="fu">::</span><span class="fu">processStream</span><span class="op">(</span><span class="va">mv_data_1</span>, cpmType <span class="op">=</span> <span class="st">"GLR"</span><span class="op">)</span><span class="op">$</span><span class="va">changePoints</span></span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1]  293  300  403  408  618  621  696 1000 1021 1024 1293 1300 1417 1693 1700 1981</span></span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">mcp</span><span class="fu">::</span><span class="fu">mcp</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mv_data_1</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Error : .onLoad failed in loadNamespace() for 'rjags', details:</span></span>
<span><span class="co">#&gt;   call: dyn.load(file, DLLpath = DLLpath, ...)</span></span>
<span><span class="co">#&gt;   error: unable to load shared object '/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/rjags/libs/rjags.so':</span></span>
<span><span class="co">#&gt;   dlopen(/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/rjags/libs/rjags.so, 0x000A): Library not loaded: /usr/local/lib/libjags.4.dylib</span></span>
<span><span class="co">#&gt;   Referenced from: &lt;CAF5E1DC-317A-34FE-988A-FB6F7C73D89E&gt; /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/rjags/libs/rjags.so</span></span>
<span><span class="co">#&gt;   Reason: tried: '/usr/local/lib/libjags.4.dylib' (no such file), '/System/Volumes/Preboot/Cryptexes/OS/usr/local/lib/libjags.4.dylib' (no such file), '/usr/local/lib/libjags.4.dylib' (no such file), '/Library/Frameworks/R.framework/Resources/lib/libjags.4.dylib' (no such file), '/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server/libjags.4.dylib' (no such file), '/var/folders/lw/np6nlqmn527g1n2ysqssf00c0000gn/T/rstudio-fallback-library-path-1577547578/libjags.4.dylib' (no such file)</span></span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"mcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Error in samples[[1]]: subscript out of bounds</span></span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">not</span><span class="fu">::</span><span class="fu">not</span><span class="op">(</span><span class="va">mv_data_1</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMeanVar"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"not"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="comparison-packages%2Funivariate-mean-and-or-variance-change-not-result-1.png" alt="plot of chunk univariate-mean-and-or-variance-change-not-result"><img src="comparison-packages%2Funivariate-mean-and-or-variance-change-not-result-2.png" alt="plot of chunk univariate-mean-and-or-variance-change-not-result"></p>
</div>
<div class="section level2">
<h2 id="multivariate-mean-change-1">Multivariate mean change<a class="anchor" aria-label="anchor" href="#multivariate-mean-change-1"></a>
</h2>
<p>The true change points are 300 and 700. Some methods are plotted due
to the un-retrievable change points.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">mean_data_3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">mean_data_3</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">mean_data_3</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span></span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y.1</span>, <span class="va">y.2</span>, <span class="va">y.3</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_3</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]    1  301  701 1001</span></span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">bcp</span><span class="fu">::</span><span class="fu">bcp</span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"bcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Fmultivariate-mean-change-bcp-result-1.png" alt="plot of chunk multivariate-mean-change-bcp-result"><div class="figcaption">plot of chunk
multivariate-mean-change-bcp-result</div>
</div>
</div>
<div class="section level2">
<h2 id="multivariate-mean-andor-variance-change-1">Multivariate mean and/or variance change<a class="anchor" aria-label="anchor" href="#multivariate-mean-andor-variance-change-1"></a>
</h2>
<p>The true change points are 300, 700, 1000, 1300 and 1700. Some
methods are plotted due to the un-retrievable change points.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_meanvariance.html">fastcpd.mv</a></span><span class="op">(</span><span class="va">mv_data_3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  300  700 1013 1300 1700</span></span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]    1  301  701 1001 1301 1701 2001</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="linear-regression-1">Linear regression<a class="anchor" aria-label="anchor" href="#linear-regression-1"></a>
</h2>
<p>The true change points are 100 and 200.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_lm.html">fastcpd.lm</a></span><span class="op">(</span><span class="va">lm_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  97 201</span></span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">lm_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 100 201</span></span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">segmented</span><span class="fu">::</span><span class="fu">segmented</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>      <span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lm_data</span><span class="op">$</span><span class="va">y</span>, x <span class="op">=</span> <span class="va">lm_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">lm_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    seg.Z <span class="op">=</span> <span class="op">~</span> <span class="va">index</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 233</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="logistic-regression-1">Logistic regression<a class="anchor" aria-label="anchor" href="#logistic-regression-1"></a>
</h2>
<p>The true change point is 300.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_binomial.html">fastcpd.binomial</a></span><span class="op">(</span><span class="va">binomial_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 302</span></span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">binomial_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 297</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="poisson-regression-1">Poisson regression<a class="anchor" aria-label="anchor" href="#poisson-regression-1"></a>
</h2>
<p>The true change points are 500, 800 and 1000.</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_poisson.html">fastcpd.poisson</a></span><span class="op">(</span><span class="va">poisson_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  506  838 1003</span></span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">poisson_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 935</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="lasso-1">Lasso<a class="anchor" aria-label="anchor" href="#lasso-1"></a>
</h2>
<p>The true change points are 80, 200 and 320.</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_lasso.html">fastcpd.lasso</a></span><span class="op">(</span><span class="va">lasso_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  79 199 321</span></span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">lasso_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  80 200 321</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="ar3-1">AR(3)<a class="anchor" aria-label="anchor" href="#ar3-1"></a>
</h2>
<p>The true change point is 600. Some methods are plotted due to the
un-retrievable change points.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_ar.html">fastcpd.ar</a></span><span class="op">(</span><span class="va">ar_data</span>, <span class="fl">3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 614</span></span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">ar_data</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; numeric(0)</span></span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">segmented</span><span class="fu">::</span><span class="fu">segmented</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>      <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ar_data</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    seg.Z <span class="op">=</span> <span class="op">~</span> <span class="va">x</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 690.0001</span></span></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">mcp</span><span class="fu">::</span><span class="fu">mcp</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/ar.html" class="external-link">ar</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/ar.html" class="external-link">ar</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ar_data</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Error : .onLoad failed in loadNamespace() for 'rjags', details:</span></span>
<span><span class="co">#&gt;   call: dyn.load(file, DLLpath = DLLpath, ...)</span></span>
<span><span class="co">#&gt;   error: unable to load shared object '/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/rjags/libs/rjags.so':</span></span>
<span><span class="co">#&gt;   dlopen(/Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/rjags/libs/rjags.so, 0x000A): Library not loaded: /usr/local/lib/libjags.4.dylib</span></span>
<span><span class="co">#&gt;   Referenced from: &lt;CAF5E1DC-317A-34FE-988A-FB6F7C73D89E&gt; /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library/rjags/libs/rjags.so</span></span>
<span><span class="co">#&gt;   Reason: tried: '/usr/local/lib/libjags.4.dylib' (no such file), '/System/Volumes/Preboot/Cryptexes/OS/usr/local/lib/libjags.4.dylib' (no such file), '/usr/local/lib/libjags.4.dylib' (no such file), '/Library/Frameworks/R.framework/Resources/lib/libjags.4.dylib' (no such file), '/Library/Java/JavaVirtualMachines/jdk-11.0.18+10/Contents/Home/lib/server/libjags.4.dylib' (no such file), '/var/folders/lw/np6nlqmn527g1n2ysqssf00c0000gn/T/rstudio-fallback-library-path-1577547578/libjags.4.dylib' (no such file)</span></span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"mcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Error in `sample_n()`:</span></span>
<span><span class="co">#&gt; ! `tbl` must be a data frame, not `NULL`.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="garch1-1-1">GARCH(1, 1)<a class="anchor" aria-label="anchor" href="#garch1-1-1"></a>
</h2>
<p>The true change point is 750.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_garch.html">fastcpd.garch</a></span><span class="op">(</span><span class="va">garch_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 759</span></span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">garch_data</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">garch_data</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 759</span></span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">x</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">garch_data</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] NA</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="var2-1">VAR(2)<a class="anchor" aria-label="anchor" href="#var2-1"></a>
</h2>
<p>The true change points is 500.</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_var.html">fastcpd.var</a></span><span class="op">(</span><span class="va">var_data</span>, <span class="fl">2</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 500</span></span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"VARDetect"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">VARDetect</span><span class="fu">::</span><span class="fu">tbss</span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span><span class="op">$</span><span class="va">cp</span></span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"VARDetect"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 501</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="detection-comparison-using-well_log">Detection comparison using <code>well_log</code><a class="anchor" aria-label="anchor" href="#detection-comparison-using-well_log"></a>
</h2>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">well_log</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="va"><a href="../reference/well_log.html">well_log</a></span></span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">well_log</span> <span class="op">&lt;-</span> <span class="va">well_log</span><span class="op">[</span><span class="va">well_log</span> <span class="op">&gt;</span> <span class="fl">1e5</span><span class="op">]</span></span>
<span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  fastcpd <span class="op">=</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">well_log</span>, trim <span class="op">=</span> <span class="fl">0.003</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span>,</span>
<span>  changepoint <span class="op">=</span> <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpts</span><span class="op">(</span><span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.mean</span><span class="op">(</span><span class="va">well_log</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html" class="external-link">mad</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"PELT"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  CptNonPar <span class="op">=</span></span>
<span>    <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">well_log</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  strucchange <span class="op">=</span> <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span></span>
<span>    <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">well_log</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span>,</span>
<span>  ecp <span class="op">=</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span>,</span>
<span>  breakfast <span class="op">=</span> <span class="fu">breakfast</span><span class="fu">::</span><span class="fu">breakfast</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">$</span><span class="va">cptmodel.list</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  wbs <span class="op">=</span> <span class="fu">wbs</span><span class="fu">::</span><span class="fu">wbs</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">$</span><span class="va">cpt</span><span class="op">$</span><span class="va">cpt.ic</span><span class="op">$</span><span class="va">mbic.penalty</span>,</span>
<span>  mosum <span class="op">=</span> <span class="fu">mosum</span><span class="fu">::</span><span class="fu">mosum</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">$</span><span class="va">cpts.info</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  <span class="co"># fpop = fpop::Fpop(well_log, length(well_log))$t.est,  # meaningless</span></span>
<span>  gfpop <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">gfpop</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">well_log</span>,</span>
<span>    mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">graph</span><span class="op">(</span></span>
<span>      penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">sdDiff</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">changepoints</span>,</span>
<span>  jointseg <span class="op">=</span> <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">well_log</span>, K <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span>,</span>
<span>  stepR <span class="op">=</span> <span class="fu">stepR</span><span class="fu">::</span><span class="fu">stepFit</span><span class="op">(</span><span class="va">well_log</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">$</span><span class="va">rightEnd</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; $fastcpd</span></span>
<span><span class="co">#&gt;  [1]   12  572  704  779 1021 1057 1198 1348 1406 1502 1665 1842 2023 2385 2445 2507 2567 2749 2926 3076 3523 3622 3709 3820 3976</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $changepoint</span></span>
<span><span class="co">#&gt;  [1]    6 1021 1057 1502 1661 1842 2023 2385 2445 2507 2567 2745</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CptNonPar</span></span>
<span><span class="co">#&gt; [1] 1021 1681 2022 2738</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $strucchange</span></span>
<span><span class="co">#&gt; [1] 1057 1660 2568 3283</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ecp</span></span>
<span><span class="co">#&gt;  [1]    1   33  315  435  567  705  803 1026 1058 1348 1503 1662 1843 2024 2203 2386 2446 2508 2569 2745 2780 2922 3073 3136 3252 3465 3500 3554 3623 3710 3821 3868 3990</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $breakfast</span></span>
<span><span class="co">#&gt;  [1]   33  310  434  572  704  779 1021 1057 1347 1502 1659 1842 2021 2032 2202 2384 2446 2507 2567 2747 2779 2926 3094 3106 3125 3283 3464 3499 3622 3709 3806 3835 3848 3877 3896</span></span>
<span><span class="co">#&gt; [36] 3976</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $wbs</span></span>
<span><span class="co">#&gt;  [1] 2568 1057 1661 1842 2385 2023 1502 2445 2744    6 2507 1021 3709 3820 1402  434 1408 1200 3131  704  776 3509 3622 3976  314 3104 1347 3251 3464 3094 2752 2921 3848 3906 1663</span></span>
<span><span class="co">#&gt; [36]   60 3904 2202  566 1197   12    7 2747</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mosum</span></span>
<span><span class="co">#&gt;  [1]    6  434  704 1017 1057 1325 1502 1661 1842 2023 2385 2445 2507 2567 2744 3060 3438 3509 3610 3697 3820 3867 3976</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gfpop</span></span>
<span><span class="co">#&gt;  [1]    6    7    8   12  314  434  556  560  704  776 1021 1057 1197 1200 1347 1364 1405 1407 1491 1502 1661 1842 2023 2385 2445 2507 2567 2664 2747 2752 2921 3094 3104 3125 3251</span></span>
<span><span class="co">#&gt; [36] 3464 3499 3622 3709 3820 3976 3989</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $jointseg</span></span>
<span><span class="co">#&gt;  [1]    6 1021 1057 1502 1661 1842 2022 2384 2445 2507 2568 2738</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $stepR</span></span>
<span><span class="co">#&gt;  [1]    7   14  314  434  566  704  776 1021 1057 1197 1200 1347 1405 1407 1502 1661 1694 1842 2023 2202 2385 2445 2507 2567 2747 2752 2921 3094 3104 3125 3251 3464 3499 3609 3658</span></span>
<span><span class="co">#&gt; [36] 3709 3820 3867 3905 3976 3989</span></span></code></pre></div>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">package_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">package_index</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">package_list</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">package</span> <span class="op">&lt;-</span> <span class="va">package_list</span><span class="op">[[</span><span class="va">package_index</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="va">comparison_table</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      change_point <span class="op">=</span> <span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">package</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      package <span class="op">=</span> <span class="va">package</span>,</span>
<span>      y_offset <span class="op">=</span> <span class="op">(</span><span class="va">package_index</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1000</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">comparison_table</span><span class="op">$</span><span class="va">change_point</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">[</span><span class="va">most_selected</span> <span class="op">&gt;=</span> <span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.5</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="op">(</span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="va">most_selected</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1]    6  434  704 1021 1057 1347 1502 1661 1842 2023 2385 2445 2507 2567 2747 3094 3464 3622 3709 3820 3976</span></span></code></pre></div>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span></span>
<span>      xintercept <span class="op">=</span> <span class="va">most_selected</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>      linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fl">0.2</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">comparison_table</span>,</span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">change_point</span>, y <span class="op">=</span> <span class="fl">50000</span> <span class="op">+</span> <span class="va">y_offset</span>, color <span class="op">=</span> <span class="va">package</span><span class="op">)</span>,</span>
<span>      shape <span class="op">=</span> <span class="fl">17</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">1.9</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">comparison_table</span>,</span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">50000</span> <span class="op">+</span> <span class="va">y_offset</span>, color <span class="op">=</span> <span class="va">package</span><span class="op">)</span>,</span>
<span>      linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fl">0.1</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span></span>
<span>      ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50000</span> <span class="op">-</span> <span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>      xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">+</span> <span class="fl">200</span><span class="op">)</span>,</span>
<span>      expand <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      panel.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.border <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>      panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Fdetection-comparison-well-log-plot-1.png" alt="plot of chunk detection-comparison-well-log-plot"><div class="figcaption">plot of chunk
detection-comparison-well-log-plot</div>
</div>
</div>
<div class="section level2">
<h2 id="time-comparison-using-well_log">Time comparison using <code>well_log</code><a class="anchor" aria-label="anchor" href="#time-comparison-using-well_log"></a>
</h2>
<p>Some packages are commented out due to the excessive running
time.</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"microbenchmark"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu">microbenchmark</span><span class="op">(</span></span>
<span>  fastcpd <span class="op">=</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">well_log</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span>, cp_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  changepoint <span class="op">=</span> <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.mean</span><span class="op">(</span><span class="va">well_log</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html" class="external-link">mad</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"PELT"</span><span class="op">)</span>,</span>
<span>  <span class="co"># CptNonPar = CptNonPar::np.mojo(well_log, G = floor(length(well_log) / 6)),</span></span>
<span>  <span class="co"># strucchange = strucchange::breakpoints(y ~ 1, data = data.frame(y = well_log)),</span></span>
<span>  <span class="co"># ecp = ecp::e.divisive(matrix(well_log)),</span></span>
<span>  <span class="co"># breakfast = breakfast::breakfast(well_log),</span></span>
<span>  wbs <span class="op">=</span> <span class="fu">wbs</span><span class="fu">::</span><span class="fu">wbs</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>,</span>
<span>  mosum <span class="op">=</span> <span class="fu">mosum</span><span class="fu">::</span><span class="fu">mosum</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span>,</span>
<span>  fpop <span class="op">=</span> <span class="fu">fpop</span><span class="fu">::</span><span class="fu">Fpop</span><span class="op">(</span><span class="va">well_log</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  gfpop <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">gfpop</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">well_log</span>,</span>
<span>    mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">graph</span><span class="op">(</span></span>
<span>      penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">sdDiff</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  jointseg <span class="op">=</span> <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">well_log</span>, K <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>  stepR <span class="op">=</span> <span class="fu">stepR</span><span class="fu">::</span><span class="fu">stepFit</span><span class="op">(</span><span class="va">well_log</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  not <span class="op">=</span> <span class="fu">not</span><span class="fu">::</span><span class="fu">not</span><span class="op">(</span><span class="va">well_log</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMean"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"microbenchmark"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; Unit: microseconds</span></span>
<span><span class="co">#&gt;         expr       min        lq       mean     median         uq       max neval</span></span>
<span><span class="co">#&gt;      fastcpd  6245.325  6447.332  7086.8283  6555.5310  6752.3515 13977.187   100</span></span>
<span><span class="co">#&gt;  changepoint 28794.177 29138.577 29463.6463 29275.8040 29458.9100 35287.429   100</span></span>
<span><span class="co">#&gt;          wbs 51531.260 52697.669 53605.2848 53153.4250 53592.7605 65784.705   100</span></span>
<span><span class="co">#&gt;        mosum   506.268   560.593   577.0709   577.0955   595.4635   655.877   100</span></span>
<span><span class="co">#&gt;         fpop  1116.225  1160.895  1321.8826  1177.6430  1199.3320  9798.467   100</span></span>
<span><span class="co">#&gt;        gfpop 30872.426 31118.918 31558.2539 31281.2575 31399.0095 37123.122   100</span></span>
<span><span class="co">#&gt;     jointseg  8176.179  8328.309  8838.3495  8422.5480  8557.6430 12874.410   100</span></span>
<span><span class="co">#&gt;        stepR 44931.080 45298.809 45808.1098 45458.4220 45608.6255 60913.577   100</span></span>
<span><span class="co">#&gt;          not 49734.435 50815.175 52003.4189 51456.0455 52269.0960 58119.714   100</span></span></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"microbenchmark"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"microbenchmark"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="comparison-packages%2Ftime-comparison-well-log-plot-1.png" alt="plot of chunk time-comparison-well-log-plot"><div class="figcaption">plot of chunk
time-comparison-well-log-plot</div>
</div>
</div>
<div class="section level2">
<h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h2>
<p>This document is generated by the following code:</p>
<pre class="shell"><code>R -e 'knitr::knit("vignettes/comparison-packages.Rmd.original", output = "vignettes/comparison-packages.Rmd")' &amp;&amp; rm -rf vignettes/comparison-packages &amp;&amp; mv -f comparison-packages vignettes</code></pre>
</div>
<div class="section level2">
<h2 id="related-issues">Related issues<a class="anchor" aria-label="anchor" href="#related-issues"></a>
</h2>
<ul>
<li>
<code>mosum</code>: [<a href="https://github.com/doccstat/fastcpd/issues/4" class="external-link">#4</a>].</li>
<li>
<code>mcp</code>: Package removed due to the usage of
<code>rjags</code>.</li>
<li>
<code>bcp</code>: [<a href="https://github.com/doccstat/fastcpd/issues/5" class="external-link">#5</a>].</li>
<li>
<code>gfpop</code>: [<a href="https://github.com/doccstat/fastcpd/issues/10" class="external-link">#10</a>].</li>
</ul>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<ul>
<li>
<a href="https://www.unipa.it/persone/docenti/m/vito.muggeo" class="external-link">Dr.Â Vito
Muggeo</a>, author of the <code>segmented</code> package for the tips
about the piece-wise constant function.</li>
<li>
<a href="https://www.lancaster.ac.uk/maths/people/rebecca-killick" class="external-link">Dr.Â Rebecca
Killick</a>, author of the <code>changepoint</code> package for the tips
about the package update.</li>
</ul>
</div>
<div class="section level2">
<h2 id="appendix-all-code-snippets">Appendix: all code snippets<a class="anchor" aria-label="anchor" href="#appendix-all-code-snippets"></a>
</h2>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span></span>
<span>  collapse <span class="op">=</span> <span class="cn">TRUE</span>, comment <span class="op">=</span> <span class="st">"#&gt;"</span>, eval <span class="op">=</span> <span class="cn">TRUE</span>, cache <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  warning <span class="op">=</span> <span class="cn">FALSE</span>, fig.width <span class="op">=</span> <span class="fl">8</span>, fig.height <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  fig.path<span class="op">=</span><span class="st">"comparison-packages/"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># devtools::install_github(c("swang87/bcp", "veseshan/DNAcopy", "vrunge/gfpop", "peiliangbai92/VARDetect"))</span></span>
<span><span class="co"># install.packages(c("changepoint", "cpm", "CptNonPar", "strucchange", "ecp", "breakfast", "wbs", "mcp", "mosum", "not", "fpop", "jointseg", "microbenchmark", "segmented", "stepR"))</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"microbenchmark"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"comparison-packages-results.RData"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Available at https://pcloud.xingchi.li/comparison-packages-results.RData</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"comparison-packages-results.RData"</span><span class="op">)</span></span>
<span>  <span class="va">rerun</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">rerun</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Univariate mean change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">mean_data_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span></span>
<span><span class="co"># Univariate mean and/or variance change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">mv_data_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span></span>
<span><span class="co"># Multivariate mean change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">mean_data_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span></span>
<span><span class="co"># Multivariate mean and/or variance change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">mv_data_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">400</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">400</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span></span>
<span><span class="co"># Linear regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3.2</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">2.5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">101</span><span class="op">:</span><span class="fl">200</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">201</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">lm_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">lm_data</span><span class="op">)</span></span>
<span><span class="co"># Logistic regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">300</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="fl">301</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">binomial_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">binomial_data</span><span class="op">)</span></span>
<span><span class="co"># Poisson regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1100</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.3</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">501</span><span class="op">:</span><span class="fl">800</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">theta_0</span> <span class="op">+</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">801</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1001</span><span class="op">:</span><span class="fl">1100</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">theta_0</span> <span class="op">-</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">poisson_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">poisson_data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">poisson_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># Lasso</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">480</span></span>
<span><span class="va">p_true</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, ncol <span class="op">=</span> <span class="va">p</span> <span class="op">-</span> <span class="va">p_true</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">80</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">81</span><span class="op">:</span><span class="fl">200</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">201</span><span class="op">:</span><span class="fl">320</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">321</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">4</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">160</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">lasso_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">lasso_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">p_true</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># AR(3)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">600</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">601</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">ar_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span></span>
<span><span class="co"># GARCH(1, 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1501</span></span>
<span><span class="va">sigma_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">750</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="op">+</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">751</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">garch_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">garch_data</span><span class="op">)</span></span>
<span><span class="co"># VAR(2)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">800</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">theta_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">theta_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">2</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta_1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>, <span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">501</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta_2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>, <span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">var_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">mean_data_1</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">mean_data_1</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">301</span>, <span class="fl">701</span>, <span class="fl">1001</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpts</span><span class="op">(</span><span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.mean</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html" class="external-link">mad</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"PELT"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"breakfast"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">breakfast</span><span class="fu">::</span><span class="fu">breakfast</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">cptmodel.list</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"breakfast"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"breakfast"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"wbs"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">wbs</span><span class="fu">::</span><span class="fu">wbs</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">cpt</span><span class="op">$</span><span class="va">cpt.ic</span><span class="op">$</span><span class="va">mbic.penalty</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"wbs"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"wbs"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mosum"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">mosum</span><span class="fu">::</span><span class="fu">mosum</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">$</span><span class="va">cpts.info</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mosum"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mosum"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fpop"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fpop</span><span class="fu">::</span><span class="fu">Fpop</span><span class="op">(</span><span class="va">mean_data_1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">t.est</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fpop"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fpop"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span>, <span class="fl">1000</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"gfpop"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">gfpop</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">mean_data_1</span>,</span>
<span>    mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">graph</span><span class="op">(</span></span>
<span>      penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">sdDiff</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">changepoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"gfpop"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"gfpop"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span>, <span class="fl">1000</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">mean_data_1</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"stepR"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">stepR</span><span class="fu">::</span><span class="fu">stepFit</span><span class="op">(</span><span class="va">mean_data_1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">$</span><span class="va">rightEnd</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"stepR"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"stepR"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span>, <span class="fl">1000</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">cpm</span><span class="fu">::</span><span class="fu">processStream</span><span class="op">(</span><span class="va">mean_data_1</span>, cpmType <span class="op">=</span> <span class="st">"Student"</span><span class="op">)</span><span class="op">$</span><span class="va">changePoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">299</span>, <span class="fl">699</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">segmented</span><span class="fu">::</span><span class="fu">stepmented</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, npsi <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">298</span>, <span class="fl">699</span><span class="op">)</span>, ignore_attr <span class="op">=</span> <span class="cn">TRUE</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">mcp</span><span class="fu">::</span><span class="fu">mcp</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_1</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"mcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">not</span><span class="fu">::</span><span class="fu">not</span><span class="op">(</span><span class="va">mean_data_1</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMean"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"not"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">bcp</span><span class="fu">::</span><span class="fu">bcp</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"bcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_meanvariance.html">fastcpd.mv</a></span><span class="op">(</span><span class="va">mv_data_1</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span>, <span class="fl">1001</span>, <span class="fl">1300</span>, <span class="fl">1700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">301</span>, <span class="fl">701</span>, <span class="fl">1001</span>, <span class="fl">1301</span>, <span class="fl">1701</span>, <span class="fl">2001</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpts</span><span class="op">(</span><span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.meanvar</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"PELT"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span>, <span class="fl">1000</span>, <span class="fl">1300</span>, <span class="fl">1700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">mv_data_1</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">333</span>, <span class="fl">700</span>, <span class="fl">1300</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">cpm</span><span class="fu">::</span><span class="fu">processStream</span><span class="op">(</span><span class="va">mv_data_1</span>, cpmType <span class="op">=</span> <span class="st">"GLR"</span><span class="op">)</span><span class="op">$</span><span class="va">changePoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">293</span>, <span class="fl">300</span>, <span class="fl">403</span>, <span class="fl">408</span>, <span class="fl">618</span>, <span class="fl">621</span>, <span class="fl">696</span>, <span class="fl">1000</span>, <span class="fl">1021</span>, <span class="fl">1024</span>, <span class="fl">1293</span>, <span class="fl">1300</span>, <span class="fl">1417</span>, <span class="fl">1693</span>, <span class="fl">1700</span>, <span class="fl">1981</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">mcp</span><span class="fu">::</span><span class="fu">mcp</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mv_data_1</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"mcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">not</span><span class="fu">::</span><span class="fu">not</span><span class="op">(</span><span class="va">mv_data_1</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMeanVar"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"not"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">mean_data_3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">mean_data_3</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">mean_data_3</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y.1</span>, <span class="va">y.2</span>, <span class="va">y.3</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_3</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">301</span>, <span class="fl">701</span>, <span class="fl">1001</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">bcp</span><span class="fu">::</span><span class="fu">bcp</span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"bcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_meanvariance.html">fastcpd.mv</a></span><span class="op">(</span><span class="va">mv_data_3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span>, <span class="fl">1013</span>, <span class="fl">1300</span>, <span class="fl">1700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">301</span>, <span class="fl">701</span>, <span class="fl">1001</span>, <span class="fl">1301</span>, <span class="fl">1701</span>, <span class="fl">2001</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_lm.html">fastcpd.lm</a></span><span class="op">(</span><span class="va">lm_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">97</span>, <span class="fl">201</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">lm_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">201</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">segmented</span><span class="fu">::</span><span class="fu">segmented</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>      <span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lm_data</span><span class="op">$</span><span class="va">y</span>, x <span class="op">=</span> <span class="va">lm_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">lm_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    seg.Z <span class="op">=</span> <span class="op">~</span> <span class="va">index</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">233</span><span class="op">)</span>, ignore_attr <span class="op">=</span> <span class="cn">TRUE</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_binomial.html">fastcpd.binomial</a></span><span class="op">(</span><span class="va">binomial_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">302</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">binomial_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">297</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_poisson.html">fastcpd.poisson</a></span><span class="op">(</span><span class="va">poisson_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">498</span>, <span class="fl">805</span>, <span class="fl">1003</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">poisson_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">935</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_lasso.html">fastcpd.lasso</a></span><span class="op">(</span><span class="va">lasso_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">79</span>, <span class="fl">199</span>, <span class="fl">320</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">lasso_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">200</span>, <span class="fl">321</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_ar.html">fastcpd.ar</a></span><span class="op">(</span><span class="va">ar_data</span>, <span class="fl">3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">614</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">ar_data</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">segmented</span><span class="fu">::</span><span class="fu">segmented</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>      <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ar_data</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    seg.Z <span class="op">=</span> <span class="op">~</span> <span class="va">x</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">690</span><span class="op">)</span>, ignore_attr <span class="op">=</span> <span class="cn">TRUE</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">mcp</span><span class="fu">::</span><span class="fu">mcp</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/ar.html" class="external-link">ar</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/ar.html" class="external-link">ar</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ar_data</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"mcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_garch.html">fastcpd.garch</a></span><span class="op">(</span><span class="va">garch_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">759</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">garch_data</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">garch_data</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">759</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">x</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">garch_data</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span>, <span class="cn">NA</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_var.html">fastcpd.var</a></span><span class="op">(</span><span class="va">var_data</span>, <span class="fl">2</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"VARDetect"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">VARDetect</span><span class="fu">::</span><span class="fu">tbss</span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span><span class="op">$</span><span class="va">cp</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"VARDetect"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"VARDetect"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">501</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">well_log</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="va"><a href="../reference/well_log.html">well_log</a></span></span>
<span><span class="va">well_log</span> <span class="op">&lt;-</span> <span class="va">well_log</span><span class="op">[</span><span class="va">well_log</span> <span class="op">&gt;</span> <span class="fl">1e5</span><span class="op">]</span></span>
<span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  fastcpd <span class="op">=</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">well_log</span>, trim <span class="op">=</span> <span class="fl">0.003</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span>,</span>
<span>  changepoint <span class="op">=</span> <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpts</span><span class="op">(</span><span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.mean</span><span class="op">(</span><span class="va">well_log</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html" class="external-link">mad</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"PELT"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  CptNonPar <span class="op">=</span></span>
<span>    <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">well_log</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  strucchange <span class="op">=</span> <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span></span>
<span>    <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">well_log</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span>,</span>
<span>  ecp <span class="op">=</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span>,</span>
<span>  breakfast <span class="op">=</span> <span class="fu">breakfast</span><span class="fu">::</span><span class="fu">breakfast</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">$</span><span class="va">cptmodel.list</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  wbs <span class="op">=</span> <span class="fu">wbs</span><span class="fu">::</span><span class="fu">wbs</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">$</span><span class="va">cpt</span><span class="op">$</span><span class="va">cpt.ic</span><span class="op">$</span><span class="va">mbic.penalty</span>,</span>
<span>  mosum <span class="op">=</span> <span class="fu">mosum</span><span class="fu">::</span><span class="fu">mosum</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">$</span><span class="va">cpts.info</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  <span class="co"># fpop = fpop::Fpop(well_log, length(well_log))$t.est,  # meaningless</span></span>
<span>  gfpop <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">gfpop</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">well_log</span>,</span>
<span>    mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">graph</span><span class="op">(</span></span>
<span>      penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">sdDiff</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">changepoints</span>,</span>
<span>  jointseg <span class="op">=</span> <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">well_log</span>, K <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span>,</span>
<span>  stepR <span class="op">=</span> <span class="fu">stepR</span><span class="fu">::</span><span class="fu">stepFit</span><span class="op">(</span><span class="va">well_log</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">$</span><span class="va">rightEnd</span></span>
<span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">package_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">package_index</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">package_list</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">package</span> <span class="op">&lt;-</span> <span class="va">package_list</span><span class="op">[[</span><span class="va">package_index</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="va">comparison_table</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      change_point <span class="op">=</span> <span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">package</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      package <span class="op">=</span> <span class="va">package</span>,</span>
<span>      y_offset <span class="op">=</span> <span class="op">(</span><span class="va">package_index</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1000</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">comparison_table</span><span class="op">$</span><span class="va">change_point</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">[</span><span class="va">most_selected</span> <span class="op">&gt;=</span> <span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.5</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="op">(</span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="va">most_selected</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span></span>
<span>      xintercept <span class="op">=</span> <span class="va">most_selected</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>      linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fl">0.2</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">comparison_table</span>,</span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">change_point</span>, y <span class="op">=</span> <span class="fl">50000</span> <span class="op">+</span> <span class="va">y_offset</span>, color <span class="op">=</span> <span class="va">package</span><span class="op">)</span>,</span>
<span>      shape <span class="op">=</span> <span class="fl">17</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">1.9</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">comparison_table</span>,</span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">50000</span> <span class="op">+</span> <span class="va">y_offset</span>, color <span class="op">=</span> <span class="va">package</span><span class="op">)</span>,</span>
<span>      linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fl">0.1</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span></span>
<span>      ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50000</span> <span class="op">-</span> <span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>      xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">+</span> <span class="fl">200</span><span class="op">)</span>,</span>
<span>      expand <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      panel.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.border <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>      panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"microbenchmark"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu">microbenchmark</span><span class="op">(</span></span>
<span>  fastcpd <span class="op">=</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">well_log</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span>, cp_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  changepoint <span class="op">=</span> <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.mean</span><span class="op">(</span><span class="va">well_log</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/mad.html" class="external-link">mad</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"PELT"</span><span class="op">)</span>,</span>
<span>  <span class="co"># CptNonPar = CptNonPar::np.mojo(well_log, G = floor(length(well_log) / 6)),</span></span>
<span>  <span class="co"># strucchange = strucchange::breakpoints(y ~ 1, data = data.frame(y = well_log)),</span></span>
<span>  <span class="co"># ecp = ecp::e.divisive(matrix(well_log)),</span></span>
<span>  <span class="co"># breakfast = breakfast::breakfast(well_log),</span></span>
<span>  wbs <span class="op">=</span> <span class="fu">wbs</span><span class="fu">::</span><span class="fu">wbs</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>,</span>
<span>  mosum <span class="op">=</span> <span class="fu">mosum</span><span class="fu">::</span><span class="fu">mosum</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span>,</span>
<span>  fpop <span class="op">=</span> <span class="fu">fpop</span><span class="fu">::</span><span class="fu">Fpop</span><span class="op">(</span><span class="va">well_log</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  gfpop <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">gfpop</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">well_log</span>,</span>
<span>    mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">graph</span><span class="op">(</span></span>
<span>      penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">sdDiff</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  jointseg <span class="op">=</span> <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">well_log</span>, K <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>  stepR <span class="op">=</span> <span class="fu">stepR</span><span class="fu">::</span><span class="fu">stepFit</span><span class="op">(</span><span class="va">well_log</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  not <span class="op">=</span> <span class="fu">not</span><span class="fu">::</span><span class="fu">not</span><span class="op">(</span><span class="va">well_log</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMean"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"microbenchmark"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"microbenchmark"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"microbenchmark"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"comparison-packages-results.RData"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">results</span>, file <span class="op">=</span> <span class="st">"comparison-packages-results.RData"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.xingchi.li" class="external-link">Xingchi Li</a>, <a href="https://zhangxiany-tamu.github.io" class="external-link">Xianyang Zhang</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
