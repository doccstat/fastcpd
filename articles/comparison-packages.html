<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Speed and result comparison with other R packages.
">
<title>Comparison with other R packages â€¢ fastcpd</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Comparison with other R packages">
<meta property="og:description" content="Speed and result comparison with other R packages.
">
<meta property="og:image" content="https://fastcpd.xingchi.li/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fastcpd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.14.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/examples-advanced.html">Advanced examples</a>
    <a class="dropdown-item" href="../articles/examples-custom-model.html">Custom logistic regression model</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Comparison</h6>
    <a class="dropdown-item" href="../articles/comparison-packages.html">Comparison with other R packages</a>
    <a class="dropdown-item" href="../articles/comparison-pelt.html">Comparison with vanilla PELT</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/doccstat/fastcpd/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Comparison with other R packages</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/doccstat/fastcpd/blob/HEAD/vignettes/comparison-packages.Rmd" class="external-link"><code>vignettes/comparison-packages.Rmd</code></a></small>
      <div class="d-none name"><code>comparison-packages.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="data-setup">Data setup<a class="anchor" aria-label="anchor" href="#data-setup"></a>
</h2>
<div class="section level3">
<h3 id="univariate-mean-change">Univariate mean change<a class="anchor" aria-label="anchor" href="#univariate-mean-change"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Univariate mean change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">mean_data_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/data-setup-univariate-mean-change-1.png" alt="plot of chunk data-setup-univariate-mean-change"><div class="figcaption">plot of chunk
data-setup-univariate-mean-change</div>
</div>
</div>
<div class="section level3">
<h3 id="univariate-mean-andor-variance-change">Univariate mean and/or variance change<a class="anchor" aria-label="anchor" href="#univariate-mean-andor-variance-change"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Univariate mean and/or variance change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">mv_data_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/data-setup-univariate-mean-and-or-variance-change-1.png" alt="plot of chunk data-setup-univariate-mean-and-or-variance-change"><div class="figcaption">plot of chunk
data-setup-univariate-mean-and-or-variance-change</div>
</div>
</div>
<div class="section level3">
<h3 id="multivariate-mean-change">Multivariate mean change<a class="anchor" aria-label="anchor" href="#multivariate-mean-change"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multivariate mean change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">mean_data_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/data-setup-multivariate-mean-change-1.png" alt="plot of chunk data-setup-multivariate-mean-change"><div class="figcaption">plot of chunk
data-setup-multivariate-mean-change</div>
</div>
</div>
<div class="section level3">
<h3 id="multivariate-mean-andor-variance-change">Multivariate mean and/or variance change<a class="anchor" aria-label="anchor" href="#multivariate-mean-andor-variance-change"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multivariate mean and/or variance change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">mv_data_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/data-setup-multivariate-mean-and-or-variance-change-1.png" alt="plot of chunk data-setup-multivariate-mean-and-or-variance-change"><div class="figcaption">plot of chunk
data-setup-multivariate-mean-and-or-variance-change</div>
</div>
</div>
<div class="section level3">
<h3 id="linear-regression">Linear regression<a class="anchor" aria-label="anchor" href="#linear-regression"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Linear regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3.2</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">2.5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">101</span><span class="op">:</span><span class="fl">200</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">201</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">lm_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">lm_data</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/data-setup-linear-regression-1.png" alt="plot of chunk data-setup-linear-regression"><div class="figcaption">plot of chunk data-setup-linear-regression</div>
</div>
</div>
<div class="section level3">
<h3 id="logistic-regression">Logistic regression<a class="anchor" aria-label="anchor" href="#logistic-regression"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Logistic regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">300</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="fl">301</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">binomial_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">binomial_data</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/data-setup-logistic-regression-1.png" alt="plot of chunk data-setup-logistic-regression"><div class="figcaption">plot of chunk
data-setup-logistic-regression</div>
</div>
</div>
<div class="section level3">
<h3 id="poisson-regression">Poisson regression<a class="anchor" aria-label="anchor" href="#poisson-regression"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Poisson regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1100</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.3</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">501</span><span class="op">:</span><span class="fl">800</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">theta_0</span> <span class="op">+</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">801</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1001</span><span class="op">:</span><span class="fl">1100</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">theta_0</span> <span class="op">-</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">poisson_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">poisson_data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/data-setup-poisson-regression-1.png" alt="plot of chunk data-setup-poisson-regression"><div class="figcaption">plot of chunk
data-setup-poisson-regression</div>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">poisson_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/data-setup-poisson-regression-2.png" alt="plot of chunk data-setup-poisson-regression"><div class="figcaption">plot of chunk
data-setup-poisson-regression</div>
</div>
</div>
<div class="section level3">
<h3 id="lasso">Lasso<a class="anchor" aria-label="anchor" href="#lasso"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Lasso</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">480</span></span>
<span><span class="va">p_true</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, ncol <span class="op">=</span> <span class="va">p</span> <span class="op">-</span> <span class="va">p_true</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">80</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">81</span><span class="op">:</span><span class="fl">200</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">201</span><span class="op">:</span><span class="fl">320</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">321</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">4</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">160</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">lasso_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">lasso_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">p_true</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/data-setup-lasso-1.png" alt="plot of chunk data-setup-lasso"><div class="figcaption">plot of chunk data-setup-lasso</div>
</div>
</div>
<div class="section level3">
<h3 id="ar3">AR(3)<a class="anchor" aria-label="anchor" href="#ar3"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># AR(3)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">600</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">601</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">ar_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/data-setup-ar3-1.png" alt="plot of chunk data-setup-ar3"><div class="figcaption">plot of chunk data-setup-ar3</div>
</div>
</div>
<div class="section level3">
<h3 id="garch1-1">GARCH(1, 1)<a class="anchor" aria-label="anchor" href="#garch1-1"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># GARCH(1, 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">400</span></span>
<span><span class="va">sigma_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">201</span><span class="op">:</span><span class="fl">400</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">garch_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">garch_data</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/data-setup-garch11-1.png" alt="plot of chunk data-setup-garch11"><div class="figcaption">plot of chunk data-setup-garch11</div>
</div>
</div>
<div class="section level3">
<h3 id="var2">VAR(2)<a class="anchor" aria-label="anchor" href="#var2"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># VAR(2)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">800</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">theta_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">theta_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">2</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta_1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>, <span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">501</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta_2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>, <span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">var_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/data-setup-var2-1.png" alt="plot of chunk data-setup-var2"><div class="figcaption">plot of chunk data-setup-var2</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="univariate-mean-change-1">Univariate mean change<a class="anchor" aria-label="anchor" href="#univariate-mean-change-1"></a>
</h2>
<p>The true change points are 300 and 700. Some methods are plotted due
to the un-retrievable change points.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">mean_data_1</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">mean_data_1</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]    1  301  701 1001</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.mean</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">@</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  300 1000</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"breakfast"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">breakfast</span><span class="fu">::</span><span class="fu">breakfast</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">cptmodel.list</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"breakfast"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"wbs"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">wbs</span><span class="fu">::</span><span class="fu">wbs</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">cpt</span><span class="op">$</span><span class="va">cpt.ic</span><span class="op">$</span><span class="va">mbic.penalty</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"wbs"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mosum"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">mosum</span><span class="fu">::</span><span class="fu">mosum</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">$</span><span class="va">cpts.info</span><span class="op">$</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mosum"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fpop"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fpop</span><span class="fu">::</span><span class="fu">Fpop</span><span class="op">(</span><span class="va">mean_data_1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">t.est</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fpop"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  300  700 1000</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"gfpop"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">gfpop</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">mean_data_1</span>,</span>
<span>    mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">graph</span><span class="op">(</span></span>
<span>      penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">sdDiff</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">changepoints</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"gfpop"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  300  700 1000</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">inspect</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">compute.threshold</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">mean_data_1</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu">beast</span><span class="op">(</span></span>
<span>    <span class="va">mean_data_1</span>, season <span class="op">=</span> <span class="st">"none"</span>, print.progress <span class="op">=</span> <span class="cn">FALSE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] 701 301 NaN NaN NaN NaN NaN NaN NaN NaN</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"stepR"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">stepR</span><span class="fu">::</span><span class="fu">stepFit</span><span class="op">(</span><span class="va">mean_data_1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">$</span><span class="va">rightEnd</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"stepR"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  300  700 1000</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">cpm</span><span class="fu">::</span><span class="fu">processStream</span><span class="op">(</span><span class="va">mean_data_1</span>, cpmType <span class="op">=</span> <span class="st">"Student"</span><span class="op">)</span><span class="op">$</span><span class="va">changePoints</span></span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 299 699</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">segmented</span><span class="fu">::</span><span class="fu">stepmented</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, npsi <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; psi1.index psi2.index </span></span>
<span><span class="co">#&gt;   298.1981   699.1524</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">mcp</span><span class="fu">::</span><span class="fu">mcp</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_1</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"mcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="figure/univariate-mean-change-mcp-result-1.png" alt="plot of chunk univariate-mean-change-mcp-result"><div class="figcaption">plot of chunk
univariate-mean-change-mcp-result</div>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">not</span><span class="fu">::</span><span class="fu">not</span><span class="op">(</span><span class="va">mean_data_1</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMean"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"not"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="figure/univariate-mean-change-not-result-1.png" alt="plot of chunk univariate-mean-change-not-result"><div class="figcaption">plot of chunk
univariate-mean-change-not-result</div>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">bcp</span><span class="fu">::</span><span class="fu">bcp</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"bcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="figure/univariate-mean-change-bcp-result-1.png" alt="plot of chunk univariate-mean-change-bcp-result"><div class="figcaption">plot of chunk
univariate-mean-change-bcp-result</div>
</div>
</div>
<div class="section level2">
<h2 id="univariate-mean-andor-variance-change-1">Univariate mean and/or variance change<a class="anchor" aria-label="anchor" href="#univariate-mean-andor-variance-change-1"></a>
</h2>
<p>The true change points are 300, 700, 1000, 1300 and 1700. Some
methods are plotted due to the un-retrievable change points.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_meanvariance.html">fastcpd.mv</a></span><span class="op">(</span><span class="va">mv_data_1</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  300  700 1001 1300 1700</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]    1  301  701 1001 1301 1701 2001</span></span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.meanvar</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">@</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  300 2000</span></span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">mv_data_1</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  333  700 1300</span></span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">cpm</span><span class="fu">::</span><span class="fu">processStream</span><span class="op">(</span><span class="va">mv_data_1</span>, cpmType <span class="op">=</span> <span class="st">"GLR"</span><span class="op">)</span><span class="op">$</span><span class="va">changePoints</span></span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1]  293  300  403  408  618  621  696 1000 1021 1024 1293 1300 1417 1693 1700</span></span>
<span><span class="co">#&gt; [16] 1981</span></span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">inspect</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">compute.threshold</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;   [1]  300  700  701  702  704  707  708  712  715  716  717  718  721  722  723</span></span>
<span><span class="co">#&gt;  [16]  726  727  729  731  732  734  736  740  742  744  746  748  750  753  755</span></span>
<span><span class="co">#&gt;  [31]  756  757  759  760  762  764  765  766  768  769  771  772  774  776  777</span></span>
<span><span class="co">#&gt;  [46]  784  785  786  789  791  792  794  797  798  799  801  802  803  807  809</span></span>
<span><span class="co">#&gt;  [61]  810  813  815  817  819  826  827  828  829  831  833  835  836  837  838</span></span>
<span><span class="co">#&gt;  [76]  840  841  842  843  845  848  849  852  854  860  862  864  866  868  870</span></span>
<span><span class="co">#&gt;  [91]  872  875  879  881  884  886  887  888  889  896  897  898  899  901  903</span></span>
<span><span class="co">#&gt; [106]  904  905  906  909  910  912  913  915  917  919  921  922  923  925  927</span></span>
<span><span class="co">#&gt; [121]  928  932  934  936  937  940  944  945  947  948  949  951  956  958  959</span></span>
<span><span class="co">#&gt; [136]  961  962  963  964  966  967  968  972  974  976  978  979  986  988  990</span></span>
<span><span class="co">#&gt; [151]  992  995  998 1000 1300 1700 1702 1703 1704 1705 1708 1710 1712 1714 1716</span></span>
<span><span class="co">#&gt; [166] 1717 1718 1720 1721 1723 1725 1726 1727 1729 1731 1733 1735 1736 1737 1739</span></span>
<span><span class="co">#&gt; [181] 1742 1745 1747 1748 1752 1754 1756 1758 1759 1760 1766 1768 1770 1771 1773</span></span>
<span><span class="co">#&gt; [196] 1775 1778 1782 1784 1785 1790 1792 1793 1795 1796 1797 1799 1800 1802 1803</span></span>
<span><span class="co">#&gt; [211] 1804 1805 1806 1807 1808 1809 1813 1815 1816 1818 1821 1824 1825 1827 1828</span></span>
<span><span class="co">#&gt; [226] 1829 1833 1835 1837 1840 1841 1842 1848 1849 1851 1852 1854 1855 1857 1859</span></span>
<span><span class="co">#&gt; [241] 1860 1862 1863 1865 1867 1868 1876 1878 1879 1880 1882 1883 1884 1886 1887</span></span>
<span><span class="co">#&gt; [256] 1889 1894 1898 1899 1905 1906 1907 1908 1909 1912 1919 1920 1921 1923 1924</span></span>
<span><span class="co">#&gt; [271] 1926 1927 1928 1930 1933 1934 1935 1936 1938 1940 1941 1944 1947 1950 1952</span></span>
<span><span class="co">#&gt; [286] 1954 1955 1956 1960 1962 1963 1965 1966 1967 1969 1970 1974 1976 1977 1978</span></span>
<span><span class="co">#&gt; [301] 1980 1985 1987 1988 1990 1996 1997 1998</span></span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu">beast</span><span class="op">(</span></span>
<span>    <span class="va">mv_data_1</span>, season <span class="op">=</span> <span class="st">"none"</span>, print.progress <span class="op">=</span> <span class="cn">FALSE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span></span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] 1855 1794 1301 1986  301  703 1981 1769 1860  709</span></span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">mcp</span><span class="fu">::</span><span class="fu">mcp</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mv_data_1</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"mcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="figure/univariate-mean-and-or-variance-change-mcp-result-1.png" alt="plot of chunk univariate-mean-and-or-variance-change-mcp-result"><div class="figcaption">plot of chunk
univariate-mean-and-or-variance-change-mcp-result</div>
</div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">not</span><span class="fu">::</span><span class="fu">not</span><span class="op">(</span><span class="va">mv_data_1</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMeanVar"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"not"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="figure/univariate-mean-and-or-variance-change-not-result-1.png" alt="plot of chunk univariate-mean-and-or-variance-change-not-result"><div class="figcaption">plot of chunk
univariate-mean-and-or-variance-change-not-result</div>
</div>
<pre><code><span><span class="co">#&gt; Press [enter] to continue</span></span></code></pre>
<div class="float">
<img src="figure/univariate-mean-and-or-variance-change-not-result-2.png" alt="plot of chunk univariate-mean-and-or-variance-change-not-result"><div class="figcaption">plot of chunk
univariate-mean-and-or-variance-change-not-result</div>
</div>
</div>
<div class="section level2">
<h2 id="multivariate-mean-change-1">Multivariate mean change<a class="anchor" aria-label="anchor" href="#multivariate-mean-change-1"></a>
</h2>
<p>The true change points are 300 and 700. Some methods are plotted due
to the un-retrievable change points.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">mean_data_3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">mean_data_3</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">inspect</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">compute.threshold</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">mean_data_3</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span></span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu">beast123</span><span class="op">(</span></span>
<span>    <span class="va">mean_data_3</span>,</span>
<span>    metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>whichDimIsTime <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    season <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span></span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt;  [1,]  301  701  301</span></span>
<span><span class="co">#&gt;  [2,]  701  301  701</span></span>
<span><span class="co">#&gt;  [3,]  142  117  926</span></span>
<span><span class="co">#&gt;  [4,]  305  NaN  NaN</span></span>
<span><span class="co">#&gt;  [5,]  705  NaN  NaN</span></span>
<span><span class="co">#&gt;  [6,]  694  NaN  NaN</span></span>
<span><span class="co">#&gt;  [7,]  NaN  NaN  NaN</span></span>
<span><span class="co">#&gt;  [8,]  NaN  NaN  NaN</span></span>
<span><span class="co">#&gt;  [9,]  NaN  NaN  NaN</span></span>
<span><span class="co">#&gt; [10,]  NaN  NaN  NaN</span></span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y.1</span>, <span class="va">y.2</span>, <span class="va">y.3</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_3</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 300 700</span></span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]    1  301  701 1001</span></span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">bcp</span><span class="fu">::</span><span class="fu">bcp</span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"bcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="figure/multivariate-mean-change-bcp-result-1.png" alt="plot of chunk multivariate-mean-change-bcp-result"><div class="figcaption">plot of chunk
multivariate-mean-change-bcp-result</div>
</div>
</div>
<div class="section level2">
<h2 id="multivariate-mean-andor-variance-change-1">Multivariate mean and/or variance change<a class="anchor" aria-label="anchor" href="#multivariate-mean-andor-variance-change-1"></a>
</h2>
<p>The true change points are 300, 700, 1000, 1300 and 1700. Some
methods are plotted due to the un-retrievable change points.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_meanvariance.html">fastcpd.mv</a></span><span class="op">(</span><span class="va">mv_data_3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  300  700 1000 1300 1700</span></span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]    1  301  701 1001 1301 1701 2001</span></span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">inspect</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">compute.threshold</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;   [1]  300  700  701  703  705  707  708  709  711  712  714  715  717  718  720</span></span>
<span><span class="co">#&gt;  [16]  721  723  724  726  727  729  731  733  734  736  737  739  740  742  743</span></span>
<span><span class="co">#&gt;  [31]  744  746  747  749  750  752  753  754  755  756  758  760  762  763  765</span></span>
<span><span class="co">#&gt;  [46]  766  767  769  770  772  773  774  775  777  779  780  782  784  786  788</span></span>
<span><span class="co">#&gt;  [61]  790  791  793  795  797  799  801  803  804  806  809  810  811  813  814</span></span>
<span><span class="co">#&gt;  [76]  816  817  818  820  821  823  825  827  828  830  831  833  835  836  837</span></span>
<span><span class="co">#&gt;  [91]  838  840  842  843  845  846  848  849  850  852  853  854  855  856  858</span></span>
<span><span class="co">#&gt; [106]  859  860  862  863  865  866  868  869  871  872  874  876  877  878  879</span></span>
<span><span class="co">#&gt; [121]  881  883  885  887  888  889  891  893  894  895  897  898  900  901  903</span></span>
<span><span class="co">#&gt; [136]  904  906  908  909  911  913  914  916  917  918  920  921  923  924  925</span></span>
<span><span class="co">#&gt; [151]  927  928  929  931  932  934  936  937  938  939  941  942  943  945  946</span></span>
<span><span class="co">#&gt; [166]  947  949  950  952  954  955  956  957  958  959  961  962  964  965  967</span></span>
<span><span class="co">#&gt; [181]  968  970  972  973  974  975  977  979  981  982  984  985  986  987  988</span></span>
<span><span class="co">#&gt; [196]  990  991  992  994  995  997  999 1000 1300 1700 1702 1703 1704 1705 1706</span></span>
<span><span class="co">#&gt; [211] 1708 1709 1710 1712 1713 1714 1715 1717 1719 1721 1722 1723 1725 1727 1729</span></span>
<span><span class="co">#&gt; [226] 1730 1732 1734 1735 1737 1738 1739 1741 1742 1744 1746 1748 1750 1752 1753</span></span>
<span><span class="co">#&gt; [241] 1754 1755 1757 1758 1759 1761 1762 1763 1764 1766 1767 1769 1770 1771 1773</span></span>
<span><span class="co">#&gt; [256] 1774 1775 1777 1779 1781 1782 1783 1785 1786 1788 1789 1791 1793 1794 1796</span></span>
<span><span class="co">#&gt; [271] 1798 1800 1803 1804 1805 1806 1808 1809 1811 1812 1814 1815 1817 1818 1819</span></span>
<span><span class="co">#&gt; [286] 1821 1822 1824 1825 1827 1828 1829 1831 1833 1835 1836 1838 1839 1841 1843</span></span>
<span><span class="co">#&gt; [301] 1844 1846 1847 1848 1850 1851 1853 1854 1856 1857 1858 1859 1860 1862 1863</span></span>
<span><span class="co">#&gt; [316] 1864 1865 1867 1869 1870 1872 1873 1874 1876 1878 1879 1881 1882 1884 1885</span></span>
<span><span class="co">#&gt; [331] 1887 1889 1891 1893 1894 1896 1898 1899 1900 1901 1902 1904 1906 1907 1909</span></span>
<span><span class="co">#&gt; [346] 1911 1913 1914 1916 1917 1918 1919 1921 1923 1924 1925 1927 1928 1930 1932</span></span>
<span><span class="co">#&gt; [361] 1933 1935 1936 1938 1939 1941 1942 1944 1946 1948 1950 1951 1952 1954 1956</span></span>
<span><span class="co">#&gt; [376] 1957 1959 1961 1963 1965 1967 1968 1970 1972 1973 1974 1976 1977 1979 1981</span></span>
<span><span class="co">#&gt; [391] 1982 1984 1985 1987 1989 1990 1992 1993 1995 1996 1998</span></span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu">beast123</span><span class="op">(</span></span>
<span>    <span class="va">mv_data_3</span>,</span>
<span>    metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>whichDimIsTime <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    season <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span></span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt;  [1,]  701 1301  301 1301</span></span>
<span><span class="co">#&gt;  [2,] 1301  301 1301  710</span></span>
<span><span class="co">#&gt;  [3,]  301  701 1829  301</span></span>
<span><span class="co">#&gt;  [4,] 1968 1993  702  886</span></span>
<span><span class="co">#&gt;  [5,] 1994  884 1822 1975</span></span>
<span><span class="co">#&gt;  [6,]  814  755  810 1915</span></span>
<span><span class="co">#&gt;  [7,] 1962  781  845  778</span></span>
<span><span class="co">#&gt;  [8,] 1978  767 1738 1985</span></span>
<span><span class="co">#&gt;  [9,] 1870  747 1754  792</span></span>
<span><span class="co">#&gt; [10,] 1843  722  771  953</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="linear-regression-1">Linear regression<a class="anchor" aria-label="anchor" href="#linear-regression-1"></a>
</h2>
<p>The true change points are 100 and 200.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_lm.html">fastcpd.lm</a></span><span class="op">(</span><span class="va">lm_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  97 201</span></span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">lm_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 100 201</span></span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">segmented</span><span class="fu">::</span><span class="fu">segmented</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>      <span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lm_data</span><span class="op">$</span><span class="va">y</span>, x <span class="op">=</span> <span class="va">lm_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">lm_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    seg.Z <span class="op">=</span> <span class="op">~</span> <span class="va">index</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 233</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="logistic-regression-1">Logistic regression<a class="anchor" aria-label="anchor" href="#logistic-regression-1"></a>
</h2>
<p>The true change point is 300.</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_binomial.html">fastcpd.binomial</a></span><span class="op">(</span><span class="va">binomial_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 302</span></span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">binomial_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 297</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="poisson-regression-1">Poisson regression<a class="anchor" aria-label="anchor" href="#poisson-regression-1"></a>
</h2>
<p>The true change points are 500, 800 and 1000.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_poisson.html">fastcpd.poisson</a></span><span class="op">(</span><span class="va">poisson_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  498  805 1003</span></span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">poisson_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 935</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="lasso-1">Lasso<a class="anchor" aria-label="anchor" href="#lasso-1"></a>
</h2>
<p>The true change points are 80, 200 and 320.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_lasso.html">fastcpd.lasso</a></span><span class="op">(</span><span class="va">lasso_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  79 199 321</span></span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">lasso_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1]  80 200 321</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="ar3-1">AR(3)<a class="anchor" aria-label="anchor" href="#ar3-1"></a>
</h2>
<p>The true change point is 600. Some methods are plotted due to the
un-retrievable change points.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_ar.html">fastcpd.ar</a></span><span class="op">(</span><span class="va">ar_data</span>, <span class="fl">3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 614</span></span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">ar_data</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; numeric(0)</span></span></code></pre></div>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">segmented</span><span class="fu">::</span><span class="fu">segmented</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>      <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ar_data</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    seg.Z <span class="op">=</span> <span class="op">~</span> <span class="va">x</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 690</span></span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">mcp</span><span class="fu">::</span><span class="fu">mcp</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/ar.html" class="external-link">ar</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/ar.html" class="external-link">ar</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ar_data</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"mcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="figure/ar3-mcp-result-1.png" alt="plot of chunk ar3-mcp-result"><div class="figcaption">plot of chunk ar3-mcp-result</div>
</div>
</div>
<div class="section level2">
<h2 id="garch1-1-1">GARCH(1, 1)<a class="anchor" aria-label="anchor" href="#garch1-1-1"></a>
</h2>
<p>The true change point is 200.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_garch.html">fastcpd.garch</a></span><span class="op">(</span><span class="va">garch_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 205</span></span></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">garch_data</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">garch_data</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span></code></pre></div>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 206</span></span></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">x</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">garch_data</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span></code></pre></div>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] NA</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="var2-1">VAR(2)<a class="anchor" aria-label="anchor" href="#var2-1"></a>
</h2>
<p>The true change points is 500.</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_var.html">fastcpd.var</a></span><span class="op">(</span><span class="va">var_data</span>, <span class="fl">2</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 500</span></span></code></pre></div>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"VARDetect"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">VARDetect</span><span class="fu">::</span><span class="fu">tbss</span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span><span class="op">$</span><span class="va">cp</span></span></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"VARDetect"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 501</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="detection-comparison-using-well_log">Detection comparison using <code>well_log</code><a class="anchor" aria-label="anchor" href="#detection-comparison-using-well_log"></a>
</h2>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">well_log</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="va"><a href="../reference/well_log.html">well_log</a></span></span></code></pre></div>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">well_log</span> <span class="op">&lt;-</span> <span class="va">well_log</span><span class="op">[</span><span class="va">well_log</span> <span class="op">&gt;</span> <span class="fl">1e5</span><span class="op">]</span></span>
<span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  fastcpd <span class="op">=</span> <span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">well_log</span>, trim <span class="op">=</span> <span class="fl">0.003</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span>,</span>
<span>  changepoint <span class="op">=</span> <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.mean</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">@</span><span class="va">cpts</span>,</span>
<span>  CptNonPar <span class="op">=</span></span>
<span>    <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">well_log</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  strucchange <span class="op">=</span> <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span></span>
<span>    <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">well_log</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span>,</span>
<span>  ecp <span class="op">=</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span>,</span>
<span>  breakfast <span class="op">=</span> <span class="fu">breakfast</span><span class="fu">::</span><span class="fu">breakfast</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">$</span><span class="va">cptmodel.list</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  wbs <span class="op">=</span> <span class="fu">wbs</span><span class="fu">::</span><span class="fu">wbs</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">$</span><span class="va">cpt</span><span class="op">$</span><span class="va">cpt.ic</span><span class="op">$</span><span class="va">mbic.penalty</span>,</span>
<span>  mosum <span class="op">=</span> <span class="fu">mosum</span><span class="fu">::</span><span class="fu">mosum</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">$</span><span class="va">cpts.info</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  <span class="co"># fpop = fpop::Fpop(well_log, length(well_log))$t.est,  # meaningless</span></span>
<span>  gfpop <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">gfpop</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">well_log</span>,</span>
<span>    mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">graph</span><span class="op">(</span></span>
<span>      penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">sdDiff</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">changepoints</span>,</span>
<span>  InspectChangepoint <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">inspect</span><span class="op">(</span></span>
<span>    <span class="va">well_log</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">compute.threshold</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span>,</span>
<span>  jointseg <span class="op">=</span> <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">well_log</span>, K <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span>,</span>
<span>  Rbeast <span class="op">=</span> <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu">beast</span><span class="op">(</span></span>
<span>    <span class="va">well_log</span>, season <span class="op">=</span> <span class="st">"none"</span>, print.progress <span class="op">=</span> <span class="cn">FALSE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span>,</span>
<span>  stepR <span class="op">=</span> <span class="fu">stepR</span><span class="fu">::</span><span class="fu">stepFit</span><span class="op">(</span><span class="va">well_log</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">$</span><span class="va">rightEnd</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; $fastcpd</span></span>
<span><span class="co">#&gt;  [1]   12  572  704  776 1021 1057 1198 1347 1406 1502 1660 1842 2023 2202 2384</span></span>
<span><span class="co">#&gt; [16] 2445 2507 2567 2749 2926 3094 3107 3509 3622 3709 3820 3976</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $changepoint</span></span>
<span><span class="co">#&gt; [1] 2738 3989</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CptNonPar</span></span>
<span><span class="co">#&gt; [1] 1021 1681 2022 2738</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $strucchange</span></span>
<span><span class="co">#&gt; [1] 1057 1660 2568 3283</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ecp</span></span>
<span><span class="co">#&gt;  [1]    1   33  315  435  567  705  803 1026 1058 1348 1503 1662 1843 2024 2203</span></span>
<span><span class="co">#&gt; [16] 2386 2446 2508 2569 2745 2780 2922 3073 3136 3252 3465 3500 3554 3623 3710</span></span>
<span><span class="co">#&gt; [31] 3821 3868 3990</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $breakfast</span></span>
<span><span class="co">#&gt;  [1]   33  310  434  572  704  779 1021 1057 1347 1502 1659 1842 2021 2032 2202</span></span>
<span><span class="co">#&gt; [16] 2384 2446 2507 2567 2747 2779 2926 3094 3106 3125 3283 3464 3499 3622 3709</span></span>
<span><span class="co">#&gt; [31] 3806 3835 3848 3877 3896 3976</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $wbs</span></span>
<span><span class="co">#&gt;  [1] 2568 1057 1661 1842 2385 2023 2445 1502 2744    6 2507 1021 3709 3820 1402</span></span>
<span><span class="co">#&gt; [16]  434 1408 3131 3976 3509 3622  776 1197 3094  704 3104 1347  314 2921 3251</span></span>
<span><span class="co">#&gt; [31] 3464 3848 3906 2779 1663 3636   60 3904 2202  566   12 3639 1200    7 1671</span></span>
<span><span class="co">#&gt; [46]  706</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mosum</span></span>
<span><span class="co">#&gt;  [1]    6  434  704 1017 1057 1325 1502 1661 1842 2023 2385 2445 2507 2567 2744</span></span>
<span><span class="co">#&gt; [16] 3060 3438 3509 3610 3697 3820 3867 3976</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gfpop</span></span>
<span><span class="co">#&gt;  [1]    6    7    8   12  314  434  556  560  704  776 1021 1057 1197 1200 1347</span></span>
<span><span class="co">#&gt; [16] 1364 1405 1407 1491 1502 1661 1842 2023 2385 2445 2507 2567 2664 2747 2752</span></span>
<span><span class="co">#&gt; [31] 2921 3094 3104 3125 3251 3464 3499 3622 3709 3820 3976 3989</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $InspectChangepoint</span></span>
<span><span class="co">#&gt;  [1]    6    8   15   71  314  434  521  704  706  776  830 1021 1057 1059 1347</span></span>
<span><span class="co">#&gt; [16] 1402 1405 1408 1412 1502 1520 1659 1661 1663 1694 1842 1848 2022 2202 2384</span></span>
<span><span class="co">#&gt; [31] 2387 2445 2507 2567 2568 2673 2738 2746 2752 2779 2921 3131 3251 3464 3509</span></span>
<span><span class="co">#&gt; [46] 3609 3658 3709 3806 3976</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $jointseg</span></span>
<span><span class="co">#&gt;  [1]    6 1021 1057 1502 1661 1842 2022 2384 2445 2507 2568 2738</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Rbeast</span></span>
<span><span class="co">#&gt;  [1] 1058 1662    7 1022 2447 2386 2023 1503 2745 3710</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $stepR</span></span>
<span><span class="co">#&gt;  [1]    7   14  314  434  566  704  776 1021 1057 1197 1200 1347 1405 1407 1502</span></span>
<span><span class="co">#&gt; [16] 1661 1694 1842 2023 2202 2385 2445 2507 2567 2747 2752 2921 3094 3104 3125</span></span>
<span><span class="co">#&gt; [31] 3251 3464 3499 3609 3658 3709 3820 3867 3905 3976 3989</span></span></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">package_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">package_index</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">package_list</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">package</span> <span class="op">&lt;-</span> <span class="va">package_list</span><span class="op">[[</span><span class="va">package_index</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="va">comparison_table</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      change_point <span class="op">=</span> <span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">package</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      package <span class="op">=</span> <span class="va">package</span>,</span>
<span>      y_offset <span class="op">=</span> <span class="op">(</span><span class="va">package_index</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1000</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">comparison_table</span><span class="op">$</span><span class="va">change_point</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">[</span><span class="va">most_selected</span> <span class="op">&gt;=</span> <span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.5</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="op">(</span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="va">most_selected</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1]    6.5  314.0  434.0  704.0  776.0 1021.0 1057.0 1347.0 1502.0 1661.0</span></span>
<span><span class="co">#&gt; [11] 1842.0 2023.0 2202.0 2384.5 2445.0 2507.0 2567.5 2738.0 2921.0 3094.0</span></span>
<span><span class="co">#&gt; [21] 3251.0 3464.0 3509.0 3622.0 3709.0 3820.0 3976.0</span></span></code></pre></div>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span></span>
<span>      xintercept <span class="op">=</span> <span class="va">most_selected</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>      linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fl">0.2</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">comparison_table</span>,</span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">change_point</span>, y <span class="op">=</span> <span class="fl">50000</span> <span class="op">+</span> <span class="va">y_offset</span>, color <span class="op">=</span> <span class="va">package</span><span class="op">)</span>,</span>
<span>      shape <span class="op">=</span> <span class="fl">17</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">1.9</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">comparison_table</span>,</span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">50000</span> <span class="op">+</span> <span class="va">y_offset</span>, color <span class="op">=</span> <span class="va">package</span><span class="op">)</span>,</span>
<span>      linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fl">0.1</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span></span>
<span>      ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50000</span> <span class="op">-</span> <span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>      xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">+</span> <span class="fl">200</span><span class="op">)</span>,</span>
<span>      expand <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      panel.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.border <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>      panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="figure/detection-comparison-well-log-plot-1.png" alt="plot of chunk detection-comparison-well-log-plot"><div class="figcaption">plot of chunk
detection-comparison-well-log-plot</div>
</div>
</div>
<div class="section level2">
<h2 id="time-comparison-using-well_log">Time comparison using <code>well_log</code><a class="anchor" aria-label="anchor" href="#time-comparison-using-well_log"></a>
</h2>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"microbenchmark"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu">microbenchmark</span><span class="op">(</span></span>
<span>  fastcpd <span class="op">=</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">well_log</span>, trim <span class="op">=</span> <span class="fl">0.003</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  changepoint <span class="op">=</span> <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.mean</span><span class="op">(</span><span class="va">well_log</span>, method <span class="op">=</span> <span class="st">"PELT"</span><span class="op">)</span>,</span>
<span>  CptNonPar <span class="op">=</span> <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">well_log</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  strucchange <span class="op">=</span></span>
<span>    <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ecp <span class="op">=</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  breakfast <span class="op">=</span> <span class="fu">breakfast</span><span class="fu">::</span><span class="fu">breakfast</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>,</span>
<span>  wbs <span class="op">=</span> <span class="fu">wbs</span><span class="fu">::</span><span class="fu">wbs</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>,</span>
<span>  mosum <span class="op">=</span> <span class="fu">mosum</span><span class="fu">::</span><span class="fu">mosum</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span>,</span>
<span>  fpop <span class="op">=</span> <span class="fu">fpop</span><span class="fu">::</span><span class="fu">Fpop</span><span class="op">(</span><span class="va">well_log</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  gfpop <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">gfpop</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">well_log</span>,</span>
<span>    mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">graph</span><span class="op">(</span></span>
<span>      penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">sdDiff</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  InspectChangepoint <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">inspect</span><span class="op">(</span></span>
<span>    <span class="va">well_log</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">compute.threshold</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  jointseg <span class="op">=</span> <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">well_log</span>, K <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>  Rbeast <span class="op">=</span> <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu">beast</span><span class="op">(</span></span>
<span>    <span class="va">well_log</span>, season <span class="op">=</span> <span class="st">"none"</span>, print.progress <span class="op">=</span> <span class="cn">FALSE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  stepR <span class="op">=</span> <span class="fu">stepR</span><span class="fu">::</span><span class="fu">stepFit</span><span class="op">(</span><span class="va">well_log</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  not <span class="op">=</span> <span class="fu">not</span><span class="fu">::</span><span class="fu">not</span><span class="op">(</span><span class="va">well_log</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMean"</span><span class="op">)</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">[[</span><span class="st">"microbenchmark"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; Unit: milliseconds</span></span>
<span><span class="co">#&gt;                expr          min           lq         mean       median</span></span>
<span><span class="co">#&gt;             fastcpd 6.257120e+01 6.696175e+01 7.183964e+01 7.168669e+01</span></span>
<span><span class="co">#&gt;         changepoint 3.205076e+01 3.305076e+01 4.025595e+01 3.774400e+01</span></span>
<span><span class="co">#&gt;           CptNonPar 1.875995e+04 2.014073e+04 2.244910e+04 2.224506e+04</span></span>
<span><span class="co">#&gt;         strucchange 6.359889e+04 6.409690e+04 6.651444e+04 6.565439e+04</span></span>
<span><span class="co">#&gt;                 ecp 7.505232e+05 7.895889e+05 8.168647e+05 8.170952e+05</span></span>
<span><span class="co">#&gt;           breakfast 9.606171e+03 9.819381e+03 1.052611e+04 1.048197e+04</span></span>
<span><span class="co">#&gt;                 wbs 1.163237e+02 1.180537e+02 1.263443e+02 1.254133e+02</span></span>
<span><span class="co">#&gt;               mosum 1.059973e+00 1.147898e+00 2.175931e+00 1.409396e+00</span></span>
<span><span class="co">#&gt;                fpop 2.604002e+00 3.676689e+00 4.859312e+00 4.308841e+00</span></span>
<span><span class="co">#&gt;               gfpop 6.057383e+01 6.595090e+01 7.277643e+01 7.212125e+01</span></span>
<span><span class="co">#&gt;  InspectChangepoint 1.584727e+02 2.171007e+02 2.414921e+02 2.424665e+02</span></span>
<span><span class="co">#&gt;            jointseg 2.104403e+01 2.284920e+01 3.577861e+01 2.708083e+01</span></span>
<span><span class="co">#&gt;              Rbeast 6.545716e+02 6.913542e+02 7.993305e+02 7.504324e+02</span></span>
<span><span class="co">#&gt;               stepR 2.740003e+01 3.020269e+01 3.149624e+01 3.188329e+01</span></span>
<span><span class="co">#&gt;                 not 9.715867e+01 1.000287e+02 1.101258e+02 1.074475e+02</span></span>
<span><span class="co">#&gt;            uq          max neval</span></span>
<span><span class="co">#&gt;  7.689381e+01 8.332375e+01    10</span></span>
<span><span class="co">#&gt;  4.669485e+01 5.904173e+01    10</span></span>
<span><span class="co">#&gt;  2.380236e+04 2.705807e+04    10</span></span>
<span><span class="co">#&gt;  6.597650e+04 7.757488e+04    10</span></span>
<span><span class="co">#&gt;  8.259550e+05 8.834288e+05    10</span></span>
<span><span class="co">#&gt;  1.103289e+04 1.197235e+04    10</span></span>
<span><span class="co">#&gt;  1.276892e+02 1.455261e+02    10</span></span>
<span><span class="co">#&gt;  1.957312e+00 8.705062e+00    10</span></span>
<span><span class="co">#&gt;  5.107175e+00 1.085365e+01    10</span></span>
<span><span class="co">#&gt;  7.742432e+01 8.794816e+01    10</span></span>
<span><span class="co">#&gt;  3.060519e+02 3.145695e+02    10</span></span>
<span><span class="co">#&gt;  4.362760e+01 9.516090e+01    10</span></span>
<span><span class="co">#&gt;  8.539695e+02 1.163607e+03    10</span></span>
<span><span class="co">#&gt;  3.294534e+01 3.530981e+01    10</span></span>
<span><span class="co">#&gt;  1.147504e+02 1.331989e+02    10</span></span></code></pre></div>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"microbenchmark"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"microbenchmark"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="float">
<img src="figure/time-comparison-well-log-plot-1.png" alt="plot of chunk time-comparison-well-log-plot"><div class="figcaption">plot of chunk
time-comparison-well-log-plot</div>
</div>
</div>
<div class="section level2">
<h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h2>
<p>This document is generated by the following code:</p>
<pre class="shell"><code>R -e 'knitr::knit("vignettes/comparison-packages.Rmd.original", output = "vignettes/comparison-packages.Rmd")' &amp;&amp; rm -rf vignettes/figure &amp;&amp; mv -f figure vignettes</code></pre>
</div>
<div class="section level2">
<h2 id="related-issues">Related issues<a class="anchor" aria-label="anchor" href="#related-issues"></a>
</h2>
<ul>
<li>
<code>mosum</code>: [<a href="https://github.com/doccstat/fastcpd/issues/4" class="external-link">#4</a>].</li>
<li>
<code>mcp</code>: <a href="https://github.com/doccstat/fastcpd/actions/runs/7272426093/job/19814531091" class="external-link">link
1</a> and <a href="https://github.com/doccstat/fastcpd/actions/runs/7272426093/job/19814531284" class="external-link">link
2</a>.</li>
<li>
<code>bcp</code>: [<a href="https://github.com/doccstat/fastcpd/issues/5" class="external-link">#5</a>].</li>
<li>
<code>gfpop</code>: [<a href="https://github.com/doccstat/fastcpd/issues/10" class="external-link">#10</a>].</li>
</ul>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
<ul>
<li>
<a href="https://www.unipa.it/persone/docenti/m/vito.muggeo" class="external-link">Dr.Â Vito
Muggeo</a>, author of the <code>segmented</code> package for the tips
about the piece-wise constant function.</li>
</ul>
</div>
<div class="section level2">
<h2 id="appendix-all-code-snippets">Appendix: all code snippets<a class="anchor" aria-label="anchor" href="#appendix-all-code-snippets"></a>
</h2>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span></span>
<span>  collapse <span class="op">=</span> <span class="cn">TRUE</span>, comment <span class="op">=</span> <span class="st">"#&gt;"</span>, eval <span class="op">=</span> <span class="cn">TRUE</span>, cache <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  warning <span class="op">=</span> <span class="cn">FALSE</span>, fig.width <span class="op">=</span> <span class="fl">8</span>, fig.height <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"microbenchmark"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"comparison-packages-results.RData"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Available at https://pcloud.xingchi.li/comparison-packages-results.RData</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"comparison-packages-results.RData"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Univariate mean change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">mean_data_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span></span>
<span><span class="co"># Univariate mean and/or variance change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">mv_data_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span></span>
<span><span class="co"># Multivariate mean change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">mean_data_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">50</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span></span>
<span><span class="co"># Multivariate mean and/or variance change</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">mv_data_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">400</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">p</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span></span>
<span><span class="co"># Linear regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3.2</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">2.5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">101</span><span class="op">:</span><span class="fl">200</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">201</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">lm_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">lm_data</span><span class="op">)</span></span>
<span><span class="co"># Logistic regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">300</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="fl">301</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">binomial_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">binomial_data</span><span class="op">)</span></span>
<span><span class="co"># Poisson regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1100</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.3</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">501</span><span class="op">:</span><span class="fl">800</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">theta_0</span> <span class="op">+</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">801</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1001</span><span class="op">:</span><span class="fl">1100</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">theta_0</span> <span class="op">-</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">poisson_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">poisson_data</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">poisson_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># Lasso</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">480</span></span>
<span><span class="va">p_true</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">5</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">p_true</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">theta_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">theta_0</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, ncol <span class="op">=</span> <span class="va">p</span> <span class="op">-</span> <span class="va">p_true</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">80</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">81</span><span class="op">:</span><span class="fl">200</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">201</span><span class="op">:</span><span class="fl">320</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">120</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="va">x</span><span class="op">[</span><span class="fl">321</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta_0</span><span class="op">[</span><span class="fl">4</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">160</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">lasso_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">lasso_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">p_true</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># AR(3)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">600</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.6</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">601</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">ar_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span></span>
<span><span class="co"># GARCH(1, 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">400</span></span>
<span><span class="va">sigma_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">201</span><span class="op">:</span><span class="fl">400</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sigma_2</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">garch_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">garch_data</span><span class="op">)</span></span>
<span><span class="co"># VAR(2)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">800</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">theta_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.6</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">theta_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.2</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">+</span> <span class="fl">2</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta_1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>, <span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">501</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">2</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta_2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span>, <span class="op">]</span>, <span class="va">x</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">var_data</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/plot.ts.html" class="external-link">plot.ts</a></span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">mean_data_1</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">mean_data_1</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">301</span>, <span class="fl">701</span>, <span class="fl">1001</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.mean</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">@</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">1000</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"breakfast"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">breakfast</span><span class="fu">::</span><span class="fu">breakfast</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">cptmodel.list</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"breakfast"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"breakfast"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"wbs"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">wbs</span><span class="fu">::</span><span class="fu">wbs</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">cpt</span><span class="op">$</span><span class="va">cpt.ic</span><span class="op">$</span><span class="va">mbic.penalty</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"wbs"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"wbs"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mosum"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">mosum</span><span class="fu">::</span><span class="fu">mosum</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">$</span><span class="va">cpts.info</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mosum"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mosum"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fpop"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fpop</span><span class="fu">::</span><span class="fu">Fpop</span><span class="op">(</span><span class="va">mean_data_1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">t.est</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fpop"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fpop"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span>, <span class="fl">1000</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"gfpop"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">gfpop</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">mean_data_1</span>,</span>
<span>    mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">graph</span><span class="op">(</span></span>
<span>      penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">sdDiff</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">changepoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"gfpop"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"gfpop"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span>, <span class="fl">1000</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">inspect</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">compute.threshold</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">mean_data_1</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu">beast</span><span class="op">(</span></span>
<span>    <span class="va">mean_data_1</span>, season <span class="op">=</span> <span class="st">"none"</span>, print.progress <span class="op">=</span> <span class="cn">FALSE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">701</span>, <span class="fl">301</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"stepR"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">stepR</span><span class="fu">::</span><span class="fu">stepFit</span><span class="op">(</span><span class="va">mean_data_1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">$</span><span class="va">rightEnd</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"stepR"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"stepR"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span>, <span class="fl">1000</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">cpm</span><span class="fu">::</span><span class="fu">processStream</span><span class="op">(</span><span class="va">mean_data_1</span>, cpmType <span class="op">=</span> <span class="st">"Student"</span><span class="op">)</span><span class="op">$</span><span class="va">changePoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">299</span>, <span class="fl">699</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">segmented</span><span class="fu">::</span><span class="fu">stepmented</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span>, npsi <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">298</span>, <span class="fl">699</span><span class="op">)</span>, ignore_attr <span class="op">=</span> <span class="cn">TRUE</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">mcp</span><span class="fu">::</span><span class="fu">mcp</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_1</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"mcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">not</span><span class="fu">::</span><span class="fu">not</span><span class="op">(</span><span class="va">mean_data_1</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMean"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"not"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">bcp</span><span class="fu">::</span><span class="fu">bcp</span><span class="op">(</span><span class="va">mean_data_1</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"bcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_meanvariance.html">fastcpd.mv</a></span><span class="op">(</span><span class="va">mv_data_1</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span>, <span class="fl">1001</span>, <span class="fl">1300</span>, <span class="fl">1700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">301</span>, <span class="fl">701</span>, <span class="fl">1001</span>, <span class="fl">1301</span>, <span class="fl">1701</span>, <span class="fl">2001</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.meanvar</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">@</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"changepoint"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">2000</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">mv_data_1</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">333</span>, <span class="fl">700</span>, <span class="fl">1300</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">cpm</span><span class="fu">::</span><span class="fu">processStream</span><span class="op">(</span><span class="va">mv_data_1</span>, cpmType <span class="op">=</span> <span class="st">"GLR"</span><span class="op">)</span><span class="op">$</span><span class="va">changePoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"cpm"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">293</span>, <span class="fl">300</span>, <span class="fl">403</span>, <span class="fl">408</span>, <span class="fl">618</span>, <span class="fl">621</span>, <span class="fl">696</span>, <span class="fl">1000</span>, <span class="fl">1021</span>, <span class="fl">1024</span>, <span class="fl">1293</span>, <span class="fl">1300</span>, <span class="fl">1417</span>, <span class="fl">1693</span>, <span class="fl">1700</span>, <span class="fl">1981</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">inspect</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">compute.threshold</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>   <span class="fl">300</span>,  <span class="fl">700</span>,  <span class="fl">701</span>,  <span class="fl">702</span>,  <span class="fl">704</span>,  <span class="fl">707</span>,  <span class="fl">708</span>,  <span class="fl">712</span>,  <span class="fl">715</span>,  <span class="fl">716</span>,  <span class="fl">717</span>,  <span class="fl">718</span>,</span>
<span>   <span class="fl">721</span>,  <span class="fl">722</span>,  <span class="fl">723</span>,  <span class="fl">726</span>,  <span class="fl">727</span>,  <span class="fl">729</span>,  <span class="fl">731</span>,  <span class="fl">732</span>,  <span class="fl">734</span>,  <span class="fl">736</span>,  <span class="fl">740</span>,  <span class="fl">742</span>,</span>
<span>   <span class="fl">744</span>,  <span class="fl">746</span>,  <span class="fl">748</span>,  <span class="fl">750</span>,  <span class="fl">753</span>,  <span class="fl">755</span>,  <span class="fl">756</span>,  <span class="fl">757</span>,  <span class="fl">759</span>,  <span class="fl">760</span>,  <span class="fl">762</span>,  <span class="fl">764</span>,</span>
<span>   <span class="fl">765</span>,  <span class="fl">766</span>,  <span class="fl">768</span>,  <span class="fl">769</span>,  <span class="fl">771</span>,  <span class="fl">772</span>,  <span class="fl">774</span>,  <span class="fl">776</span>,  <span class="fl">777</span>,  <span class="fl">784</span>,  <span class="fl">785</span>,  <span class="fl">786</span>,</span>
<span>   <span class="fl">789</span>,  <span class="fl">791</span>,  <span class="fl">792</span>,  <span class="fl">794</span>,  <span class="fl">797</span>,  <span class="fl">798</span>,  <span class="fl">799</span>,  <span class="fl">801</span>,  <span class="fl">802</span>,  <span class="fl">803</span>,  <span class="fl">807</span>,  <span class="fl">809</span>,</span>
<span>   <span class="fl">810</span>,  <span class="fl">813</span>,  <span class="fl">815</span>,  <span class="fl">817</span>,  <span class="fl">819</span>,  <span class="fl">826</span>,  <span class="fl">827</span>,  <span class="fl">828</span>,  <span class="fl">829</span>,  <span class="fl">831</span>,  <span class="fl">833</span>,  <span class="fl">835</span>,</span>
<span>   <span class="fl">836</span>,  <span class="fl">837</span>,  <span class="fl">838</span>,  <span class="fl">840</span>,  <span class="fl">841</span>,  <span class="fl">842</span>,  <span class="fl">843</span>,  <span class="fl">845</span>,  <span class="fl">848</span>,  <span class="fl">849</span>,  <span class="fl">852</span>,  <span class="fl">854</span>,</span>
<span>   <span class="fl">860</span>,  <span class="fl">862</span>,  <span class="fl">864</span>,  <span class="fl">866</span>,  <span class="fl">868</span>,  <span class="fl">870</span>,  <span class="fl">872</span>,  <span class="fl">875</span>,  <span class="fl">879</span>,  <span class="fl">881</span>,  <span class="fl">884</span>,  <span class="fl">886</span>,</span>
<span>   <span class="fl">887</span>,  <span class="fl">888</span>,  <span class="fl">889</span>,  <span class="fl">896</span>,  <span class="fl">897</span>,  <span class="fl">898</span>,  <span class="fl">899</span>,  <span class="fl">901</span>,  <span class="fl">903</span>,  <span class="fl">904</span>,  <span class="fl">905</span>,  <span class="fl">906</span>,</span>
<span>   <span class="fl">909</span>,  <span class="fl">910</span>,  <span class="fl">912</span>,  <span class="fl">913</span>,  <span class="fl">915</span>,  <span class="fl">917</span>,  <span class="fl">919</span>,  <span class="fl">921</span>,  <span class="fl">922</span>,  <span class="fl">923</span>,  <span class="fl">925</span>,  <span class="fl">927</span>,</span>
<span>   <span class="fl">928</span>,  <span class="fl">932</span>,  <span class="fl">934</span>,  <span class="fl">936</span>,  <span class="fl">937</span>,  <span class="fl">940</span>,  <span class="fl">944</span>,  <span class="fl">945</span>,  <span class="fl">947</span>,  <span class="fl">948</span>,  <span class="fl">949</span>,  <span class="fl">951</span>,</span>
<span>   <span class="fl">956</span>,  <span class="fl">958</span>,  <span class="fl">959</span>,  <span class="fl">961</span>,  <span class="fl">962</span>,  <span class="fl">963</span>,  <span class="fl">964</span>,  <span class="fl">966</span>,  <span class="fl">967</span>,  <span class="fl">968</span>,  <span class="fl">972</span>,  <span class="fl">974</span>,</span>
<span>   <span class="fl">976</span>,  <span class="fl">978</span>,  <span class="fl">979</span>,  <span class="fl">986</span>,  <span class="fl">988</span>,  <span class="fl">990</span>,  <span class="fl">992</span>,  <span class="fl">995</span>,  <span class="fl">998</span>, <span class="fl">1000</span>, <span class="fl">1300</span>, <span class="fl">1700</span>,</span>
<span>  <span class="fl">1702</span>, <span class="fl">1703</span>, <span class="fl">1704</span>, <span class="fl">1705</span>, <span class="fl">1708</span>, <span class="fl">1710</span>, <span class="fl">1712</span>, <span class="fl">1714</span>, <span class="fl">1716</span>, <span class="fl">1717</span>, <span class="fl">1718</span>, <span class="fl">1720</span>,</span>
<span>  <span class="fl">1721</span>, <span class="fl">1723</span>, <span class="fl">1725</span>, <span class="fl">1726</span>, <span class="fl">1727</span>, <span class="fl">1729</span>, <span class="fl">1731</span>, <span class="fl">1733</span>, <span class="fl">1735</span>, <span class="fl">1736</span>, <span class="fl">1737</span>, <span class="fl">1739</span>,</span>
<span>  <span class="fl">1742</span>, <span class="fl">1745</span>, <span class="fl">1747</span>, <span class="fl">1748</span>, <span class="fl">1752</span>, <span class="fl">1754</span>, <span class="fl">1756</span>, <span class="fl">1758</span>, <span class="fl">1759</span>, <span class="fl">1760</span>, <span class="fl">1766</span>, <span class="fl">1768</span>,</span>
<span>  <span class="fl">1770</span>, <span class="fl">1771</span>, <span class="fl">1773</span>, <span class="fl">1775</span>, <span class="fl">1778</span>, <span class="fl">1782</span>, <span class="fl">1784</span>, <span class="fl">1785</span>, <span class="fl">1790</span>, <span class="fl">1792</span>, <span class="fl">1793</span>, <span class="fl">1795</span>,</span>
<span>  <span class="fl">1796</span>, <span class="fl">1797</span>, <span class="fl">1799</span>, <span class="fl">1800</span>, <span class="fl">1802</span>, <span class="fl">1803</span>, <span class="fl">1804</span>, <span class="fl">1805</span>, <span class="fl">1806</span>, <span class="fl">1807</span>, <span class="fl">1808</span>, <span class="fl">1809</span>,</span>
<span>  <span class="fl">1813</span>, <span class="fl">1815</span>, <span class="fl">1816</span>, <span class="fl">1818</span>, <span class="fl">1821</span>, <span class="fl">1824</span>, <span class="fl">1825</span>, <span class="fl">1827</span>, <span class="fl">1828</span>, <span class="fl">1829</span>, <span class="fl">1833</span>, <span class="fl">1835</span>,</span>
<span>  <span class="fl">1837</span>, <span class="fl">1840</span>, <span class="fl">1841</span>, <span class="fl">1842</span>, <span class="fl">1848</span>, <span class="fl">1849</span>, <span class="fl">1851</span>, <span class="fl">1852</span>, <span class="fl">1854</span>, <span class="fl">1855</span>, <span class="fl">1857</span>, <span class="fl">1859</span>,</span>
<span>  <span class="fl">1860</span>, <span class="fl">1862</span>, <span class="fl">1863</span>, <span class="fl">1865</span>, <span class="fl">1867</span>, <span class="fl">1868</span>, <span class="fl">1876</span>, <span class="fl">1878</span>, <span class="fl">1879</span>, <span class="fl">1880</span>, <span class="fl">1882</span>, <span class="fl">1883</span>,</span>
<span>  <span class="fl">1884</span>, <span class="fl">1886</span>, <span class="fl">1887</span>, <span class="fl">1889</span>, <span class="fl">1894</span>, <span class="fl">1898</span>, <span class="fl">1899</span>, <span class="fl">1905</span>, <span class="fl">1906</span>, <span class="fl">1907</span>, <span class="fl">1908</span>, <span class="fl">1909</span>,</span>
<span>  <span class="fl">1912</span>, <span class="fl">1919</span>, <span class="fl">1920</span>, <span class="fl">1921</span>, <span class="fl">1923</span>, <span class="fl">1924</span>, <span class="fl">1926</span>, <span class="fl">1927</span>, <span class="fl">1928</span>, <span class="fl">1930</span>, <span class="fl">1933</span>, <span class="fl">1934</span>,</span>
<span>  <span class="fl">1935</span>, <span class="fl">1936</span>, <span class="fl">1938</span>, <span class="fl">1940</span>, <span class="fl">1941</span>, <span class="fl">1944</span>, <span class="fl">1947</span>, <span class="fl">1950</span>, <span class="fl">1952</span>, <span class="fl">1954</span>, <span class="fl">1955</span>, <span class="fl">1956</span>,</span>
<span>  <span class="fl">1960</span>, <span class="fl">1962</span>, <span class="fl">1963</span>, <span class="fl">1965</span>, <span class="fl">1966</span>, <span class="fl">1967</span>, <span class="fl">1969</span>, <span class="fl">1970</span>, <span class="fl">1974</span>, <span class="fl">1976</span>, <span class="fl">1977</span>, <span class="fl">1978</span>,</span>
<span>  <span class="fl">1980</span>, <span class="fl">1985</span>, <span class="fl">1987</span>, <span class="fl">1988</span>, <span class="fl">1990</span>, <span class="fl">1996</span>, <span class="fl">1997</span>, <span class="fl">1998</span></span>
<span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu">beast</span><span class="op">(</span></span>
<span>    <span class="va">mv_data_1</span>, season <span class="op">=</span> <span class="st">"none"</span>, print.progress <span class="op">=</span> <span class="cn">FALSE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1855</span>, <span class="fl">1794</span>, <span class="fl">1301</span>, <span class="fl">1986</span>, <span class="fl">301</span>, <span class="fl">703</span>, <span class="fl">1981</span>, <span class="fl">1769</span>, <span class="fl">1860</span>, <span class="fl">709</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">mcp</span><span class="fu">::</span><span class="fu">mcp</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span>, <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mv_data_1</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mv_data_1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"mcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">not</span><span class="fu">::</span><span class="fu">not</span><span class="op">(</span><span class="va">mv_data_1</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMeanVar"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"not"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"not"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">mean_data_3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">mean_data_3</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">inspect</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">compute.threshold</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">mean_data_3</span>, K <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"jointseg"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu">beast123</span><span class="op">(</span></span>
<span>    <span class="va">mean_data_3</span>,</span>
<span>    metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>whichDimIsTime <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    season <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">301</span>, <span class="fl">701</span>, <span class="fl">301</span>,</span>
<span>  <span class="fl">701</span>, <span class="fl">301</span>, <span class="fl">701</span>,</span>
<span>  <span class="fl">142</span>, <span class="fl">117</span>, <span class="fl">926</span>,</span>
<span>  <span class="fl">305</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span>,</span>
<span>  <span class="fl">705</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span>,</span>
<span>  <span class="fl">694</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span>,</span>
<span>  <span class="cn">NaN</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span>,</span>
<span>  <span class="cn">NaN</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span>,</span>
<span>  <span class="cn">NaN</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span>,</span>
<span>  <span class="cn">NaN</span>, <span class="cn">NaN</span>, <span class="cn">NaN</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y.1</span>, <span class="va">y.2</span>, <span class="va">y.3</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mean_data_3</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">301</span>, <span class="fl">701</span>, <span class="fl">1001</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">bcp</span><span class="fu">::</span><span class="fu">bcp</span><span class="op">(</span><span class="va">mean_data_3</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"bcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mean_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"bcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_meanvariance.html">fastcpd.mv</a></span><span class="op">(</span><span class="va">mv_data_3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">700</span>, <span class="fl">1000</span>, <span class="fl">1300</span>, <span class="fl">1700</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ecp"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">301</span>, <span class="fl">701</span>, <span class="fl">1001</span>, <span class="fl">1301</span>, <span class="fl">1701</span>, <span class="fl">2001</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">inspect</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">compute.threshold</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mv_data_3</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"InspectChangepoint"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>   <span class="fl">300</span>,  <span class="fl">700</span>,  <span class="fl">701</span>,  <span class="fl">703</span>,  <span class="fl">705</span>,  <span class="fl">707</span>,  <span class="fl">708</span>,  <span class="fl">709</span>,  <span class="fl">711</span>,  <span class="fl">712</span>,  <span class="fl">714</span>,  <span class="fl">715</span>,</span>
<span>   <span class="fl">717</span>,  <span class="fl">718</span>,  <span class="fl">720</span>,  <span class="fl">721</span>,  <span class="fl">723</span>,  <span class="fl">724</span>,  <span class="fl">726</span>,  <span class="fl">727</span>,  <span class="fl">729</span>,  <span class="fl">731</span>,  <span class="fl">733</span>,  <span class="fl">734</span>,</span>
<span>   <span class="fl">736</span>,  <span class="fl">737</span>,  <span class="fl">739</span>,  <span class="fl">740</span>,  <span class="fl">742</span>,  <span class="fl">743</span>,  <span class="fl">744</span>,  <span class="fl">746</span>,  <span class="fl">747</span>,  <span class="fl">749</span>,  <span class="fl">750</span>,  <span class="fl">752</span>,</span>
<span>   <span class="fl">753</span>,  <span class="fl">754</span>,  <span class="fl">755</span>,  <span class="fl">756</span>,  <span class="fl">758</span>,  <span class="fl">760</span>,  <span class="fl">762</span>,  <span class="fl">763</span>,  <span class="fl">765</span>,  <span class="fl">766</span>,  <span class="fl">767</span>,  <span class="fl">769</span>,</span>
<span>   <span class="fl">770</span>,  <span class="fl">772</span>,  <span class="fl">773</span>,  <span class="fl">774</span>,  <span class="fl">775</span>,  <span class="fl">777</span>,  <span class="fl">779</span>,  <span class="fl">780</span>,  <span class="fl">782</span>,  <span class="fl">784</span>,  <span class="fl">786</span>,  <span class="fl">788</span>,</span>
<span>   <span class="fl">790</span>,  <span class="fl">791</span>,  <span class="fl">793</span>,  <span class="fl">795</span>,  <span class="fl">797</span>,  <span class="fl">799</span>,  <span class="fl">801</span>,  <span class="fl">803</span>,  <span class="fl">804</span>,  <span class="fl">806</span>,  <span class="fl">809</span>,  <span class="fl">810</span>,</span>
<span>   <span class="fl">811</span>,  <span class="fl">813</span>,  <span class="fl">814</span>,  <span class="fl">816</span>,  <span class="fl">817</span>,  <span class="fl">818</span>,  <span class="fl">820</span>,  <span class="fl">821</span>,  <span class="fl">823</span>,  <span class="fl">825</span>,  <span class="fl">827</span>,  <span class="fl">828</span>,</span>
<span>   <span class="fl">830</span>,  <span class="fl">831</span>,  <span class="fl">833</span>,  <span class="fl">835</span>,  <span class="fl">836</span>,  <span class="fl">837</span>,  <span class="fl">838</span>,  <span class="fl">840</span>,  <span class="fl">842</span>,  <span class="fl">843</span>,  <span class="fl">845</span>,  <span class="fl">846</span>,</span>
<span>   <span class="fl">848</span>,  <span class="fl">849</span>,  <span class="fl">850</span>,  <span class="fl">852</span>,  <span class="fl">853</span>,  <span class="fl">854</span>,  <span class="fl">855</span>,  <span class="fl">856</span>,  <span class="fl">858</span>,  <span class="fl">859</span>,  <span class="fl">860</span>,  <span class="fl">862</span>,</span>
<span>   <span class="fl">863</span>,  <span class="fl">865</span>,  <span class="fl">866</span>,  <span class="fl">868</span>,  <span class="fl">869</span>,  <span class="fl">871</span>,  <span class="fl">872</span>,  <span class="fl">874</span>,  <span class="fl">876</span>,  <span class="fl">877</span>,  <span class="fl">878</span>,  <span class="fl">879</span>,</span>
<span>   <span class="fl">881</span>,  <span class="fl">883</span>,  <span class="fl">885</span>,  <span class="fl">887</span>,  <span class="fl">888</span>,  <span class="fl">889</span>,  <span class="fl">891</span>,  <span class="fl">893</span>,  <span class="fl">894</span>,  <span class="fl">895</span>,  <span class="fl">897</span>,  <span class="fl">898</span>,</span>
<span>   <span class="fl">900</span>,  <span class="fl">901</span>,  <span class="fl">903</span>,  <span class="fl">904</span>,  <span class="fl">906</span>,  <span class="fl">908</span>,  <span class="fl">909</span>,  <span class="fl">911</span>,  <span class="fl">913</span>,  <span class="fl">914</span>,  <span class="fl">916</span>,  <span class="fl">917</span>,</span>
<span>   <span class="fl">918</span>,  <span class="fl">920</span>,  <span class="fl">921</span>,  <span class="fl">923</span>,  <span class="fl">924</span>,  <span class="fl">925</span>,  <span class="fl">927</span>,  <span class="fl">928</span>,  <span class="fl">929</span>,  <span class="fl">931</span>,  <span class="fl">932</span>,  <span class="fl">934</span>,</span>
<span>   <span class="fl">936</span>,  <span class="fl">937</span>,  <span class="fl">938</span>,  <span class="fl">939</span>,  <span class="fl">941</span>,  <span class="fl">942</span>,  <span class="fl">943</span>,  <span class="fl">945</span>,  <span class="fl">946</span>,  <span class="fl">947</span>,  <span class="fl">949</span>,  <span class="fl">950</span>,</span>
<span>   <span class="fl">952</span>,  <span class="fl">954</span>,  <span class="fl">955</span>,  <span class="fl">956</span>,  <span class="fl">957</span>,  <span class="fl">958</span>,  <span class="fl">959</span>,  <span class="fl">961</span>,  <span class="fl">962</span>,  <span class="fl">964</span>,  <span class="fl">965</span>,  <span class="fl">967</span>,</span>
<span>   <span class="fl">968</span>,  <span class="fl">970</span>,  <span class="fl">972</span>,  <span class="fl">973</span>,  <span class="fl">974</span>,  <span class="fl">975</span>,  <span class="fl">977</span>,  <span class="fl">979</span>,  <span class="fl">981</span>,  <span class="fl">982</span>,  <span class="fl">984</span>,  <span class="fl">985</span>,</span>
<span>   <span class="fl">986</span>,  <span class="fl">987</span>,  <span class="fl">988</span>,  <span class="fl">990</span>,  <span class="fl">991</span>,  <span class="fl">992</span>,  <span class="fl">994</span>,  <span class="fl">995</span>,  <span class="fl">997</span>,  <span class="fl">999</span>, <span class="fl">1000</span>, <span class="fl">1300</span>,</span>
<span>  <span class="fl">1700</span>, <span class="fl">1702</span>, <span class="fl">1703</span>, <span class="fl">1704</span>, <span class="fl">1705</span>, <span class="fl">1706</span>, <span class="fl">1708</span>, <span class="fl">1709</span>, <span class="fl">1710</span>, <span class="fl">1712</span>, <span class="fl">1713</span>, <span class="fl">1714</span>,</span>
<span>  <span class="fl">1715</span>, <span class="fl">1717</span>, <span class="fl">1719</span>, <span class="fl">1721</span>, <span class="fl">1722</span>, <span class="fl">1723</span>, <span class="fl">1725</span>, <span class="fl">1727</span>, <span class="fl">1729</span>, <span class="fl">1730</span>, <span class="fl">1732</span>, <span class="fl">1734</span>,</span>
<span>  <span class="fl">1735</span>, <span class="fl">1737</span>, <span class="fl">1738</span>, <span class="fl">1739</span>, <span class="fl">1741</span>, <span class="fl">1742</span>, <span class="fl">1744</span>, <span class="fl">1746</span>, <span class="fl">1748</span>, <span class="fl">1750</span>, <span class="fl">1752</span>, <span class="fl">1753</span>,</span>
<span>  <span class="fl">1754</span>, <span class="fl">1755</span>, <span class="fl">1757</span>, <span class="fl">1758</span>, <span class="fl">1759</span>, <span class="fl">1761</span>, <span class="fl">1762</span>, <span class="fl">1763</span>, <span class="fl">1764</span>, <span class="fl">1766</span>, <span class="fl">1767</span>, <span class="fl">1769</span>,</span>
<span>  <span class="fl">1770</span>, <span class="fl">1771</span>, <span class="fl">1773</span>, <span class="fl">1774</span>, <span class="fl">1775</span>, <span class="fl">1777</span>, <span class="fl">1779</span>, <span class="fl">1781</span>, <span class="fl">1782</span>, <span class="fl">1783</span>, <span class="fl">1785</span>, <span class="fl">1786</span>,</span>
<span>  <span class="fl">1788</span>, <span class="fl">1789</span>, <span class="fl">1791</span>, <span class="fl">1793</span>, <span class="fl">1794</span>, <span class="fl">1796</span>, <span class="fl">1798</span>, <span class="fl">1800</span>, <span class="fl">1803</span>, <span class="fl">1804</span>, <span class="fl">1805</span>, <span class="fl">1806</span>,</span>
<span>  <span class="fl">1808</span>, <span class="fl">1809</span>, <span class="fl">1811</span>, <span class="fl">1812</span>, <span class="fl">1814</span>, <span class="fl">1815</span>, <span class="fl">1817</span>, <span class="fl">1818</span>, <span class="fl">1819</span>, <span class="fl">1821</span>, <span class="fl">1822</span>, <span class="fl">1824</span>,</span>
<span>  <span class="fl">1825</span>, <span class="fl">1827</span>, <span class="fl">1828</span>, <span class="fl">1829</span>, <span class="fl">1831</span>, <span class="fl">1833</span>, <span class="fl">1835</span>, <span class="fl">1836</span>, <span class="fl">1838</span>, <span class="fl">1839</span>, <span class="fl">1841</span>, <span class="fl">1843</span>,</span>
<span>  <span class="fl">1844</span>, <span class="fl">1846</span>, <span class="fl">1847</span>, <span class="fl">1848</span>, <span class="fl">1850</span>, <span class="fl">1851</span>, <span class="fl">1853</span>, <span class="fl">1854</span>, <span class="fl">1856</span>, <span class="fl">1857</span>, <span class="fl">1858</span>, <span class="fl">1859</span>,</span>
<span>  <span class="fl">1860</span>, <span class="fl">1862</span>, <span class="fl">1863</span>, <span class="fl">1864</span>, <span class="fl">1865</span>, <span class="fl">1867</span>, <span class="fl">1869</span>, <span class="fl">1870</span>, <span class="fl">1872</span>, <span class="fl">1873</span>, <span class="fl">1874</span>, <span class="fl">1876</span>,</span>
<span>  <span class="fl">1878</span>, <span class="fl">1879</span>, <span class="fl">1881</span>, <span class="fl">1882</span>, <span class="fl">1884</span>, <span class="fl">1885</span>, <span class="fl">1887</span>, <span class="fl">1889</span>, <span class="fl">1891</span>, <span class="fl">1893</span>, <span class="fl">1894</span>, <span class="fl">1896</span>,</span>
<span>  <span class="fl">1898</span>, <span class="fl">1899</span>, <span class="fl">1900</span>, <span class="fl">1901</span>, <span class="fl">1902</span>, <span class="fl">1904</span>, <span class="fl">1906</span>, <span class="fl">1907</span>, <span class="fl">1909</span>, <span class="fl">1911</span>, <span class="fl">1913</span>, <span class="fl">1914</span>,</span>
<span>  <span class="fl">1916</span>, <span class="fl">1917</span>, <span class="fl">1918</span>, <span class="fl">1919</span>, <span class="fl">1921</span>, <span class="fl">1923</span>, <span class="fl">1924</span>, <span class="fl">1925</span>, <span class="fl">1927</span>, <span class="fl">1928</span>, <span class="fl">1930</span>, <span class="fl">1932</span>,</span>
<span>  <span class="fl">1933</span>, <span class="fl">1935</span>, <span class="fl">1936</span>, <span class="fl">1938</span>, <span class="fl">1939</span>, <span class="fl">1941</span>, <span class="fl">1942</span>, <span class="fl">1944</span>, <span class="fl">1946</span>, <span class="fl">1948</span>, <span class="fl">1950</span>, <span class="fl">1951</span>,</span>
<span>  <span class="fl">1952</span>, <span class="fl">1954</span>, <span class="fl">1956</span>, <span class="fl">1957</span>, <span class="fl">1959</span>, <span class="fl">1961</span>, <span class="fl">1963</span>, <span class="fl">1965</span>, <span class="fl">1967</span>, <span class="fl">1968</span>, <span class="fl">1970</span>, <span class="fl">1972</span>,</span>
<span>  <span class="fl">1973</span>, <span class="fl">1974</span>, <span class="fl">1976</span>, <span class="fl">1977</span>, <span class="fl">1979</span>, <span class="fl">1981</span>, <span class="fl">1982</span>, <span class="fl">1984</span>, <span class="fl">1985</span>, <span class="fl">1987</span>, <span class="fl">1989</span>, <span class="fl">1990</span>,</span>
<span>  <span class="fl">1992</span>, <span class="fl">1993</span>, <span class="fl">1995</span>, <span class="fl">1996</span>, <span class="fl">1998</span></span>
<span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu">beast123</span><span class="op">(</span></span>
<span>    <span class="va">mv_data_3</span>,</span>
<span>    metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>whichDimIsTime <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    season <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"mv_data_3"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Rbeast"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>   <span class="fl">701</span>, <span class="fl">1301</span>,  <span class="fl">301</span>, <span class="fl">1301</span>,</span>
<span>  <span class="fl">1301</span>,  <span class="fl">301</span>, <span class="fl">1301</span>,  <span class="fl">710</span>,</span>
<span>   <span class="fl">301</span>,  <span class="fl">701</span>, <span class="fl">1829</span>,  <span class="fl">301</span>,</span>
<span>  <span class="fl">1968</span>, <span class="fl">1993</span>,  <span class="fl">702</span>,  <span class="fl">886</span>,</span>
<span>  <span class="fl">1994</span>,  <span class="fl">884</span>, <span class="fl">1822</span>, <span class="fl">1975</span>,</span>
<span>   <span class="fl">814</span>,  <span class="fl">755</span>,  <span class="fl">810</span>, <span class="fl">1915</span>,</span>
<span>  <span class="fl">1962</span>,  <span class="fl">781</span>,  <span class="fl">845</span>,  <span class="fl">778</span>,</span>
<span>  <span class="fl">1978</span>,  <span class="fl">767</span>, <span class="fl">1738</span>, <span class="fl">1985</span>,</span>
<span>  <span class="fl">1870</span>,  <span class="fl">747</span>, <span class="fl">1754</span>,  <span class="fl">792</span>,</span>
<span>  <span class="fl">1843</span>,  <span class="fl">722</span>,  <span class="fl">771</span>,  <span class="fl">953</span></span>
<span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">10</span>, ncol <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_lm.html">fastcpd.lm</a></span><span class="op">(</span><span class="va">lm_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">97</span>, <span class="fl">201</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">lm_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">201</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">segmented</span><span class="fu">::</span><span class="fu">segmented</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>      <span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">lm_data</span><span class="op">$</span><span class="va">y</span>, x <span class="op">=</span> <span class="va">lm_data</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>, index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">lm_data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    seg.Z <span class="op">=</span> <span class="op">~</span> <span class="va">index</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"lm_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">233</span><span class="op">)</span>, ignore_attr <span class="op">=</span> <span class="cn">TRUE</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_binomial.html">fastcpd.binomial</a></span><span class="op">(</span><span class="va">binomial_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">302</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">binomial_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"binomial_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">297</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_poisson.html">fastcpd.poisson</a></span><span class="op">(</span><span class="va">poisson_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">498</span>, <span class="fl">805</span>, <span class="fl">1003</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">poisson_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"poisson_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span>, <span class="fl">935</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_lasso.html">fastcpd.lasso</a></span><span class="op">(</span><span class="va">lasso_data</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">79</span>, <span class="fl">199</span>, <span class="fl">320</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">-</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">lasso_data</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"lasso_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">200</span>, <span class="fl">321</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_ar.html">fastcpd.ar</a></span><span class="op">(</span><span class="va">ar_data</span>, <span class="fl">3</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">614</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">ar_data</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">segmented</span><span class="fu">::</span><span class="fu">segmented</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>      <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ar_data</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    seg.Z <span class="op">=</span> <span class="op">~</span> <span class="va">x</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">psi</span><span class="op">[</span>, <span class="st">"Est."</span><span class="op">]</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"segmented"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">690</span><span class="op">)</span>, ignore_attr <span class="op">=</span> <span class="cn">TRUE</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">mcp</span><span class="fu">::</span><span class="fu">mcp</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/ar.html" class="external-link">ar</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/ar.html" class="external-link">ar</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">ar_data</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ar_data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    par_x <span class="op">=</span> <span class="st">"x"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"mcp"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"ar_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"mcp"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_garch.html">fastcpd.garch</a></span><span class="op">(</span><span class="va">garch_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">205</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">garch_data</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">garch_data</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"CptNonPar"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">206</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">x</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">garch_data</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"garch_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"strucchange"</span><span class="op">]</span><span class="op">]</span>, <span class="cn">NA</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_var.html">fastcpd.var</a></span><span class="op">(</span><span class="va">var_data</span>, <span class="fl">2</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"fastcpd"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">500</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"VARDetect"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">VARDetect</span><span class="fu">::</span><span class="fu">tbss</span><span class="op">(</span><span class="va">var_data</span><span class="op">)</span><span class="op">$</span><span class="va">cp</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"VARDetect"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"var_data"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"VARDetect"</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">501</span><span class="op">)</span>, tolerance <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">well_log</span> <span class="op">&lt;-</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="va"><a href="../reference/well_log.html">well_log</a></span></span>
<span><span class="va">well_log</span> <span class="op">&lt;-</span> <span class="va">well_log</span><span class="op">[</span><span class="va">well_log</span> <span class="op">&gt;</span> <span class="fl">1e5</span><span class="op">]</span></span>
<span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  fastcpd <span class="op">=</span> <span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">well_log</span>, trim <span class="op">=</span> <span class="fl">0.003</span><span class="op">)</span><span class="op">@</span><span class="va">cp_set</span>,</span>
<span>  changepoint <span class="op">=</span> <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.mean</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">@</span><span class="va">cpts</span>,</span>
<span>  CptNonPar <span class="op">=</span></span>
<span>    <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">well_log</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  strucchange <span class="op">=</span> <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span></span>
<span>    <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">well_log</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">breakpoints</span>,</span>
<span>  ecp <span class="op">=</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">estimates</span>,</span>
<span>  breakfast <span class="op">=</span> <span class="fu">breakfast</span><span class="fu">::</span><span class="fu">breakfast</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">$</span><span class="va">cptmodel.list</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  wbs <span class="op">=</span> <span class="fu">wbs</span><span class="fu">::</span><span class="fu">wbs</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">$</span><span class="va">cpt</span><span class="op">$</span><span class="va">cpt.ic</span><span class="op">$</span><span class="va">mbic.penalty</span>,</span>
<span>  mosum <span class="op">=</span> <span class="fu">mosum</span><span class="fu">::</span><span class="fu">mosum</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">$</span><span class="va">cpts.info</span><span class="op">$</span><span class="va">cpts</span>,</span>
<span>  <span class="co"># fpop = fpop::Fpop(well_log, length(well_log))$t.est,  # meaningless</span></span>
<span>  gfpop <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">gfpop</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">well_log</span>,</span>
<span>    mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">graph</span><span class="op">(</span></span>
<span>      penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">sdDiff</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">changepoints</span>,</span>
<span>  InspectChangepoint <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">inspect</span><span class="op">(</span></span>
<span>    <span class="va">well_log</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">compute.threshold</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">changepoints</span><span class="op">[</span>, <span class="st">"location"</span><span class="op">]</span>,</span>
<span>  jointseg <span class="op">=</span> <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">well_log</span>, K <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">$</span><span class="va">bestBkp</span>,</span>
<span>  Rbeast <span class="op">=</span> <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu">beast</span><span class="op">(</span></span>
<span>    <span class="va">well_log</span>, season <span class="op">=</span> <span class="st">"none"</span>, print.progress <span class="op">=</span> <span class="cn">FALSE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">trend</span><span class="op">$</span><span class="va">cp</span>,</span>
<span>  stepR <span class="op">=</span> <span class="fu">stepR</span><span class="fu">::</span><span class="fu">stepFit</span><span class="op">(</span><span class="va">well_log</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">$</span><span class="va">rightEnd</span></span>
<span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">package_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">package_index</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">package_list</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">package</span> <span class="op">&lt;-</span> <span class="va">package_list</span><span class="op">[[</span><span class="va">package_index</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">comparison_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="va">comparison_table</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      change_point <span class="op">=</span> <span class="va">results</span><span class="op">[[</span><span class="st">"well_log"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">package</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      package <span class="op">=</span> <span class="va">package</span>,</span>
<span>      y_offset <span class="op">=</span> <span class="op">(</span><span class="va">package_index</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1000</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">comparison_table</span><span class="op">$</span><span class="va">change_point</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">[</span><span class="va">most_selected</span> <span class="op">&gt;=</span> <span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">most_selected</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">0.5</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="op">(</span><span class="va">most_selected</span> <span class="op">&lt;-</span> <span class="va">most_selected</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">most_selected</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span></span>
<span>      xintercept <span class="op">=</span> <span class="va">most_selected</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>      linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fl">0.2</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">comparison_table</span>,</span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">change_point</span>, y <span class="op">=</span> <span class="fl">50000</span> <span class="op">+</span> <span class="va">y_offset</span>, color <span class="op">=</span> <span class="va">package</span><span class="op">)</span>,</span>
<span>      shape <span class="op">=</span> <span class="fl">17</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">1.9</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">comparison_table</span>,</span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">50000</span> <span class="op">+</span> <span class="va">y_offset</span>, color <span class="op">=</span> <span class="va">package</span><span class="op">)</span>,</span>
<span>      linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fl">0.1</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span></span>
<span>      ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50000</span> <span class="op">-</span> <span class="fl">500</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1000</span><span class="op">)</span>,</span>
<span>      xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">+</span> <span class="fl">200</span><span class="op">)</span>,</span>
<span>      expand <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      panel.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.border <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>      panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"microbenchmark"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu">microbenchmark</span><span class="op">(</span></span>
<span>  fastcpd <span class="op">=</span> <span class="fu">fastcpd</span><span class="fu">::</span><span class="fu"><a href="../reference/fastcpd_mean.html">fastcpd.mean</a></span><span class="op">(</span><span class="va">well_log</span>, trim <span class="op">=</span> <span class="fl">0.003</span>, r.progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  changepoint <span class="op">=</span> <span class="fu">changepoint</span><span class="fu">::</span><span class="fu">cpt.mean</span><span class="op">(</span><span class="va">well_log</span>, method <span class="op">=</span> <span class="st">"PELT"</span><span class="op">)</span>,</span>
<span>  CptNonPar <span class="op">=</span> <span class="fu">CptNonPar</span><span class="fu">::</span><span class="fu">np.mojo</span><span class="op">(</span><span class="va">well_log</span>, G <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  strucchange <span class="op">=</span></span>
<span>    <span class="fu">strucchange</span><span class="fu">::</span><span class="fu">breakpoints</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ecp <span class="op">=</span> <span class="fu">ecp</span><span class="fu">::</span><span class="fu">e.divisive</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  breakfast <span class="op">=</span> <span class="fu">breakfast</span><span class="fu">::</span><span class="fu">breakfast</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>,</span>
<span>  wbs <span class="op">=</span> <span class="fu">wbs</span><span class="fu">::</span><span class="fu">wbs</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>,</span>
<span>  mosum <span class="op">=</span> <span class="fu">mosum</span><span class="fu">::</span><span class="fu">mosum</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, G <span class="op">=</span> <span class="fl">40</span><span class="op">)</span>,</span>
<span>  fpop <span class="op">=</span> <span class="fu">fpop</span><span class="fu">::</span><span class="fu">Fpop</span><span class="op">(</span><span class="va">well_log</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  gfpop <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">gfpop</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">well_log</span>,</span>
<span>    mygraph <span class="op">=</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">graph</span><span class="op">(</span></span>
<span>      penalty <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu">gfpop</span><span class="fu">::</span><span class="fu">sdDiff</span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"updown"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"mean"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  InspectChangepoint <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">inspect</span><span class="op">(</span></span>
<span>    <span class="va">well_log</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fu">InspectChangepoint</span><span class="fu">::</span><span class="fu">compute.threshold</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">well_log</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  jointseg <span class="op">=</span> <span class="fu">jointseg</span><span class="fu">::</span><span class="fu">jointSeg</span><span class="op">(</span><span class="va">well_log</span>, K <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>  Rbeast <span class="op">=</span> <span class="fu">Rbeast</span><span class="fu">::</span><span class="fu">beast</span><span class="op">(</span></span>
<span>    <span class="va">well_log</span>, season <span class="op">=</span> <span class="st">"none"</span>, print.progress <span class="op">=</span> <span class="cn">FALSE</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span>,</span>
<span>  stepR <span class="op">=</span> <span class="fu">stepR</span><span class="fu">::</span><span class="fu">stepFit</span><span class="op">(</span><span class="va">well_log</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  not <span class="op">=</span> <span class="fu">not</span><span class="fu">::</span><span class="fu">not</span><span class="op">(</span><span class="va">well_log</span>, contrast <span class="op">=</span> <span class="st">"pcwsConstMean"</span><span class="op">)</span>,</span>
<span>  times <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">[[</span><span class="st">"microbenchmark"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"microbenchmark"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="st">"microbenchmark"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="st">"comparison-packages-results.RData"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">results</span>, file <span class="op">=</span> <span class="st">"comparison-packages-results.RData"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.xingchi.li" class="external-link">Xingchi Li</a>, <a href="https://zhangxiany-tamu.github.io" class="external-link">Xianyang Zhang</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
